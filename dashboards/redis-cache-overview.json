{"meta":{"type":"db","canSave":false,"canEdit":false,"canAdmin":false,"canStar":true,"slug":"redis-cache-overview","url":"/d/redis-cache-main/redis-cache-overview","expires":"0001-01-01T00:00:00Z","created":"2019-08-31T10:38:42Z","updated":"2019-11-07T15:20:42Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":182,"hasAcl":false,"isFolder":false,"folderId":989,"folderTitle":"redis-cache Service","folderUrl":"/dashboards/f/redis-cache/redis-cache-service","provisioned":false,"provisionedExternalId":""},"dashboard":{"__inputs":[],"__requires":[],"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":false,"iconColor":"#96D98D","name":"deploy","showIn":0,"tags":["deploy","$environment"],"type":"tags"},{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":false,"iconColor":"#FFEE52","name":"canary-deploy","showIn":0,"tags":["deploy","${environment}-cny"],"type":"tags"}]},"editable":false,"gnetId":null,"graphTooltip":1,"hideControls":false,"id":null,"links":[{"asDropdown":true,"icon":"external link","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"Platform Triage","type":"link","url":"https://dashboards.gitlab.net/d/general-triage/platform-triage?orgId=1"},{"asDropdown":true,"icon":"external link","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"Capacity Planning","type":"link","url":"https://dashboards.gitlab.net/d/general-capacity-planning/general-capacity-planning?orgId=1"},{"asDropdown":true,"icon":"external link","includeVars":false,"keepTime":false,"tags":"","targetBlank":true,"title":"Logs: system","type":"link","url":"https://log.gitlab.net/goto/1a4342231de57c0ceabc8f5e0e402909"},{"asDropdown":true,"icon":"external link","includeVars":false,"keepTime":false,"tags":"","targetBlank":true,"title":"Playbook","type":"link","url":"https://gitlab.com/gitlab-com/runbooks/blob/master/troubleshooting/service-redis.md"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"api service","type":"link","url":"https://dashboards.gitlab.net/d/api-main/api-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"ci-runners service","type":"link","url":"https://dashboards.gitlab.net/d/general-service/service-platform-metrics?orgId=1\u0026var-type=ci-runners"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"frontend service","type":"link","url":"https://dashboards.gitlab.net/d/frontend-main/frontend-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"git service","type":"link","url":"https://dashboards.gitlab.net/d/general-service/service-platform-metrics?orgId=1\u0026var-type=git"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"gitaly service","type":"link","url":"https://dashboards.gitlab.net/d/gitaly-main/gitaly-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"monitoring service","type":"link","url":"https://dashboards.gitlab.net/d/general-service/service-platform-metrics?orgId=1\u0026var-type=monitoring"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"pages service","type":"link","url":"https://dashboards.gitlab.net/d/general-service/service-platform-metrics?orgId=1\u0026var-type=pages"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"patroni service","type":"link","url":"https://dashboards.gitlab.net/d/patroni-main/patroni-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"pgbouncer service","type":"link","url":"https://dashboards.gitlab.net/d/pgbouncer-main/pgbouncer-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"redis service","type":"link","url":"https://dashboards.gitlab.net/d/redis-main/redis-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"redis-cache service","type":"link","url":"https://dashboards.gitlab.net/d/redis-cache-main/redis-cache-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"redis-sidekiq service","type":"link","url":"https://dashboards.gitlab.net/d/redis-sidekiq-main/redis-sidekiq-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"registry service","type":"link","url":"https://dashboards.gitlab.net/d/general-service/service-platform-metrics?orgId=1\u0026var-type=registry"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"sidekiq service","type":"link","url":"https://dashboards.gitlab.net/d/sidekiq-main/sidekiq-overview?orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"web service","type":"link","url":"https://dashboards.gitlab.net/d/web-main/web-overview??orgId=1"},{"asDropdown":true,"icon":"dashboard","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"web-pages service","type":"link","url":"https://dashboards.gitlab.net/d/general-service/service-platform-metrics?orgId=1\u0026var-type=web-pages"}],"panels":[{"collapse":true,"collapsed":true,"gridPos":{"x":0,"y":0},"id":2,"panels":[{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"$PROMETHEUS_DS","description":"Percentage time the latency SLI for this service is within SLO","format":"percentunit","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":6,"x":0,"y":1},"id":3,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"expr":"\n        avg(avg_over_time(slo_observation_status{slo=\"apdex_ratio\", environment=\"$environment\", type=\"redis-cache\", stage=\"$stage\"}[7d]))\n      ","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"","refId":"A"}],"thresholds":"","title":"7d Latency SLA","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"columns":[],"datasource":"$PROMETHEUS_DS","gridPos":{"h":8,"w":18,"x":6,"y":1},"id":4,"styles":[{"alias":"Time","pattern":"Time","type":"hidden"},{"alias":"Alert","decimals":2,"link":true,"linkTooltip":"Open alertmanager","linkUrl":"https://alerts.${environment}.gitlab.net/#/alerts?filter=%7Balertname%3D%22${__cell}%22%2C%20env%3D%22${environment}%22%2C%20type%3D%22redis-cache%22%7D","mappingType":2,"pattern":"alertname","type":"string","unit":"short"},{"alias":"Score","colorMode":"row","colors":["#CCCC00","#CC6600","#CC3300"],"decimals":0,"mappingType":1,"pattern":"Value","thresholds":["2","3"],"type":"number","unit":"short"}],"targets":[{"expr":"\n      sort(\n        max(\n        ALERTS{environment=\"$environment\", type=\"redis-cache\", stage=~\"|$stage\", severity=\"s1\", alertstate=\"firing\"} * 4\n        or\n        ALERTS{environment=\"$environment\", type=\"redis-cache\", stage=~\"|$stage\", severity=\"s2\", alertstate=\"firing\"} * 3\n        or\n        ALERTS{environment=\"$environment\", type=\"redis-cache\", stage=~\"|$stage\", severity=\"s3\", alertstate=\"firing\"} * 2\n        or\n        ALERTS{environment=\"$environment\", type=\"redis-cache\", alertstate=\"firing\"}\n        ) by (alertname, severity)\n      )\n      ","format":"table","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"","refId":"A"}],"title":"Active Alerts","transform":"table","type":"table"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"$PROMETHEUS_DS","description":"Percentage time the error ratio SLI for this service is within SLO","format":"percentunit","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":6,"x":0,"y":5},"id":5,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"expr":"\n        avg_over_time(slo_observation_status{slo=\"error_ratio\", environment=\"$environment\", type=\"redis-cache\", stage=\"$stage\"}[7d])\n      ","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"","refId":"A"}],"thresholds":"","title":"7d Error Rate SLA","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üë©‚Äç‚öïÔ∏è Service Health","titleSize":"h6","type":"row"},{"collapse":false,"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":1000},"id":6,"panels":[],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"Clients","titleSize":"h6","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":1001},"id":7,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(avg_over_time(redis_connected_clients{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Connected Clients","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Clients","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Blocked clients are waiting for a state change event using commands such as BLPOP. Blocked clients are not a sign of an issue on their own.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":1001},"id":8,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(avg_over_time(redis_blocked_clients{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Blocked Clients","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Blocked Clients","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":1011},"id":9,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_connections_received_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Connections Received","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Connections","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"collapse":false,"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":2000},"id":10,"panels":[],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"Workload","titleSize":"h6","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":2001},"id":11,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_commands_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Operation Rate","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Operations/sec","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"redis is single-threaded. This graph shows maximum utilization across all cores on each host. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":2001},"id":12,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(\n        max(\n          max_over_time(instance:redis_cpu_usage:rate1m{environment=\"$environment\", type=\"redis-cache\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])\n        ) by (fqdn)\n      ,1),0)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Redis CPU per Node","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation","logBase":1,"max":1,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":2011},"id":13,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_net_output_bytes_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Redis Network Out","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":2011},"id":14,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_net_input_bytes_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Redis Network In","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":2021},"id":15,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(changes(redis_slowlog_last_id{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":10,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Slowlog Events","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Events","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":2021},"id":16,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_commands_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (cmd)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ cmd }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Operation Rate per Command","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Operations/sec","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":2031},"id":17,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_commands_duration_seconds_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (cmd)\n        /\n        sum(rate(redis_commands_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (cmd)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ cmd }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Average Operation Latency","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Duration","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":2031},"id":18,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_commands_duration_seconds_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (cmd)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ cmd }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Total Operation Latency","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Duration","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"collapse":false,"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":3000},"id":19,"panels":[],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"Redis Data","titleSize":"h6","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Redis holds all data in memory. Avoid memory saturation in Redis at all cost ","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":3001},"id":20,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(\n        max(\n          label_replace(redis_memory_used_rss_bytes{environment=\"$environment\", type=\"redis-cache\"}, \"memtype\", \"rss\",\"\",\"\")\n          or\n          label_replace(redis_memory_used_bytes{environment=\"$environment\", type=\"redis-cache\"}, \"memtype\", \"used\",\"\",\"\")\n        ) by (type, tier, stage, environment, fqdn)\n        / on(fqdn) group_left\n        node_memory_MemTotal_bytes{environment=\"$environment\", type=\"redis-cache\"}\n      ,1),0)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"},{"expr":"\n          slo:max:soft:gitlab_component_saturation:ratio{component=\"redis_memory\"}\n        ","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"Degradation SLO","refId":"B"},{"expr":"\n          slo:max:hard:gitlab_component_saturation:ratio{component=\"redis_memory\"}\n        ","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"Outage SLO","refId":"C"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Memory Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation","logBase":1,"max":1,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":3001},"id":21,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max_over_time(redis_memory_used_bytes{environment=\"$environment\", type=\"redis-cache\"}[$__interval])\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Memory Used","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":3011},"id":22,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_memory_used_bytes{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Memory Used Rate of Change","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Bytes/sec","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Depending on the memory allocator used, Redis may not return memory to the operating system at the same rate that applications release keys. RSS indicates the operating systems perspective of Redis memory usage. So, even if usage is low, if RSS is high, the OOM killer may terminate the Redis process","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":3011},"id":23,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max_over_time(redis_memory_used_rss_bytes{environment=\"$environment\", type=\"redis-cache\"}[$__interval])\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Redis RSS Usage","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"The fragmentation ratio in Redis should ideally be around 1.0 and generally below 1.5. The higher the value, the more wasted memory.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":3021},"id":24,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        redis_memory_used_rss_bytes{environment=\"$environment\", type=\"redis-cache\"} / redis_memory_used_bytes{environment=\"$environment\", type=\"redis-cache\"}\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Memory Fragmentation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":3021},"id":25,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_expired_keys_total{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Expired Keys","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Keys","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":3031},"id":26,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(rate(redis_db_keys{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Keys Rate of Change","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Keys/sec","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"collapse":false,"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":4000},"id":27,"panels":[],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"Replication","titleSize":"h6","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":4001},"id":28,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(avg_over_time(redis_connected_slaves{environment=\"$environment\", type=\"redis-cache\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Connected Secondaries","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Secondaries","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":4001},"id":29,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        redis_master_repl_offset{environment=\"$environment\", type=\"redis-cache\"}\n        - on(fqdn) group_right\n        redis_connected_slave_offset_bytes{environment=\"$environment\", type=\"redis-cache\"}\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"secondary {{ slave_ip }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Replication Offset","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"Bytes","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":4011},"id":30,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(changes(redis_slave_resync_total{environment=\"$environment\", type=\"redis-cache\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Resync Events","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Events","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"collapse":true,"collapsed":true,"gridPos":{"x":0,"y":5000},"id":31,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":32,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        min(\n          min_over_time(\n            gitlab_service_apdex:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n          )\n        ) by (type)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ type }} service","refId":"A"},{"expr":"\n        min(\n          min_over_time(\n            gitlab_service_apdex:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"\"}[$__interval]\n          )\n        ) by (type)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ type }} service (legacy)","refId":"B"},{"expr":"\n          avg(slo:min:gitlab_service_apdex:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}) or avg(slo:min:gitlab_service_apdex:ratio{type=\"redis-cache\"})\n        ","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"Degradation SLO","refId":"C"},{"expr":"\n          2 * (avg(slo:min:gitlab_service_apdex:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}) or avg(slo:min:gitlab_service_apdex:ratio{type=\"redis-cache\"})) - 1\n        ","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"Outage SLO","refId":"D"},{"expr":"\n        min(\n          min_over_time(\n            gitlab_service_apdex:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval] offset 1w\n          )\n        ) by (type)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Latency: Apdex","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions within a minute period. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":33,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n      max(\n        max_over_time(\n          gitlab_service_errors:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n        )\n      ) by (type)\n      ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ type }} service","refId":"A"},{"expr":"\n      max(\n        max_over_time(\n          gitlab_service_errors:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"\"}[$__interval]\n        )\n      ) by (type)\n      ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ type }} service (legacy)","refId":"B"},{"expr":"\n        avg(slo:max:gitlab_service_errors:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}) or avg(slo:max:gitlab_service_errors:ratio{type=\"redis-cache\"})\n      ","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"Degradation SLO","refId":"C"},{"expr":"\n        2 * (avg(slo:max:gitlab_service_errors:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}) or avg(slo:max:gitlab_service_errors:ratio{type=\"redis-cache\"}))\n      ","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"Outage SLO","refId":"D"},{"expr":"\n      max(\n        max_over_time(\n          gitlab_service_errors:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval] offset 1w\n        )\n      ) by (type)\n      ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Error Ratios","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"% Requests in Error","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Availability measures the ratio of component processes in the service that are currently healthy and able to handle requests. The closer to 100% the better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":34,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        min(\n          min_over_time(\n            gitlab_component_availability:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n          )\n        ) by (component)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ component }} component","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Component Availability","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Availability %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":35,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max(\n          avg_over_time(\n            gitlab_service_ops:rate{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n          )\n        ) by (type)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ type }} service","refId":"A"},{"expr":"\n        max(\n          avg_over_time(\n            gitlab_service_ops:rate{environment=\"$environment\", type=\"redis-cache\", stage=\"\"}[$__interval]\n          )\n        ) by (type)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ type }} service (legacy)","refId":"B"},{"expr":"\n        max(\n          avg_over_time(\n            gitlab_service_ops:rate{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval] offset 1w\n          )\n        ) by (type)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"C"},{"expr":"\n        gitlab_service_ops:rate:prediction{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"} +\n        2 * gitlab_service_ops:rate:stddev_over_time_1w{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"upper normal","refId":"D"},{"expr":"\n        avg(\n          clamp_min(\n            gitlab_service_ops:rate:prediction{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"} -\n            2 * gitlab_service_ops:rate:stddev_over_time_1w{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"},\n            0\n          )\n        )\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"lower normal","refId":"E"},{"expr":"\n        gitlab_service_ops:rate:prediction{environment=\"$environment\", type=\"redis-cache\", stage=\"\"} +\n        2 * gitlab_service_ops:rate:stddev_over_time_1w{environment=\"$environment\", type=\"redis-cache\", stage=\"\"}\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"upper normal (legacy)","refId":"F"},{"expr":"\n        avg(\n          clamp_min(\n            gitlab_service_ops:rate:prediction{environment=\"$environment\", type=\"redis-cache\", stage=\"\"} -\n            2 * gitlab_service_ops:rate:stddev_over_time_1w{environment=\"$environment\", type=\"redis-cache\", stage=\"\"},\n            0\n          )\n        )\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"lower normal (legacy)","refId":"G"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"RPS - Service Requests per Second","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":20},"id":36,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max(\n          max_over_time(\n            gitlab_component_saturation:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n          )\n        ) by (component)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ component }} component","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üèÖ Key Service Metrics","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"x":0,"y":6000},"id":37,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":38,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n      min(\n        min_over_time(\n          gitlab_component_apdex:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n        )\n      ) by (component)\n      ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ component }} component","refId":"A"},{"expr":"\n        avg(slo:min:gitlab_service_apdex:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}) or avg(slo:min:gitlab_service_apdex:ratio{type=\"redis-cache\"})\n      ","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"SLO","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Component Latency: Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":39,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        1 +\n        (\n          60 *\n          max(\n            max_over_time(\n              gitlab_component_errors:rate{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n            )\n          ) by (component)\n        )\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ component }} component","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Component Error Rates - modified scale: (1 + n) log10","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"Errors per Minute","logBase":10,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Availability measures the ratio of component processes in the service that are currently healthy and able to handle requests. The closer to 100% the better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":40,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        min(\n          min_over_time(\n            gitlab_component_availability:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n          )\n        ) by (component)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ component }} component","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Component Availability","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Availability %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":41,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        1 +\n        max(\n          avg_over_time(\n            gitlab_component_ops:rate{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n          )\n        ) by (component)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ component }} component","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Component RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"reqps","label":"Requests per Second","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":20},"id":42,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ service/","color":"#E7D551"},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"upper normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal (legacy)","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal (legacy)","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"last week","color":"#dddddd40","dashLength":2,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"alert firing","color":"orange","zindex":-4},{"alias":"alert pending","color":"lightorange","zindex":-4},{"alias":"Degradation SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Outage SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max(\n          max_over_time(\n            gitlab_component_saturation:ratio{environment=\"$environment\", type=\"redis-cache\", stage=\"main\"}[$__interval]\n          )\n        ) by (component)\n        ","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ component }} component","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî© Service Component Metrics","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"x":0,"y":7000},"id":43,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The amount of non-idle time consumed by nodes for this service","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":44,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"max":false,"min":false,"rightSide":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n            avg(instance:node_cpu_utilization:ratio{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}) by (fqdn)\n            ","format":"time_series","interval":"1m","intervalFactor":5,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Node CPU","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Average CPU Utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"The maximum utilization of a single core on each node. Lower is better","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":45,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(\n          max(1 - rate(node_cpu_seconds_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\", mode=\"idle\"}[$__interval])) by (fqdn)\n        ,1),0)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Node Maximum Single Core Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation","logBase":1,"max":1,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Network utilization for nodes for this service","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":46,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"max":false,"min":false,"rightSide":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/receive .*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n          sum(rate(node_network_transmit_bytes_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])) by (fqdn)\n          ","format":"time_series","interval":"1m","intervalFactor":5,"legendFormat":"send {{ fqdn }}","refId":"A"},{"expr":"\n          sum(rate(node_network_receive_bytes_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])) by (fqdn)\n          ","format":"time_series","interval":"1m","intervalFactor":5,"legendFormat":"receive {{ fqdn }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Node Network Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Network utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Memory utilization. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":47,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(\n        1 -\n        (\n          (\n            node_memory_MemFree_bytes{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"} +\n            node_memory_Buffers_bytes{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"} +\n            node_memory_Cached_bytes{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}\n          )\n        )\n        /\n        node_memory_MemTotal_bytes{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}\n      ,1),0)","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Memory Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation","logBase":1,"max":1,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Disk Read IO operations per second. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":20},"id":48,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max(\n          rate(node_disk_reads_completed_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])\n        ) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Read IOPs","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Operations/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Disk Write IO operations per second. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":20},"id":49,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max(\n          rate(node_disk_writes_completed_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])\n        ) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Write IOPs","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Operations/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Disk Read throughput datarate. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":30},"id":50,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max(\n          rate(node_disk_read_bytes_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])\n        ) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Read Throughput","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Bytes/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Disk Write throughput datarate. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":30},"id":51,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        max(\n          rate(node_disk_written_bytes_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])\n        ) by (fqdn)\n      ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Write Throughput","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Bytes/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Total time spent in read operations across all disks on the node. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":40},"id":52,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(\n          rate(node_disk_read_time_seconds_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])\n        ) by (fqdn)\n      ","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Read Total Time","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Total Time/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Total time spent in write operations across all disks on the node. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":40},"id":53,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n        sum(\n          rate(node_disk_write_time_seconds_total{type=\"redis-cache\", environment=\"$environment\", fqdn=~\"redis-cache-\\\\d\\\\d.*\"}[$__interval])\n        ) by (fqdn)\n      ","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Write Total Time","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Total Time/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üñ•Ô∏è Node Metrics","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"x":0,"y":8000},"id":54,"panels":[{"columns":[],"datasource":"$PROMETHEUS_DS","description":"Lists saturated resources that are breaching their soft SLO thresholds at this instant","gridPos":{"h":10,"w":24,"x":0,"y":0},"id":55,"sort":{"col":13,"desc":true},"styles":[{"alias":"Satuation Resource","link":true,"linkTargetBlank":true,"linkTooltip":"Click the link to review the past 1 day(s) history for this saturation point.","linkUrl":"https://dashboards.gitlab.net/d/alerts-saturation_component/alerts-saturation-component-alert?var-environment=gprd\u0026var-type=${__cell_3}\u0026var-stage=${__cell_2}\u0026var-component=${__cell_1}\u0026from=now-1d\u0026to=now","mappingType":1,"pattern":"component","type":"string"},{"alias":"Type","mappingType":1,"pattern":"type","thresholds":[],"type":"string"},{"alias":"Current %","colorMode":"row","colors":["#CC6600","#CC6600","#CC6600"],"decimals":2,"mappingType":1,"pattern":"Value","thresholds":["0","100"],"type":"number","unit":"percentunit"},{"alias":"Stage","mappingType":2,"pattern":"stage","type":"string"},{"alias":"Issues","link":true,"linkTargetBlank":true,"linkTooltip":"Click the link to find issues on GitLab.com related to this saturation point.","linkUrl":"https://gitlab.com/groups/gitlab-com/gl-infra/-/issues?scope=all\u0026utf8=%E2%9C%93\u0026state=all\u0026label_name[]=GitLab.com%20Resource%20Saturation\u0026search=${__cell_1}+${__cell_3}","mappingType":2,"pattern":"Time","rangeMaps":[{"from":"0","text":"Find Issues","to":"9999999999999"}],"type":"string"},{"alias":"","mappingType":1,"pattern":"/.*/","type":"hidden"}],"targets":[{"expr":"\n      max by (type, stage, component) (\n        clamp_max(\n          gitlab_component_saturation:ratio{\n            environment=\"$environment\",\n              type=\"redredis-cacheis\", stage=~\"|main\"\n          }\n          ,\n          1\n        ) \u003e= on(component, monitor, env) group_left slo:max:soft:gitlab_component_saturation:ratio\n      )\n    ","format":"table","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"","refId":"A"}],"title":"Currently Saturated Resources","transform":"table","type":"table"},{"columns":[],"datasource":"$PROMETHEUS_DS","description":"Lists saturated resources that, given their current value and weekly variance, have a high probability of breaching their soft thresholds limits within the next few hours","gridPos":{"h":10,"w":24,"x":0,"y":10},"id":56,"sort":{"col":13,"desc":true},"styles":[{"alias":"Satuation Resource","link":true,"linkTargetBlank":true,"linkTooltip":"Click the link to review the past 7 day(s) history for this saturation point.","linkUrl":"https://dashboards.gitlab.net/d/alerts-saturation_component/alerts-saturation-component-alert?var-environment=gprd\u0026var-type=${__cell_3}\u0026var-stage=${__cell_2}\u0026var-component=${__cell_1}\u0026from=now-7d\u0026to=now","mappingType":1,"pattern":"component","type":"string"},{"alias":"Type","mappingType":1,"pattern":"type","thresholds":[],"type":"string"},{"alias":"Worst-case Saturation Today","colorMode":"row","colors":["#CC6600","#CC6600","#CC6600"],"decimals":2,"mappingType":1,"pattern":"Value","thresholds":["0","100"],"type":"number","unit":"percentunit"},{"alias":"Stage","mappingType":2,"pattern":"stage","type":"string"},{"alias":"Issues","link":true,"linkTargetBlank":true,"linkTooltip":"Click the link to find issues on GitLab.com related to this saturation point.","linkUrl":"https://gitlab.com/groups/gitlab-com/gl-infra/-/issues?scope=all\u0026utf8=%E2%9C%93\u0026state=all\u0026label_name[]=GitLab.com%20Resource%20Saturation\u0026search=${__cell_1}+${__cell_3}","mappingType":2,"pattern":"Time","rangeMaps":[{"from":"0","text":"Find Issues","to":"9999999999999"}],"type":"string"},{"alias":"","mappingType":1,"pattern":"/.*/","type":"hidden"}],"targets":[{"expr":"\n      sort_desc(\n        max by (type, stage, component) (\n          clamp_max(\n            gitlab_component_saturation:ratio:avg_over_time_1w{\n              environment=\"$environment\",\n              type=\"redredis-cacheis\", stage=~\"|main\"\n            } +\n            2 *\n              gitlab_component_saturation:ratio:stddev_over_time_1w{\n                environment=\"$environment\",\n              type=\"redredis-cacheis\", stage=~\"|main\"\n              }\n            , 1\n          )\n          \u003e= on(component, monitor, env) group_left slo:max:soft:gitlab_component_saturation:ratio\n        )\n      )\n    ","format":"table","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"","refId":"A"}],"title":"Resources Currently at Risk of being Saturated","transform":"table","type":"table"},{"columns":[],"datasource":"$PROMETHEUS_DS","description":"Lists saturated resources that, given their growth rate over the the past week, and their weekly variance, are likely to breach their soft thresholds limits in the next 14d","gridPos":{"h":10,"w":24,"x":0,"y":20},"id":57,"sort":{"col":13,"desc":true},"styles":[{"alias":"Satuation Resource","link":true,"linkTargetBlank":true,"linkTooltip":"Click the link to review the past 30 day(s) history for this saturation point.","linkUrl":"https://dashboards.gitlab.net/d/alerts-saturation_component/alerts-saturation-component-alert?var-environment=gprd\u0026var-type=${__cell_3}\u0026var-stage=${__cell_2}\u0026var-component=${__cell_1}\u0026from=now-30d\u0026to=now","mappingType":1,"pattern":"component","type":"string"},{"alias":"Type","mappingType":1,"pattern":"type","thresholds":[],"type":"string"},{"alias":"Worst-case Saturation 14d Forecast","colorMode":"row","colors":["#CC6600","#CC6600","#CC6600"],"decimals":2,"mappingType":1,"pattern":"Value","thresholds":["0","100"],"type":"number","unit":"percentunit"},{"alias":"Stage","mappingType":2,"pattern":"stage","type":"string"},{"alias":"Issues","link":true,"linkTargetBlank":true,"linkTooltip":"Click the link to find issues on GitLab.com related to this saturation point.","linkUrl":"https://gitlab.com/groups/gitlab-com/gl-infra/-/issues?scope=all\u0026utf8=%E2%9C%93\u0026state=all\u0026label_name[]=GitLab.com%20Resource%20Saturation\u0026search=${__cell_1}+${__cell_3}","mappingType":2,"pattern":"Time","rangeMaps":[{"from":"0","text":"Find Issues","to":"9999999999999"}],"type":"string"},{"alias":"","mappingType":1,"pattern":"/.*/","type":"hidden"}],"targets":[{"expr":"\n      sort_desc(\n        max by (type, stage, component) (\n          clamp_max(\n            gitlab_component_saturation:ratio:predict_linear_2w{\n              environment=\"$environment\",\n              type=\"redredis-cacheis\", stage=~\"|main\"\n            } +\n            2 *\n              gitlab_component_saturation:ratio:stddev_over_time_1w{\n                environment=\"$environment\",\n              type=\"redredis-cacheis\", stage=~\"|main\"\n              }\n          , 1\n          )\n          \u003e= on(component, monitor, env) group_left slo:max:soft:gitlab_component_saturation:ratio\n        )\n      )\n    ","format":"table","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"","refId":"A"}],"title":"Resources Forecasted to be at Risk of Saturation in 14d","transform":"table","type":"table"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Resource saturation levels for saturation components for this service. Lower is better.","fill":0,"gridPos":{"h":10,"w":24,"x":0,"y":30},"id":58,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^connection_pool/","color":"#FA9830"},{"alias":"/^cpu/","color":"#B877D9"},{"alias":"/^disk_space/","color":"#37852E"},{"alias":"/^memory/","color":"#E0B301"},{"alias":"/^redis_clients/","color":"#73BF69"},{"alias":"/^single_node_cpu/","color":"#FADE2A"},{"alias":"/^single_threaded_cpu/","color":"#F2495C"},{"alias":"/^workers/","color":"#5794F2"},{"alias":"/ trend$/","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"spaceLength":4}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(\n          max(\n            gitlab_component_saturation:ratio{\n              type=\"redredis-cacheis\",\n              environment=\"$environment\",\n              stage=~\"|main\"\n            }\n          ) by (component)\n          ,1),0)\n        ","format":"time_series","interval":"5m","intervalFactor":5,"legendFormat":"{{ component }}","refId":"A"}],"thresholds":[],"timeFrom":"21d","timeShift":null,"title":"Long-term Resource Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Percentage of time that resource is within capacity SLOs. Higher is better.","fill":0,"gridPos":{"h":10,"w":24,"x":0,"y":40},"id":59,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^connection_pool/","color":"#FA9830"},{"alias":"/^cpu/","color":"#B877D9"},{"alias":"/^disk_space/","color":"#37852E"},{"alias":"/^memory/","color":"#E0B301"},{"alias":"/^redis_clients/","color":"#73BF69"},{"alias":"/^single_node_cpu/","color":"#FADE2A"},{"alias":"/^single_threaded_cpu/","color":"#F2495C"},{"alias":"/^workers/","color":"#5794F2"},{"alias":"/ trend$/","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"spaceLength":4}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n          clamp_max(\n            max(\n              gitlab_component_saturation:ratio:avg_over_time_1w{\n                type=\"redredis-cacheis\",\n                environment=\"$environment\",\n                stage=~\"main|\"\n              }\n            ) by (component)\n          ,1),0)\n        ","format":"time_series","interval":"5m","intervalFactor":5,"legendFormat":"{{ component }}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":0.85,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"lt","value":0.95,"yaxis":"left"}],"timeFrom":"21d","timeShift":null,"title":"Long-term Resource Saturation - Rolling 1w average trend","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üìÜ Capacity Planning","titleSize":"h6","type":"row"}],"refresh":"","rows":[],"schemaVersion":16,"style":"dark","tags":["managed","redis-cache","redis-cache","overview"],"templating":{"list":[{"current":{"text":"Prometheus","value":"Prometheus"},"hide":0,"label":null,"name":"PROMETHEUS_DS","options":[],"query":"prometheus","refresh":1,"regex":"/(.*-gprd|Global)/","type":"datasource"},{"allValue":null,"current":{"text":"gprd","value":"gprd"},"datasource":"$PROMETHEUS_DS","hide":0,"includeAll":false,"label":null,"multi":false,"name":"environment","options":[],"query":"label_values(gitlab_service_ops:rate, environment)","refresh":1,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-6h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"utc","title":"redis-cache: Overview","uid":"redis-cache-main","version":182}}