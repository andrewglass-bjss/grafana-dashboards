{"meta":{"type":"db","canSave":false,"canEdit":false,"canAdmin":false,"canStar":true,"slug":"haproxy","url":"/d/ZOOh_aNik/haproxy","expires":"0001-01-01T00:00:00Z","created":"2018-06-21T11:37:57Z","updated":"2019-10-18T19:41:59Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":22,"hasAcl":false,"isFolder":false,"folderId":0,"folderTitle":"General","folderUrl":"","provisioned":false,"provisionedExternalId":""},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"description":"HAProxy backend servers","editable":true,"gnetId":2428,"graphTooltip":1,"id":null,"iteration":1571427665043,"links":[],"panels":[{"cards":{"cardPadding":null,"cardRound":null},"color":{"cardColor":"#b4ff00","colorScale":"sqrt","colorScheme":"interpolateOranges","exponent":0.5,"mode":"opacity"},"dataFormat":"tsbuckets","datasource":"Global","gridPos":{"h":8,"w":12,"x":0,"y":0},"heatmap":{},"hideZeroBuckets":false,"highlightCards":true,"id":104,"legend":{"show":false},"links":[],"options":{},"reverseYBuckets":false,"targets":[{"expr":"sum by (le) (\n  rate(haproxy_http_response_duration_seconds_bucket{env=\"$env\",fqdn=~\"$host\",backend_name=~\"$backend\"}[$__interval])\n) \u003e 0","format":"heatmap","interval":"10s","intervalFactor":2,"legendFormat":"{{le}}","refId":"A"}],"title":"Latency Heatmap","tooltip":{"show":true,"showHistogram":false},"type":"heatmap","xAxis":{"show":true},"xBucketNumber":null,"xBucketSize":null,"yAxis":{"decimals":null,"format":"s","logBase":1,"max":null,"min":null,"show":true,"splitFactor":null},"yBucketBound":"auto","yBucketNumber":null,"yBucketSize":null},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"","fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":0},"id":106,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(0.5, sum by (le) (rate(haproxy_http_response_duration_seconds_bucket{env=\"$env\",fqdn=~\"$host\",backend_name=~\"$backend\"}[$__interval])))","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"50th","refId":"A"},{"expr":"histogram_quantile(0.95, sum by (le) (rate(haproxy_http_response_duration_seconds_bucket{env=\"$env\",fqdn=~\"$host\",backend_name=~\"$backend\"}[$__interval])))","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"95th","refId":"B"},{"expr":"histogram_quantile(0.99, sum by (le) (rate(haproxy_http_response_duration_seconds_bucket{env=\"$env\",fqdn=~\"$host\",backend_name=~\"$backend\"}[$__interval])))","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"99th","refId":"C"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Percentile Latency","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":8},"id":86,"panels":[],"repeat":null,"title":"Basic Backend status","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":0,"fill":0,"fillGradient":0,"gridPos":{"h":4,"w":24,"x":0,"y":9},"id":85,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":3,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"Backends Down","color":"#890F02"},{"alias":"Backends Down","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg(\n  avg_over_time(haproxy_backend_up{env=\"$env\",backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])\n)","format":"time_series","hide":false,"interval":"30s","intervalFactor":2,"legendFormat":"Backends Up","refId":"A","step":60}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"lt","value":0.9,"yaxis":"left"}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Backends Up","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":13},"id":87,"panels":[],"repeat":null,"title":"Basic General Info","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","description":"","editable":true,"error":false,"fill":2,"fillGradient":0,"grid":{},"gridPos":{"h":10,"w":24,"x":0,"y":14},"id":83,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{"dataLinks":[]},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Back.*/","transform":"negative-Y"},{"alias":"/.*1.*/","color":"#6ED0E0"},{"alias":"/.*2.*/","color":"#7EB26D"},{"alias":"/.*3.*/","color":"#1F78C1"},{"alias":"/.*4.*/","color":"#CCA300"},{"alias":"/.*5.*/","color":"#890F02"},{"alias":"/.*other.*/","color":"#806EB7"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (code) (\n  rate(haproxy_frontend_http_responses_total{env=\"$env\",frontend=~\"$frontend\",code=~\"$code\",instance=~\"$host:$port\"}[$__interval])\n)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Frontend {{ code }}","metric":"","refId":"A","step":30},{"expr":"sum by (code) (\n  rate(haproxy_backend_http_responses_total{env=\"$env\",backend=~\"$backend\",code=~\"$code\",instance=~\"$host:$port\"}[$__interval])\n)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Backend {{ code }}","metric":"","refId":"B","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total responses by HTTP code","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":1,"description":"","editable":true,"error":false,"fill":2,"fillGradient":0,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":24},"id":75,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{"dataLinks":[]},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*OUT.*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(haproxy_frontend_bytes_in_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[$__interval])*8) by (instance)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"IN Front","metric":"","refId":"A","step":30},{"expr":"sum(rate(haproxy_frontend_bytes_out_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[$__interval])*8) by (instance)","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"OUT Front","refId":"B","step":60},{"expr":"sum by (instance) (\n  rate(haproxy_backend_bytes_in_total{env=\"$env\",backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])\n) * 8","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"IN Back","refId":"C","step":240},{"expr":"sum by (instance) (\n  rate(haproxy_backend_bytes_out_total{env=\"$env\",backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])\n) * 8","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"OUT Back","refId":"D","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Current total of incoming / outgoing bytes","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","description":"","editable":true,"error":false,"fill":2,"fillGradient":0,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":24},"id":79,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{"dataLinks":[]},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Back.*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (instance) (\n  rate(haproxy_frontend_connections_total{env=\"$env\",frontend=~\"$frontend\",instance=~\"$host:$port\"}[$__interval])\n)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Front","metric":"","refId":"A","step":30},{"expr":"sum by (instance) (\n  rate(haproxy_backend_connections_total{env=\"$env\",backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])\n)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Back","metric":"","refId":"B","step":30},{"expr":"sum(rate(haproxy_backend_connection_errors_total{backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Back errors","metric":"","refId":"C","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total number of connections","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":34},"id":81,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Response.*/","transform":"negative-Y"},{"alias":"/.*Backend.*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(haproxy_frontend_http_requests_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Requests","metric":"","refId":"A","step":30},{"expr":"sum(rate(haproxy_backend_response_errors_total{backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"Response errors","refId":"B","step":60},{"expr":"sum(rate(haproxy_frontend_request_errors_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Requests errors","metric":"","refId":"C","step":30},{"expr":"sum(rate(haproxy_backend_redispatch_warnings_total{backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"Backend redispatch","refId":"D","step":60},{"expr":"sum(rate(haproxy_backend_retry_warnings_total{backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"Backend retry","refId":"E","step":60},{"expr":"sum(rate(haproxy_frontend_requests_denied_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"Request denied","refId":"F","step":60},{"expr":"sum(haproxy_backend_current_queue{backend=~\"$backend\",instance=~\"$host:$port\"}) by (instance)","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"Backend Queued","refId":"G","step":60}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Total requests / responses","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":34},"id":84,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Back.*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(avg_over_time(haproxy_frontend_current_sessions{frontend=~\"$frontend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Frontend current sessions","metric":"","refId":"B","step":30},{"expr":"sum(avg_over_time(haproxy_backend_current_sessions{backend=~\"$backend\",instance=~\"$host:$port\"}[$__interval])) by (instance)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Backend current sessions","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Sessions","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":44},"id":88,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","decimals":1,"description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":45},"id":1,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*OUT.*/","transform":"negative-Y"}],"stack":false,"steppedLine":false,"targets":[{"expr":"rate(haproxy_backend_bytes_in_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])*8","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"IN-{{ backend }}","metric":"haproxy_backend_","refId":"A","step":30},{"expr":"rate(haproxy_backend_bytes_out_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])*8","format":"time_series","interval":"$__interval","intervalFactor":2,"legendFormat":"OUT-{{ backend }}","refId":"B","step":60}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Current total of incoming / outgoing bytes","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","decimals":1,"description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":45},"id":42,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*OUT.*/","transform":"negative-Y"}],"stack":false,"steppedLine":false,"targets":[{"expr":"rate(haproxy_frontend_bytes_in_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])*8","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"IN-{{ frontend }}","metric":"","refId":"A","step":30},{"expr":"rate(haproxy_frontend_bytes_out_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])*8","format":"time_series","interval":"$__interval","intervalFactor":2,"legendFormat":"OUT-{{ frontend }}","refId":"B","step":60}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Front - Current total of incoming / outgoing bytes","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"Throughput","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":45},"id":89,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":11,"w":12,"x":0,"y":46},"id":27,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Error.*/","transform":"negative-Y"}],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_backend_connections_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }}","metric":"","refId":"B","step":30},{"expr":"deriv(haproxy_backend_connection_errors_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"{{ backend }} Error","refId":"A","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Total number of connections OK / Error","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":11,"w":12,"x":12,"y":46},"id":43,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_frontend_connections_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ frontend }}","metric":"haproxy_backe","refId":"B","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Front - Total number of connections","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"Connections","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":46},"id":90,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":47},"id":32,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_backend_max_queue{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Maximum observed number of queued requests not assigned to any server","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":47},"id":28,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_backend_current_queue{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }}","metric":"haproxy_backend_current_queue","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Current number of queued requests not assigned to any server","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"Queue","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":47},"id":91,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":0,"y":48},"id":35,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Error.*/","transform":"negative-Y"}],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_backend_redispatch_warnings_total{backend=~\"$backend\", instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"Redispatch {{ backend }}","metric":"","refId":"A","step":30},{"expr":"deriv(haproxy_backend_retry_warnings_total{backend=~\"$backend\", instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":2,"legendFormat":"Retry {{ backend }}","refId":"B","step":60},{"expr":"deriv(haproxy_backend_response_errors_total{backend=~\"$backend\", instance=~\"$host:$port\"}[5m])","format":"time_series","intervalFactor":2,"legendFormat":"Error {{ backend }}","refId":"C","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Total of redispatch / error / retry warnings","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":12,"y":48},"id":46,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":1,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Error.*/","transform":"negative-Y"},{"alias":"/.*Denied.*/","transform":"negative-Y"}],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_frontend_http_requests_total{frontend=~\"$frontend\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ frontend }}","metric":"","refId":"A","step":30},{"expr":"deriv(haproxy_frontend_request_errors_total{frontend=~\"$frontend\", instance=~\"$host:$port\"}[5m])","format":"time_series","intervalFactor":2,"legendFormat":"{{ frontend }} Error","refId":"B","step":240},{"expr":"deriv(haproxy_frontend_requests_denied_total{frontend=~\"$frontend\", instance=~\"$host:$port\"}[5m])","format":"time_series","intervalFactor":2,"legendFormat":"{{ frontend }} Denied","refId":"C","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Front - Total HTTP requests OK / Error / Denied","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"Requests / Responses","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":48},"id":92,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":11,"w":12,"x":0,"y":49},"id":24,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"rate(haproxy_backend_http_responses_total{backend=~\"$backend\", code=~\"$code\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ code }} {{ backend }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Total of HTTP responses","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":11,"w":12,"x":12,"y":49},"id":47,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_frontend_http_responses_total{frontend=~\"$frontend\", code=~\"$code\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ code }} {{ frontend }} ","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Front - Total of HTTP responses","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"Responses by HTTP code","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":49},"id":93,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":50},"id":30,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum without (fqdn,instance) (\n  avg_over_time(haproxy_backend_current_sessions{env=\"$env\",backend=~\"$backend\",fqdn=~\"$host\"}[$__interval])\n)","format":"time_series","hide":false,"interval":"30s","intervalFactor":1,"legendFormat":"{{backend}}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Current number of active sessions","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":50},"id":45,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_frontend_current_sessions{frontend=~\"$frontend\",instance=~\"$host:$port\"}","format":"time_series","hide":false,"interval":"$__interval","intervalFactor":1,"legendFormat":"{{ frontend }}","metric":"haproxy_backend_current_queue","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Front - Current number of active sessions","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","description":"","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":60},"id":29,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum without (fqdn,instance) (\n  rate(haproxy_backend_sessions_total{env=\"$env\",backend=~\"$backend\",fqdn=~\"$host\"}[$__interval])\n)","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ backend }}","metric":"haproxy_backend_current_queue","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Current number of sessions rate per second over last elapsed second","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":60},"id":44,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_frontend_current_session_rate{frontend=~\"$frontend\",instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ frontend }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Front - Current number of sessions rate per second over last elapsed second","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":70},"id":34,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"maxPerRow":4,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*limit.*/","fill":0}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_backend_max_sessions{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","hide":false,"interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }}","metric":"","refId":"A","step":30},{"expr":"haproxy_backend_limit_sessions{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","intervalFactor":2,"legendFormat":"{{ backend }} limit","refId":"B","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Maximum observed number of active sessions and limit","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":70},"id":51,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":4,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*limit.*/","fill":0}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"haproxy_frontend_max_sessions{frontend=~\"$frontend\",instance=~\"$host:$port\"}","format":"time_series","hide":false,"interval":"$__interval","intervalFactor":1,"legendFormat":"{{ frontend }}","metric":"","refId":"A","step":30},{"expr":"haproxy_frontend_limit_sessions{frontend=~\"$frontend\",instance=~\"$host:$port\"}","format":"time_series","intervalFactor":2,"legendFormat":"{{ frontend }} limit","refId":"B","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Front - Maximum observed number of active sessions and limit","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":80},"id":33,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_backend_max_session_rate{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","hide":false,"interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Maximum number of sessions rate per second","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":80},"id":69,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":3,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*limit.*/","fill":0}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_frontend_max_session_rate{frontend=~\"$frontend\",instance=~\"$host:$port\"}","format":"time_series","hide":false,"interval":"$__interval","intervalFactor":1,"legendFormat":"{{ frontend }}","metric":"","refId":"A","step":30},{"expr":"haproxy_frontend_limit_session_rate{frontend=~\"$frontend\",instance=~\"$host:$port\"}","format":"time_series","intervalFactor":2,"legendFormat":"{{ frontend }} limit","refId":"B","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Front - Maximum number of sessions rate per second and limit","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"Sessions","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":50},"id":94,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","decimals":0,"description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":8,"w":12,"x":0,"y":51},"id":38,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_backend_up{backend=~\"$backend\", instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Current health status of the backend","tooltip":{"msResolution":true,"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":8,"w":12,"x":12,"y":51},"id":39,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_backend_weight{backend=~\"$backend\", instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Back - Total weight of the servers in the backend / Active servers backend","tooltip":{"msResolution":true,"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"Health and Weight","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":51},"id":95,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","decimals":1,"description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":15,"w":24,"x":0,"y":52},"id":54,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":1,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*OUT.*/","transform":"negative-Y"}],"stack":false,"steppedLine":false,"targets":[{"expr":"rate(haproxy_server_bytes_in_total{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}[5m])*8","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"IN-{{ backend }} / {{ server }}","metric":"","refId":"A","step":30},{"expr":"rate(haproxy_server_bytes_out_total{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}[5m])*8","format":"time_series","interval":"$__interval","intervalFactor":2,"legendFormat":"OUT-{{ backend }} / {{ server }}","refId":"B","step":60}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Current total of incoming / outgoing bytes","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"By Server Throughput","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":52},"id":96,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":11,"w":24,"x":0,"y":53},"id":58,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":1,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_server_connections_total{backend=~\"$backend\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"haproxy_backe","refId":"B","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Total number of connections","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"none","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"By Server Connections","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":53},"id":97,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":0,"y":54},"id":65,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_server_max_queue{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Maximum observed number of queued requests assigned to this server","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":12,"x":12,"y":54},"id":59,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_server_current_queue{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Current number of queued requests assigned to this server","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"By Server Queue","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":54},"id":98,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":0,"y":55},"id":74,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Error.*/","transform":"negative-Y"}],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(deriv(haproxy_server_http_responses_total{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}[5m])) by (server)","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} {{ server }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Total of HTTP responses OK","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":12,"y":55},"id":71,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*Error.*/","transform":"negative-Y"}],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_server_retry_warnings_total{backend=~\"$backend\", instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"Retry {{ backend }} {{ server }}","metric":"","refId":"A","step":30},{"expr":"haproxy_server_redispatch_warnings_total{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":2,"legendFormat":"Redispatch {{ backend }} {{ server }}","refId":"B","step":60},{"expr":"deriv(haproxy_server_response_errors_total{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":2,"legendFormat":"Error {{ backend }} {{ server }}","refId":"C","step":60}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Total of retry / error / redispatch warnings","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"By Server Requests / Responses","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":55},"id":99,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":10,"w":24,"x":0,"y":56},"height":"400px","id":64,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"deriv(haproxy_server_http_responses_total{backend=~\"$backend\",server=~\"$server\",code=~\"$code\",instance=~\"$host:$port\"}[5m])","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} {{ server }} {{ code }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Total of HTTP responses","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"By Server Responses by HTTP code","type":"row"},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":56},"id":100,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":9,"w":12,"x":0,"y":57},"id":61,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_server_current_sessions{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"haproxy_backend_current_queue","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Current number of active sessions","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":9,"w":12,"x":12,"y":57},"id":60,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"haproxy_server_current_session_rate{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"haproxy_backend_current_queue","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Current number of sessions rate per second over last elapsed second","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":9,"w":12,"x":0,"y":66},"id":66,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_server_max_session_rate{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Maximum observed number of sessions rate per second","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":9,"w":12,"x":12,"y":66},"id":67,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_server_max_sessions{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Maximum observed number of active sessions","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"By Server Sessions","type":"row"},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":57},"id":101,"panels":[],"repeat":null,"title":"By Server Health Weight","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":0,"y":58},"id":62,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":1,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_server_downtime_seconds_total{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"haproxy_backend_current_queue","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Total downtime in seconds","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":1,"description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":12,"y":58},"id":56,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":1,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"increase(haproxy_server_check_failures_total{env=\"$env\",backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}[$__interval])","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Total number of failed health checks","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"none","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","decimals":0,"description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":0,"y":70},"id":57,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":1,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(haproxy_server_connection_errors_total{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}[$__interval])","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Total of connection errors","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"none","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","decimals":1,"description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":12,"y":70},"id":55,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":1,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_server_check_duration_milliseconds{backend=~\"$backend\",server=~\"$server\",instance=~\"$host:$port\"}","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Previously run health check duration, in milliseconds","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":0,"y":82},"id":72,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_server_up{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"haproxy_backend_current_queue","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Current health status of the server","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"none","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","description":"","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":12,"w":12,"x":12,"y":82},"id":73,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"maxPerRow":2,"nullPointMode":"null","options":{},"paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"haproxy_server_weight{backend=~\"$backend\",instance=~\"$host:$port\"}","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{ backend }} / {{ server }}","metric":"haproxy_backend_current_queue","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server - Current weight of the server","tooltip":{"msResolution":true,"shared":false,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"none","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":94},"id":102,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":95},"id":40,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"maxPerRow":1,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"haproxy_exporter_csv_parse_failures{instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"Exporter csv failures","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Number of errors while parsing CSV","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":95},"id":41,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"maxPerRow":1,"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"haproxy_exporter_total_scrapes{instance=~\"$host:$port\"}","format":"time_series","interval":"$__interval","intervalFactor":1,"legendFormat":"HAProxy scrapes","metric":"","refId":"A","step":30}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Current total HAProxy scrapes","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"Scrape info","type":"row"}],"refresh":"5m","schemaVersion":20,"style":"dark","tags":["haproxy","servers"],"templating":{"list":[{"allValue":null,"current":{"selected":true,"text":"gprd","value":"gprd"},"datasource":"Global","definition":"label_values(haproxy_up, env)","hide":0,"includeAll":false,"label":null,"multi":false,"name":"env","options":[],"query":"label_values(haproxy_up, env)","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"All","value":"$__all"},"datasource":"Global","definition":"label_values(haproxy_up{env=\"$env\"}, fqdn)","hide":0,"includeAll":true,"label":"Host","multi":false,"name":"host","options":[],"query":"label_values(haproxy_up{env=\"$env\"}, fqdn)","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":null,"tags":[],"tagsQuery":null,"type":"query","useTags":false},{"allValue":null,"current":{"text":"9101","value":"9101"},"datasource":"Global","definition":"label_values(haproxy_up{env=\"$env\"}, instance)","hide":2,"includeAll":false,"label":null,"multi":false,"name":"port","options":[],"query":"label_values(haproxy_up{env=\"$env\"}, instance)","refresh":2,"regex":"/[^:]+:(.*)/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"tags":[],"text":"api","value":["api"]},"datasource":"Global","definition":"label_values(haproxy_backend_bytes_in_total{env=\"$env\",fqdn=~\"$host\"}, backend)","hide":0,"includeAll":false,"label":"Backend","multi":false,"name":"backend","options":[],"query":"label_values(haproxy_backend_bytes_in_total{env=\"$env\",fqdn=~\"$host\"}, backend)","refresh":1,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":null,"tags":[],"tagsQuery":null,"type":"query","useTags":false},{"allValue":null,"current":{"text":"All","value":"$__all"},"datasource":"Global","definition":"label_values(haproxy_frontend_bytes_in_total{env=\"$env\",fqdn=~\"$host\"}, frontend)","hide":0,"includeAll":true,"label":"Frontend","multi":true,"name":"frontend","options":[],"query":"label_values(haproxy_frontend_bytes_in_total{env=\"$env\",fqdn=~\"$host\"}, frontend)","refresh":1,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":null,"tags":[],"tagsQuery":null,"type":"query","useTags":true},{"allValue":null,"current":{"text":"All","value":"$__all"},"datasource":"prometheus-01-inf-gprd","definition":"label_values(haproxy_server_bytes_in_total{fqdn=~\"$host\", backend=~\"$backend\"}, server)","hide":0,"includeAll":true,"label":"Server","multi":true,"name":"server","options":[],"query":"label_values(haproxy_server_bytes_in_total{fqdn=~\"$host\", backend=~\"$backend\"}, server)","refresh":1,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":null,"tags":[],"tagsQuery":null,"type":"query","useTags":false},{"allValue":null,"current":{"text":"All","value":"$__all"},"datasource":"prometheus-01-inf-gprd","definition":"label_values(haproxy_server_http_responses_total{fqdn=~\"$host\", backend=~\"$backend\", server=~\"$server\"}, code)","hide":0,"includeAll":true,"label":"HTTP Code","multi":true,"name":"code","options":[],"query":"label_values(haproxy_server_http_responses_total{fqdn=~\"$host\", backend=~\"$backend\", server=~\"$server\"}, code)","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":null,"tags":[],"tagsQuery":null,"type":"query","useTags":false}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"HAProxy","uid":"ZOOh_aNik","version":22}}