{"meta":{"type":"db","canSave":true,"canEdit":true,"canAdmin":true,"canStar":true,"slug":"gitaly","url":"/d/000000176/gitaly","expires":"0001-01-01T00:00:00Z","created":"2017-03-17T17:42:07Z","updated":"2018-07-10T13:34:43Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":61,"hasAcl":false,"isFolder":false,"folderId":310,"folderTitle":"Gitaly Dashboards","folderUrl":"/dashboards/f/eVNL3GOmk/gitaly-dashboards","provisioned":false},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":1,"id":null,"links":[{"icon":"external link","includeVars":true,"keepTime":true,"tags":["GitalyMain","Gitaly"],"type":"dashboards"},{"icon":"external link","tags":[],"targetBlank":true,"title":"Gitaly ELK Dashboard","type":"link","url":"https://log.gitlap.com/app/kibana#/dashboard/AV9yB9NXhxCLbdva5TiP"}],"panels":[{"collapsed":false,"gridPos":{"h":3,"w":24,"x":0,"y":0},"id":22,"panels":[],"repeat":null,"title":"Navigation","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"datasource":"Prometheus in Azure","decimals":2,"description":"","format":"ops","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":6,"x":0,"y":1},"height":"100px","id":15,"interval":null,"links":[{"dashUri":"db/gitaly-features-overview","dashboard":"Gitaly Features Overview","includeVars":true,"keepTime":true,"title":"Gitaly Features Overview","type":"dashboard"}],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"sum(gitaly:grpc_server_handled_total:rate1m{job=\"$job\", environment=\"$environment\"})","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":60,"tags":[]}],"thresholds":"","title":"Feature Overview","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"datasource":"Prometheus in Azure","decimals":2,"format":"ops","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":6,"x":6,"y":1},"height":"100px","id":16,"interval":null,"links":[{"dashUri":"db/gitaly-global-nfs-stats","dashboard":"Gitaly Global NFS Stats","includeVars":true,"keepTime":true,"targetBlank":false,"title":"Gitaly Global NFS Stats","type":"dashboard"}],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"sum(rate(node_nfs_rpc_operations{environment=\"$environment\"}[1m]))","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":60,"tags":[]}],"thresholds":"","title":"NFS Operations","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"datasource":"Prometheus in Azure","decimals":2,"format":"percentunit","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":6,"x":12,"y":1},"height":"100px","id":17,"interval":null,"links":[{"dashUri":"db/gitaly-fleet-overview","dashboard":"Gitaly Fleet Overview","includeVars":true,"keepTime":true,"title":"Gitaly Fleet Overview","type":"dashboard"}],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"1 - avg(rate(node_cpu{environment=\"$environment\", tier=\"stor\", mode=\"idle\", type=\"gitaly\"}[10m]))","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":60,"tags":[]}],"thresholds":"","title":"Gitaly Fleet (cpu)","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus in Azure","decimals":3,"format":"percentunit","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":6,"x":18,"y":1},"id":18,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"(1 - avg(gitaly:grpc_server_handled_total:error_rate1m{job=\"$job\", environment=\"$environment\"}) / avg(gitaly:grpc_server_handled_total:rate1m{job=\"$job\", environment=\"$environment\"}))","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":60,"tags":[]}],"thresholds":"99.9,99.0","title":"Service Level","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"collapsed":false,"gridPos":{"h":7,"w":24,"x":0,"y":4},"id":23,"panels":[],"repeat":null,"title":"Dashboard Row","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"Prometheus in Azure","decimals":0,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":7,"w":6,"x":0,"y":5},"id":20,"interval":null,"links":[{"dashUri":"db/gitaly-alerting","dashboard":"Gitaly Alerting","includeVars":true,"keepTime":true,"targetBlank":false,"title":"Gitaly Alerting","type":"dashboard"}],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":" alerts","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"sum(ALERTS{alertstate=\"firing\", channel=\"gitaly\"})","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":"","title":"Gitaly Alerting","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"0","value":"null"},{"op":"=","text":"0","value":"N/A"}],"valueName":"avg"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"Prometheus in Azure","decimals":null,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":7,"w":6,"x":6,"y":5},"id":21,"interval":null,"links":[{"dashUri":"db/gitaly-version-tracker","dashboard":"Gitaly Version Tracker","includeVars":true,"keepTime":true,"title":"Gitaly Version Tracker","type":"dashboard"}],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"rgb(31, 120, 193)","show":true},"tableColumn":"version","targets":[{"dsType":"influxdb","expr":"sum(gitlab_build_info{job=\"$job\", environment=\"$environment\"}) by (version) ","format":"table","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"instant":true,"interval":"","intervalFactor":2,"legendFormat":"{{ version }}","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":"","title":"Primary Gitaly Version","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"}],"refresh":"5m","schemaVersion":16,"style":"dark","tags":["Gitaly","GitalyMain"],"templating":{"list":[{"allValue":null,"current":{"text":"gitaly","value":"gitaly"},"datasource":"Prometheus in Azure","hide":0,"includeAll":false,"label":"Job","multi":false,"name":"job","options":[],"query":"label_values(up{job=~\"^gitaly.*\"}, job)","refresh":2,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"prd","value":"prd"},"datasource":"Prometheus in Azure","hide":0,"includeAll":false,"label":null,"multi":false,"name":"environment","options":[],"query":"label_values(up{job=~\"gitaly.*\"}, environment)","refresh":2,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"utc","title":"Gitaly","uid":"000000176","version":61}}