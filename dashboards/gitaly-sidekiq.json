{"meta":{"type":"db","canSave":true,"canEdit":true,"canAdmin":true,"canStar":true,"slug":"gitaly-sidekiq","url":"/d/000000182/gitaly-sidekiq","expires":"0001-01-01T00:00:00Z","created":"2017-05-15T15:21:53Z","updated":"2018-07-10T13:34:44Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":31,"hasAcl":false,"isFolder":false,"folderId":310,"folderTitle":"Gitaly Dashboards","folderUrl":"/dashboards/f/eVNL3GOmk/gitaly-dashboards","provisioned":false},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"links":[],"panels":[{"collapsed":false,"gridPos":{"h":7,"w":24,"x":0,"y":0},"id":28,"panels":[],"repeat":null,"title":"Timings","type":"row"},{"aliasColors":{"Amount":"#9AC48A"},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus on prometheus-app-01","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":1},"id":1,"interval":"1m","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"alias":"$col","dsType":"influxdb","expr":"sum by (action) (controller_action:gitlab_transaction_duration_seconds_count:rate1m{environment=\"$env\",job=\"$job\",controller=\"$controller\"})","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"1m rate","policy":"default","query":"SELECT \"count\" AS \"Amount\" FROM downsampled.rails_transaction_counts_per_action WHERE $timeFilter AND \"action\" =~ /^[[action]]$/","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Total Transactions","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","logBase":1,"max":null,"min":"0","show":true},{"format":"short","logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{"Amount":"#9AC48A"},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus on prometheus-app-01","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":1},"id":27,"interval":"1m","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"alias":"$col","dsType":"influxdb","expr":"sum by(controller) (rate(gitaly_controller_action_duration_seconds_sum{environment=\"$env\",job=\"$job\",controller=\"$controller\"}[1m]))","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"1m rate","policy":"default","query":"SELECT \"count\" AS \"Amount\" FROM downsampled.rails_transaction_counts_per_action WHERE $timeFilter AND \"action\" =~ /^[[action]]$/","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Gitaly Transactions","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","logBase":1,"max":null,"min":"0","show":true},{"format":"short","logBase":1,"max":null,"min":null,"show":true}]},{"collapsed":false,"gridPos":{"h":7,"w":24,"x":0,"y":8},"id":29,"panels":[],"repeat":null,"title":"New row","type":"row"},{"aliasColors":{"95th Percentile":"#9AC48A","99th Percentile":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus on prometheus-app-01","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":9},"id":21,"interval":"1m","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"alias":"$col","dsType":"influxdb","expr":"histogram_quantile(0.99, sum(gitaly_controller_action_duration_seconds_bucket{controller=\"$controller\",job=\"gitlab-sidekiq\",environment=\"$env\"}) by (le, rpc))","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"{{rpc}}","policy":"default","query":"SELECT \"rails_queue_duration_95th\" AS \"95th Percentile\", \"rails_queue_duration_99th\" AS \"99th Percentile\", \"rails_queue_duration_mean\" AS \"Mean\" FROM downsampled.rails_transaction_timings_per_action WHERE $timeFilter AND \"action\" =~ /^[[action]]$/","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Gitaly Transaction Timings 99 percentile","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","logBase":1,"max":null,"min":null,"show":true},{"format":"short","logBase":1,"max":null,"min":null,"show":true}]}],"refresh":false,"schemaVersion":16,"style":"dark","tags":[],"templating":{"list":[{"allValue":null,"current":{"text":"prd","value":"prd"},"datasource":"Prometheus on prometheus-app-01","hide":0,"includeAll":false,"label":"Environment","multi":false,"name":"env","options":[],"query":"label_values(gitlab_transaction_duration_seconds_count, environment)","refresh":1,"regex":"","sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"current":{"text":"gitlab-sidekiq","value":"gitlab-sidekiq"},"hide":0,"label":"Job","name":"job","options":[{"selected":true,"text":"gitlab-sidekiq","value":"gitlab-sidekiq"}],"query":"gitlab-sidekiq","type":"constant"},{"allValue":null,"current":{"tags":[],"text":"ProcessCommitWorker","value":"ProcessCommitWorker"},"datasource":"Prometheus on prometheus-app-01","hide":0,"includeAll":false,"label":"Controller","multi":false,"name":"controller","options":[{"selected":false,"text":"ActiveJob::QueueAdapters::SidekiqAdapter::JobWrapper","value":"ActiveJob::QueueAdapters::SidekiqAdapter::JobWrapper"},{"selected":false,"text":"ArchiveTraceWorker","value":"ArchiveTraceWorker"},{"selected":false,"text":"AuthorizedProjectsWorker","value":"AuthorizedProjectsWorker"},{"selected":false,"text":"BackgroundMigrationWorker","value":"BackgroundMigrationWorker"},{"selected":false,"text":"BuildFinishedWorker","value":"BuildFinishedWorker"},{"selected":false,"text":"BuildHooksWorker","value":"BuildHooksWorker"},{"selected":false,"text":"BuildQueueWorker","value":"BuildQueueWorker"},{"selected":false,"text":"BuildSuccessWorker","value":"BuildSuccessWorker"},{"selected":false,"text":"ChatNotificationWorker","value":"ChatNotificationWorker"},{"selected":false,"text":"CheckGcpProjectBillingWorker","value":"CheckGcpProjectBillingWorker"},{"selected":false,"text":"ClusterInstallAppWorker","value":"ClusterInstallAppWorker"},{"selected":false,"text":"ClusterProvisionWorker","value":"ClusterProvisionWorker"},{"selected":false,"text":"ClusterWaitForAppInstallationWorker","value":"ClusterWaitForAppInstallationWorker"},{"selected":false,"text":"ClusterWaitForIngressIpAddressWorker","value":"ClusterWaitForIngressIpAddressWorker"},{"selected":false,"text":"CreateGithubWebhookWorker","value":"CreateGithubWebhookWorker"},{"selected":false,"text":"CreateGpgSignatureWorker","value":"CreateGpgSignatureWorker"},{"selected":false,"text":"CreatePipelineWorker","value":"CreatePipelineWorker"},{"selected":false,"text":"DeleteMergedBranchesWorker","value":"DeleteMergedBranchesWorker"},{"selected":false,"text":"DeleteUserWorker","value":"DeleteUserWorker"},{"selected":false,"text":"EmailReceiverWorker","value":"EmailReceiverWorker"},{"selected":false,"text":"EmailsOnPushWorker","value":"EmailsOnPushWorker"},{"selected":false,"text":"ExpireBuildArtifactsWorker","value":"ExpireBuildArtifactsWorker"},{"selected":false,"text":"ExpireJobCacheWorker","value":"ExpireJobCacheWorker"},{"selected":false,"text":"ExpirePipelineCacheWorker","value":"ExpirePipelineCacheWorker"},{"selected":false,"text":"ExportCsvWorker","value":"ExportCsvWorker"},{"selected":false,"text":"Geo::MetricsUpdateWorker","value":"Geo::MetricsUpdateWorker"},{"selected":false,"text":"Geo::MigratedLocalFilesCleanUpWorker","value":"Geo::MigratedLocalFilesCleanUpWorker"},{"selected":false,"text":"Geo::PruneEventLogWorker","value":"Geo::PruneEventLogWorker"},{"selected":false,"text":"Geo::RepositoryVerification::Primary::BatchWorker","value":"Geo::RepositoryVerification::Primary::BatchWorker"},{"selected":false,"text":"Geo::RepositoryVerification::Secondary::SchedulerWorker","value":"Geo::RepositoryVerification::Secondary::SchedulerWorker"},{"selected":false,"text":"Geo::SidekiqCronConfigWorker","value":"Geo::SidekiqCronConfigWorker"},{"selected":false,"text":"GitGarbageCollectWorker","value":"GitGarbageCollectWorker"},{"selected":false,"text":"Gitlab::GithubImport::AdvanceStageWorker","value":"Gitlab::GithubImport::AdvanceStageWorker"},{"selected":false,"text":"Gitlab::GithubImport::ImportDiffNoteWorker","value":"Gitlab::GithubImport::ImportDiffNoteWorker"},{"selected":false,"text":"Gitlab::GithubImport::ImportIssueWorker","value":"Gitlab::GithubImport::ImportIssueWorker"},{"selected":false,"text":"Gitlab::GithubImport::ImportNoteWorker","value":"Gitlab::GithubImport::ImportNoteWorker"},{"selected":false,"text":"Gitlab::GithubImport::ImportPullRequestWorker","value":"Gitlab::GithubImport::ImportPullRequestWorker"},{"selected":false,"text":"Gitlab::GithubImport::RefreshImportJidWorker","value":"Gitlab::GithubImport::RefreshImportJidWorker"},{"selected":false,"text":"Gitlab::GithubImport::Stage::FinishImportWorker","value":"Gitlab::GithubImport::Stage::FinishImportWorker"},{"selected":false,"text":"Gitlab::GithubImport::Stage::ImportBaseDataWorker","value":"Gitlab::GithubImport::Stage::ImportBaseDataWorker"},{"selected":false,"text":"Gitlab::GithubImport::Stage::ImportIssuesAndDiffNotesWorker","value":"Gitlab::GithubImport::Stage::ImportIssuesAndDiffNotesWorker"},{"selected":false,"text":"Gitlab::GithubImport::Stage::ImportNotesWorker","value":"Gitlab::GithubImport::Stage::ImportNotesWorker"},{"selected":false,"text":"Gitlab::GithubImport::Stage::ImportPullRequestsWorker","value":"Gitlab::GithubImport::Stage::ImportPullRequestsWorker"},{"selected":false,"text":"Gitlab::GithubImport::Stage::ImportRepositoryWorker","value":"Gitlab::GithubImport::Stage::ImportRepositoryWorker"},{"selected":false,"text":"GitlabShellWorker","value":"GitlabShellWorker"},{"selected":false,"text":"GroupDestroyWorker","value":"GroupDestroyWorker"},{"selected":false,"text":"ImportExportProjectCleanupWorker","value":"ImportExportProjectCleanupWorker"},{"selected":false,"text":"InvalidGpgSignatureUpdateWorker","value":"InvalidGpgSignatureUpdateWorker"},{"selected":false,"text":"IrkerWorker","value":"IrkerWorker"},{"selected":false,"text":"LdapAllGroupsSyncWorker","value":"LdapAllGroupsSyncWorker"},{"selected":false,"text":"MergeWorker","value":"MergeWorker"},{"selected":false,"text":"NewIssueWorker","value":"NewIssueWorker"},{"selected":false,"text":"NewMergeRequestWorker","value":"NewMergeRequestWorker"},{"selected":false,"text":"NewNoteWorker","value":"NewNoteWorker"},{"selected":false,"text":"ObjectStorage::BackgroundMoveWorker","value":"ObjectStorage::BackgroundMoveWorker"},{"selected":false,"text":"PagesDomainVerificationCronWorker","value":"PagesDomainVerificationCronWorker"},{"selected":false,"text":"PagesDomainVerificationWorker","value":"PagesDomainVerificationWorker"},{"selected":false,"text":"PagesWorker","value":"PagesWorker"},{"selected":false,"text":"PipelineHooksWorker","value":"PipelineHooksWorker"},{"selected":false,"text":"PipelineMetricsWorker","value":"PipelineMetricsWorker"},{"selected":false,"text":"PipelineNotificationWorker","value":"PipelineNotificationWorker"},{"selected":false,"text":"PipelineProcessWorker","value":"PipelineProcessWorker"},{"selected":false,"text":"PipelineScheduleWorker","value":"PipelineScheduleWorker"},{"selected":false,"text":"PipelineSuccessWorker","value":"PipelineSuccessWorker"},{"selected":false,"text":"PipelineUpdateWorker","value":"PipelineUpdateWorker"},{"selected":false,"text":"PostReceive","value":"PostReceive"},{"selected":true,"text":"ProcessCommitWorker","value":"ProcessCommitWorker"},{"selected":false,"text":"ProjectCacheWorker","value":"ProjectCacheWorker"},{"selected":false,"text":"ProjectDestroyWorker","value":"ProjectDestroyWorker"},{"selected":false,"text":"ProjectExportWorker","value":"ProjectExportWorker"},{"selected":false,"text":"ProjectImportScheduleWorker","value":"ProjectImportScheduleWorker"},{"selected":false,"text":"ProjectServiceWorker","value":"ProjectServiceWorker"},{"selected":false,"text":"PruneOldEventsWorker","value":"PruneOldEventsWorker"},{"selected":false,"text":"ReactiveCachingWorker","value":"ReactiveCachingWorker"},{"selected":false,"text":"RebaseWorker","value":"RebaseWorker"},{"selected":false,"text":"RepositoryArchiveCacheWorker","value":"RepositoryArchiveCacheWorker"},{"selected":false,"text":"RepositoryCheck::BatchWorker","value":"RepositoryCheck::BatchWorker"},{"selected":false,"text":"RepositoryForkWorker","value":"RepositoryForkWorker"},{"selected":false,"text":"RepositoryImportWorker","value":"RepositoryImportWorker"},{"selected":false,"text":"RepositoryRemoveRemoteWorker","value":"RepositoryRemoveRemoteWorker"},{"selected":false,"text":"RepositoryUpdateMirrorWorker","value":"RepositoryUpdateMirrorWorker"},{"selected":false,"text":"RepositoryUpdateRemoteMirrorWorker","value":"RepositoryUpdateRemoteMirrorWorker"},{"selected":false,"text":"RunPipelineScheduleWorker","value":"RunPipelineScheduleWorker"},{"selected":false,"text":"StageUpdateWorker","value":"StageUpdateWorker"},{"selected":false,"text":"StuckCiJobsWorker","value":"StuckCiJobsWorker"},{"selected":false,"text":"StuckImportJobsWorker","value":"StuckImportJobsWorker"},{"selected":false,"text":"StuckMergeJobsWorker","value":"StuckMergeJobsWorker"},{"selected":false,"text":"SystemHookPushWorker","value":"SystemHookPushWorker"},{"selected":false,"text":"UpdateAllMirrorsWorker","value":"UpdateAllMirrorsWorker"},{"selected":false,"text":"UpdateHeadPipelineForMergeRequestWorker","value":"UpdateHeadPipelineForMergeRequestWorker"},{"selected":false,"text":"UpdateMergeRequestsWorker","value":"UpdateMergeRequestsWorker"},{"selected":false,"text":"WaitForClusterCreationWorker","value":"WaitForClusterCreationWorker"},{"selected":false,"text":"WebHookWorker","value":"WebHookWorker"}],"query":"label_values(gitlab_transaction_duration_seconds_count{job=\"$job\"}, controller)","refresh":0,"regex":"","sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-3h","to":"now"},"timepicker":{"now":true,"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"utc","title":"Gitaly - Sidekiq","uid":"000000182","version":31}}