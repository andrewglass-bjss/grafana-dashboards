{"meta":{"type":"db","canSave":false,"canEdit":false,"canAdmin":false,"canStar":true,"slug":"nfs-mountstats","url":"/d/keQ9P_-iz/nfs-mountstats","expires":"0001-01-01T00:00:00Z","created":"2019-06-12T16:28:29Z","updated":"2019-06-14T06:05:29Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":5,"hasAcl":false,"isFolder":false,"folderId":186,"folderTitle":"Operations","folderUrl":"/dashboards/f/KN7OgCSiz/operations","provisioned":false,"provisionedExternalId":""},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"prometheus-01-inf-gprd","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","limit":100,"name":"Annotations \u0026 Alerts","showIn":0,"type":"dashboard"}]},"description":"NFS mountstats monitor for prometheus-node-exporter","editable":true,"gnetId":8862,"graphTooltip":0,"id":null,"iteration":1560492098209,"links":[],"panels":[{"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":274,"title":"NFS","type":"row"},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","fill":4,"gridPos":{"h":10,"w":24,"x":0,"y":1},"id":248,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/sent.*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(node_mountstats_nfs_operations_received_bytes_total{instance=~\"$node:$port\",job=~\"$job\"}[$__interval])) by (export)","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"received - {{export}}","refId":"O","step":240},{"expr":"sum(rate(node_mountstats_nfs_operations_sent_bytes_total{instance=~\"$node:$port\",job=~\"$job\"}[$__interval])) by (export)","format":"time_series","interval":"30s","intervalFactor":2,"legendFormat":"sent - {{export}}","refId":"A","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"NFS Receive/Send Total","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Bytes recieved(-) / send(+)","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","fill":4,"gridPos":{"h":10,"w":24,"x":0,"y":11},"id":267,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(irate(node_mountstats_nfs_operations_requests_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])) by (export)","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"Requests - {{export}}","refId":"O","step":240},{"expr":"sum(irate(node_mountstats_nfs_operations_transmissions_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])) by (export)","format":"time_series","intervalFactor":1,"legendFormat":"Transmissions - {{export}}","refId":"A"},{"expr":"sum(irate(node_mountstats_nfs_major_timeouts_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])) by (export)","format":"time_series","intervalFactor":1,"legendFormat":"Major timeouts - {{export}}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"NFS Requests Total","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"reqps","label":"Requests","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","fill":4,"gridPos":{"h":11,"w":24,"x":0,"y":21},"id":269,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(irate(node_mountstats_nfs_operations_response_time_seconds_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])) by (export)","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{export}} - Response time","refId":"O","step":240},{"expr":"sum(irate(node_mountstats_nfs_operations_request_time_seconds_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])) by (export)","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{export}} - Request time","refId":"A","step":240},{"expr":"sum(irate(node_mountstats_nfs_operations_queue_time_seconds_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])) by (export)","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{export}} - Queue time","refId":"B","step":240}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"NFS Response/Request time Total","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Response time","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":32},"id":260,"panels":[{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","fill":4,"gridPos":{"h":10,"w":24,"x":0,"y":33},"id":275,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*send.*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(node_mountstats_nfs_operations_received_bytes_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])","format":"time_series","intervalFactor":2,"legendFormat":"NFS bytes received - {{operation}}","refId":"O","step":240},{"expr":"irate(node_mountstats_nfs_operations_sent_bytes_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])","format":"time_series","intervalFactor":2,"legendFormat":"NFS bytes send - {{operation}}","refId":"A","step":240}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"NFS Receive/Send","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Bytes recieved(-) / send(+)","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","fill":4,"gridPos":{"h":10,"w":24,"x":0,"y":43},"id":276,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(node_mountstats_nfs_operations_requests_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{operation}}","refId":"O","step":240}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"NFS Requests","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"reqps","label":"Requests","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","fill":4,"gridPos":{"h":11,"w":24,"x":0,"y":53},"id":277,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(node_mountstats_nfs_operations_response_time_seconds_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{operation}}","refId":"O","step":240}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"NFS Response time","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Response time","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","fill":4,"gridPos":{"h":10,"w":24,"x":0,"y":64},"id":268,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(node_mountstats_nfs_operations_request_time_seconds_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{operation}}","refId":"O","step":240}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"NFS Requests time","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Request time","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","fill":4,"gridPos":{"h":10,"w":24,"x":0,"y":74},"id":270,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(node_mountstats_nfs_operations_transmissions_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{operation}}","refId":"O","step":240}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"NFS Transmissions","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Transmissions","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","fill":4,"gridPos":{"h":10,"w":24,"x":0,"y":84},"id":271,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(node_mountstats_nfs_operations_queue_time_seconds_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{operation}}","refId":"O","step":240}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"NFS Queue time","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Queue time","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"receive_packets_eth0":"#7EB26D","receive_packets_lo":"#E24D42","transmit_packets_eth0":"#7EB26D","transmit_packets_lo":"#E24D42"},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","fill":4,"gridPos":{"h":10,"w":24,"x":0,"y":94},"id":272,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(node_mountstats_nfs_operations_major_timeouts_total{instance=~\"$node:$port\",job=~\"$job\"}[5m])","format":"time_series","instant":false,"intervalFactor":2,"legendFormat":"{{operation}}","refId":"O","step":240}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"NFS Major timeouts","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Major timeouts","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"repeat":null,"title":"NFS Details","type":"row"}],"refresh":false,"schemaVersion":18,"style":"dark","tags":[],"templating":{"list":[{"allValue":null,"current":{"selected":true,"text":"node","value":"node"},"datasource":"Global","definition":"label_values(node_boot_time_seconds, job)","hide":0,"includeAll":false,"label":"Job","multi":false,"name":"job","options":[],"query":"label_values(node_boot_time_seconds, job)","refresh":1,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"web-pages-01-sv-gstg.c.gitlab-staging-1.internal","value":"web-pages-01-sv-gstg.c.gitlab-staging-1.internal"},"datasource":"Global","definition":"label_values(node_mountstats_nfs_read_bytes_total{job=~\"$job\"}, fqdn)","hide":0,"includeAll":false,"label":"Host:","multi":false,"name":"node","options":[],"query":"label_values(node_mountstats_nfs_read_bytes_total{job=~\"$job\"}, fqdn)","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"9100","value":"9100"},"datasource":"Global","definition":"label_values(node_boot_time_seconds{instance=~\"$node:(.*)\"}, instance)","hide":0,"includeAll":false,"label":"Port","multi":false,"name":"port","options":[],"query":"label_values(node_boot_time_seconds{instance=~\"$node:(.*)\"}, instance)","refresh":2,"regex":"/[^:]+:(.*)/","skipUrlSync":false,"sort":3,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"All","value":"$__all"},"datasource":"Global","definition":"label_values(node_mountstats_nfs_transport_sends_total{instance=~\"$node:(.*)\"}, export)","hide":0,"includeAll":true,"label":"mountpoint","multi":true,"name":"mountpoint","options":[],"query":"label_values(node_mountstats_nfs_transport_sends_total{instance=~\"$node:(.*)\"}, export)","refresh":2,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-6h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"NFS mountstats","uid":"keQ9P_-iz","version":5}}