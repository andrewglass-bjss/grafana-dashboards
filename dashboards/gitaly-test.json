{"meta":{"type":"db","canSave":true,"canEdit":true,"canAdmin":false,"canStar":true,"slug":"gitaly-test","url":"/d/tobvKIjMk/gitaly-test","expires":"0001-01-01T00:00:00Z","created":"2021-05-07T23:36:35Z","updated":"2021-05-10T08:52:15Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":6,"hasAcl":false,"isFolder":false,"folderId":980,"folderTitle":"Playground - FOR TESTING PURPOSES ONLY","folderUrl":"/dashboards/f/playground-FOR-TESTING-ONLY/playground-for-testing-purposes-only","provisioned":false,"provisionedExternalId":""},"dashboard":{"annotations":{"list":[{"$$hashKey":"object:909","builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":1,"id":null,"iteration":1620430596440,"links":[],"panels":[{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":24,"panels":[],"title":"Disk Performance","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This measures the mean count of write operations per wall-clock second from each mounted block device.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":1},"hiddenSeries":false,"id":36,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_writes_completed_total{env=\"$env\",fqdn=~\"($node)\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} write rate","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Write Throughput (operations/sec)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:3371","decimals":0,"format":"iops","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:3372","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This measures the mean bytes written per wall-clock second from each mounted block device.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":1},"hiddenSeries":false,"id":34,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_written_bytes_total{env=\"$env\",fqdn=~\"($node)\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} write rate","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Write Throughput (bytes/sec)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:3531","decimals":0,"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:3532","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":0,"y":8},"hiddenSeries":false,"id":18,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_vmstat_pgmajfault{env=\"$env\",fqdn=~\"($node)\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"15s","intervalFactor":2,"legendFormat":"Major Faults","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[{"$$hashKey":"object:478","colorMode":"critical","fill":true,"line":true,"op":"gt","value":1000,"yaxis":"left"}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Major Page Faults","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:450","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:451","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This measures the mean duration for each write operation (including time spent in the I/O queue, not just time from Dispatch to Compete).\n\nWrite latency is often slower (due to larger mean operation size) and often runs in the background, so high write latency may not be as serious as read latency.\n\nHowever, writes can stall reads if the reads are not getting promptly scheduled and spending time in the I/O queue.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":8},"hiddenSeries":false,"id":32,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_write_time_seconds_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval]) / rate(node_disk_writes_completed_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} write latency","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Write Latency - Mean Duration per Write Op","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:2873","format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:2874","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This measures the mean duration for each read operation (including time spent in the I/O queue, not just time from Dispatch to Compete).\n\nGood latency should be a few milliseconds; if the graph's scale is in seconds, you have a problem!\n\nHigh read latency and deep I/O queues often occur together.  They can be caused by either increased service time from the block device (slower physical I/O) or increased demand (request arrival rate).  Note that writes can sometimes stall reads.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":15},"hiddenSeries":false,"id":13,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_read_time_seconds_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval]) / rate(node_disk_reads_completed_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval]) \u003e 0","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} read latency","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Read Latency - Mean Duration per Read Op","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:2793","format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:2794","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This metric sums the durations of all write IO operations that completed during the sampling interval.  This result is converted to a rate, so the graph shows total IO seconds per wallclock second.\n\nWhen multiple IO requests are concurrently in flight, the sum of IO durations can exceed the wallclock duration -- causing a spike that shows more than 1 second of IO time per second of real time.\n\nFor reference, the underlying raw metric sums the durations of all read or write IO operations that completed since boot.  Kernel exposes these metrics via /proc/diskstats, fields 4 (reads) and 8 (writes).  See kernel source: Documentation/iostats.txt","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":15},"hiddenSeries":false,"id":52,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_write_time_seconds_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} summed write durations","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Write Latency - Total Duration (sum of IO seconds per wallclock second)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:197","decimals":0,"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:198","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This metric sums the durations of all write IO operations that completed during the sampling interval.  This result is converted to a rate, so the graph shows total IO seconds per wallclock second.\n\nWhen multiple IO requests are concurrently in flight, the sum of IO durations can exceed the wallclock duration -- causing a spike that shows more than 1 second of IO time per second of real time.\n\nFor reference, the underlying raw metric sums the durations of all read or write IO operations that completed since boot.  Kernel exposes these metrics via /proc/diskstats, fields 4 (reads) and 8 (writes).  See kernel source: Documentation/iostats.txt","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":22},"hiddenSeries":false,"id":51,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_read_time_seconds_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} summed read durations","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Read Latency - Total Duration (sum of IO seconds per wallclock second)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:197","decimals":0,"format":"s","label":null,"logBase":1,"max":null,"min":"0","show":true},{"$$hashKey":"object:198","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This measures the mean size of write operations for each mounted block device.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":22},"hiddenSeries":false,"id":38,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_written_bytes_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval]) / rate(node_disk_writes_completed_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} write op size","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Write Operation Size - Mean (bytes/operation)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:247","decimals":0,"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:248","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This measures the mean count of read operations per wall-clock second from each mounted block device.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":29},"hiddenSeries":false,"id":35,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_reads_completed_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} read rate","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Read Throughput (operations/sec)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:3291","decimals":0,"format":"iops","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:3292","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This measures the mean bytes read per wall-clock second from each mounted block device.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":36},"hiddenSeries":false,"id":33,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_read_bytes_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} read rate","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Read Throughput (bytes/sec)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:3451","decimals":0,"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:3452","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This measures the mean size of read operations for each mounted block device.","editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":43},"hiddenSeries":false,"id":37,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_read_bytes_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval]) / rate(node_disk_reads_completed_total{env=\"$env\",fqdn=\"$node\", device!~\"dm.*\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"{{device}} read op size","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Read Operation Size - Mean (bytes/operation)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:167","decimals":0,"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:168","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":50},"id":22,"panels":[],"title":"Disk Usage","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":51},"hiddenSeries":false,"id":14,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"avg_over_time(instance:node_filesystem_avail:ratio{env=\"$env\",fqdn=\"$node\", fstype=~\"ext.|xfs\"}[$__interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"60s","intervalFactor":1,"legendFormat":"{{mountpoint}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Available Filesystem Space by Mountpoint","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:536","format":"percentunit","label":null,"logBase":1,"max":"1","min":0,"show":true},{"$$hashKey":"object:537","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":51},"hiddenSeries":false,"id":16,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"$$hashKey":"object:616","alias":"Max","dashes":true}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"avg_over_time(node_filefd_allocated{env=\"$env\",fqdn=\"$node\"}[$__interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"30s","intervalFactor":1,"legendFormat":"Allocated","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":10,"tags":[]},{"expr":"avg_over_time(node_filefd_maximum{env=\"$env\",fqdn=\"$node\"}[$__interval])","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"Max","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Allocated file descriptors","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:623","format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"$$hashKey":"object:624","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":58},"id":30,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":12},"hiddenSeries":false,"id":12,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(node_network_transmit_bytes_total{env=\"$env\",device!=\"lo\", fqdn=\"$node\"}[$__rate_interval])","format":"time_series","hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"Outgoing on interface {{device}}","refId":"D"},{"expr":"rate(node_network_receive_bytes_total{env=\"$env\",device!=\"lo\", fqdn=\"$node\"}[$__rate_interval])","format":"time_series","hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"Incoming on interface {{device}}","refId":"C"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Network Throughput (bytes/s)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:703","format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:704","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"editable":true,"error":false,"fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":0,"fillGradient":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":12},"hiddenSeries":false,"id":50,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(node_network_receive_packets_total{env=\"$env\",device!=\"lo\", fqdn=\"$node\"}[$__rate_interval])","format":"time_series","hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"Outgoing on interface {{device}}","refId":"D"},{"expr":"rate(node_network_receive_packets_total{env=\"$env\",device!=\"lo\", fqdn=\"$node\"}[$__rate_interval])","format":"time_series","hide":false,"interval":"15s","intervalFactor":1,"legendFormat":"Incoming on interface {{device}}","refId":"C"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Network Throughput (packets/s)","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:243","format":"pps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"$$hashKey":"object:244","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"Shows point-in-time count of open TCP connections.\n\nNote that there could be microbursts occuring on a smaller time scale than our metrics-polling interval.  To check for this, look for spikes in the nearby counter-based graphs of new incoming and outgoing connections.","fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":16,"y":12},"hiddenSeries":false,"id":17,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"avg_over_time(node_netstat_Tcp_CurrEstab{env=\"$env\",fqdn=~\"$node\"}[$__interval])","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"30s","intervalFactor":1,"legendFormat":"current connections","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Count of established TCP connections","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:862","format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"$$hashKey":"object:863","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"Show this host's new TCP connection rate, split into:\n* Outgoing connections when acting as a client\n* Incoming connections when acting as a server\n\nThese kernel counters are incremented for each newly established outgoing (\"active\") or incoming (\"passive\") TCP connection.  This graph converts the counter to a rate to show the trend.\n\nFor reference, an \"active\" (outgoing) connection is where we are the client sending the initial SYN.  A \"passive\" (incoming) connection is where we are the server-side listener receiving the initial SYN.","fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":0,"y":19},"hiddenSeries":false,"id":45,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_netstat_Tcp_ActiveOpens{fqdn=~\"$node\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"15s","intervalFactor":1,"legendFormat":"Outgoing TCP connections / second","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]},{"dsType":"influxdb","expr":"rate(node_netstat_Tcp_PassiveOpens{fqdn=~\"$node\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"15s","intervalFactor":1,"legendFormat":"Incoming TCP connections / second","orderByTime":"ASC","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Rate of new outgoing and incoming TCP connections (conns/s)","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:943","format":"short","label":"","logBase":1,"max":null,"min":"0","show":true},{"$$hashKey":"object:944","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This kernel counter indicates the number of retransmits for outgoing TCP packets with the SYN flag set (i.e. both SYN and SYN-ACK count).\n\nThe same counter is used for retransmits from this host whether it is acting as the client or the server for the affected TCP connection, but it only counts the transmit direction (not the receive direction).  In other words, it counts the following cases of retransmits during connection handshakes:\n* as a client (active connection request): resending the initial SYN connection request after reaching retransmit timeout\n* as a server (passive connection response): resending a SYN-ACK reply to a peer's connection request after reachng retransmit timeout\n\nThis is not a hard failure (the retry may succeed).  But it always indicates slowness (e.g. the 1st retry occurs after 1 second delay, and each subsequent retry uses exponential backoff).\n\nSpikes could hint at any of:\n* Packet loss along the network path (in either direction)\n* Connection rate-limiting (e.g. firewall, DDoS protection, native rate limiting)\n* Saturation on the listener side, having too many pending connection requests already waiting on is backlog, leading to SYN retries from clents","fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":8,"y":19},"hiddenSeries":false,"id":44,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_netstat_TcpExt_TCPSynRetrans{env=\"$env\",fqdn=~\"$node\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"15s","intervalFactor":1,"legendFormat":"TCP retransmits / second for SYN + SYN-ACK","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"As a client or server: TCP SYN or SYN-ACK retry rate (packets/s)","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:1024","format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"$$hashKey":"object:1025","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"description":"This kernel counter indicates the number of times an incoming TCP SYN packet had to be dropped by the kernel due to the TCP listener's request backlog already being full.\n\nThis is a silent drop.  The TCP client connecting to this host will get no reply, the same as with packet loss in transit.  The client may retransmit its SYN until it reaches its own connection timeout.","fieldConfig":{"defaults":{"custom":{},"links":[]},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":8,"x":16,"y":19},"hiddenSeries":false,"id":19,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"7.2.0","pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_netstat_TcpExt_ListenOverflows{env=\"$env\",fqdn=~\"$node\"}[$__rate_interval])","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"15s","intervalFactor":1,"legendFormat":"TCP SYN drops / second","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"As a server: Drop rate for new incoming TCP connection requests (packets/s)","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"$$hashKey":"object:1184","format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"$$hashKey":"object:1185","format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"title":"Network","type":"row"}],"refresh":false,"schemaVersion":27,"style":"dark","tags":["unmanaged"],"templating":{"list":[{"allValue":null,"current":{"selected":false,"text":"gprd","value":"gprd"},"datasource":"Global","definition":"label_values(prometheus_build_info, env)","hide":0,"includeAll":false,"label":null,"multi":false,"name":"env","options":[],"query":"label_values(prometheus_build_info, env)","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":true,"text":"file-02-stor-gprd.c.gitlab-production.internal","value":"file-02-stor-gprd.c.gitlab-production.internal"},"datasource":"Global","definition":"label_values(up{env=\"$env\",job=~\"node(-exporter)?\"}, fqdn)","hide":0,"includeAll":true,"label":"Host","multi":true,"name":"node","options":[],"query":"label_values(up{env=\"$env\",job=~\"node(-exporter)?\"}, fqdn)","refresh":2,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"2021-05-07T20:02:57.655Z","to":"2021-05-07T23:34:32.392Z"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"utc","title":"gitaly-test","uid":"tobvKIjMk","version":6}}