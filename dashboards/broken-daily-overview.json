{"meta":{"type":"db","canSave":false,"canEdit":false,"canAdmin":false,"canStar":true,"slug":"broken-daily-overview","url":"/d/v0_18rIiz/broken-daily-overview","expires":"0001-01-01T00:00:00Z","created":"2018-06-12T12:42:23Z","updated":"2018-06-12T13:51:41Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":3,"hasAcl":false,"isFolder":false,"folderId":183,"folderTitle":".BROKEN","folderUrl":"/dashboards/f/cYFN9rSmz/broken","provisioned":false},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"links":[],"panels":[{"collapsed":false,"gridPos":{"h":7,"w":24,"x":0,"y":0},"id":18,"panels":[],"repeat":null,"title":"About","type":"row"},{"content":"# About\n\nThe data on this page is calculated every 12 hours and covers the 12 hours leading up to that point.","gridPos":{"h":3,"w":24,"x":0,"y":1},"height":"50","id":17,"links":[],"mode":"markdown","title":"","transparent":true,"type":"text"},{"collapsed":false,"gridPos":{"h":7,"w":24,"x":0,"y":8},"id":19,"panels":[],"repeat":null,"title":"General Timings","type":"row"},{"columns":[],"datasource":"$database","editable":true,"error":false,"fontSize":"100%","gridPos":{"h":7,"w":24,"x":0,"y":9},"height":"","id":11,"links":[],"pageSize":50,"scroll":true,"showHeader":true,"sort":{"col":2,"desc":true},"styles":[{"colorMode":"cell","colors":["rgba(50, 189, 80, 0.9)","rgba(237, 129, 40, 0.89)","rgba(200, 72, 72, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"/Mean|95th|99th/","thresholds":["1000","2000","100000"],"type":"number","unit":"ms"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD","decimals":2,"pattern":"Time","thresholds":[],"type":"date","unit":"short"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"pattern":"Amount","thresholds":[],"type":"number","unit":"short"}],"targets":[{"alias":"$col","dsType":"influxdb","groupBy":[],"hide":false,"measurement":"transactions","orderByTime":"ASC","policy":"default","query":"SELECT \"action\", \"count\" AS \"Amount\", \"duration_mean\" AS \"Mean\", \"duration_95th\" AS \"95th Percentile\", \"duration_99th\" AS \"99th Percentile\" FROM downsampled.\"[[process_type]]_transaction_timings_per_action_per_day\" WHERE $timeFilter AND \"action\" =~ /[[action]]/ ORDER BY time DESC","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["duration"],"type":"field"}],[{"params":["method"],"type":"field"}],[{"params":["path"],"type":"field"}]],"tags":[]}],"title":"Transaction Timings per Action","transform":"table","transparent":false,"type":"table"},{"collapsed":true,"gridPos":{"h":6,"w":24,"x":0,"y":16},"id":20,"panels":[{"columns":[],"datasource":"$database","editable":true,"error":false,"fontSize":"100%","gridPos":{"h":6,"w":24,"x":0,"y":17},"height":"","id":12,"links":[],"pageSize":50,"scroll":false,"showHeader":true,"sort":{"col":3,"desc":true},"styles":[{"alias":"","colorMode":"cell","colors":["rgba(50, 189, 80, 0.9)","rgba(237, 129, 40, 0.89)","rgba(200, 72, 72, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"/Mean|95th Perc|99th Perc/","thresholds":["200","500"],"type":"number","unit":"ms"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD","decimals":2,"pattern":"Time","thresholds":[],"type":"date","unit":"short"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"pattern":"Amount","thresholds":[],"type":"number","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(50, 189, 80, 0.9)","rgba(237, 129, 40, 0.89)","rgba(200, 72, 72, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":1,"pattern":"Percentage of Request Time","thresholds":["30","50"],"type":"number","unit":"percent"}],"targets":[{"alias":"$col","dsType":"influxdb","groupBy":[],"hide":false,"measurement":"transactions","orderByTime":"ASC","policy":"default","query":"SELECT \"action\", \"count\" as \"Amount\", (sql_duration_99th / duration_99th) * 100.0 AS \"Percentage of Request Time\", \"sql_duration_mean\" AS \"Mean\", \"sql_duration_95th\" AS \"95th Percentile\", \"sql_duration_99th\" AS \"99th Percentile\" FROM downsampled.\"[[process_type]]_transaction_timings_per_action_per_day\" WHERE $timeFilter AND action =~ /[[action]]/ ORDER BY time DESC","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["duration"],"type":"field"}],[{"params":["method"],"type":"field"}],[{"params":["path"],"type":"field"}]],"tags":[]}],"title":"SQL Timings per Action","transform":"table","transparent":false,"type":"table"},{"columns":[],"datasource":"$database","description":"SQL queries of actions that were requested 500 or more times, and with a 99th percentile of \u003e= 200 ms","editable":true,"error":false,"fontSize":"100%","gridPos":{"h":6,"w":24,"x":0,"y":23},"height":"","id":15,"links":[],"pageSize":50,"scroll":false,"showHeader":true,"sort":{"col":2,"desc":true},"styles":[{"alias":"","colorMode":"cell","colors":["rgba(50, 189, 80, 0.9)","rgba(237, 129, 40, 0.89)","rgba(200, 72, 72, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"/Mean|95th Perc|99th Perc/","thresholds":["200","500"],"type":"number","unit":"ms"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD","decimals":2,"pattern":"Time","thresholds":[],"type":"date","unit":"short"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"pattern":"Amount","thresholds":[],"type":"number","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(50, 189, 80, 0.9)","rgba(237, 129, 40, 0.89)","rgba(200, 72, 72, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":1,"pattern":"Percentage of Request Time","thresholds":["30","50"],"type":"number","unit":"percent"}],"targets":[{"alias":"$col","dsType":"influxdb","groupBy":[],"hide":false,"measurement":"transactions","orderByTime":"ASC","policy":"default","query":"SELECT \"action\", \"count\" as \"Amount\", (sql_duration_99th / duration_99th) * 100.0 AS \"Percentage of Request Time\", \"sql_duration_mean\" AS \"Mean\", \"sql_duration_95th\" AS \"95th Percentile\", \"sql_duration_99th\" AS \"99th Percentile\" FROM downsampled.\"[[process_type]]_transaction_timings_per_action_per_day\" WHERE $timeFilter AND action =~ /[[action]]/ AND \"count\" \u003e= 500 AND sql_duration_99th \u003e 200 AND action !~ /RequestForgery|RootController/ ORDER BY time DESC","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["duration"],"type":"field"}],[{"params":["method"],"type":"field"}],[{"params":["path"],"type":"field"}]],"tags":[]}],"title":"Frequently Running Slow Queries","transform":"table","transparent":false,"type":"table"}],"repeat":null,"title":"SQL Timings","type":"row"},{"collapsed":true,"gridPos":{"h":7,"w":24,"x":0,"y":23},"id":21,"panels":[{"columns":[],"datasource":"$database","description":"","editable":true,"error":false,"fontSize":"100%","gridPos":{"h":7,"w":24,"x":0,"y":24},"height":"","id":14,"links":[],"pageSize":50,"scroll":false,"showHeader":true,"sort":{"col":3,"desc":true},"styles":[{"colorMode":"cell","colors":["rgba(50, 189, 80, 0.9)","rgba(237, 129, 40, 0.89)","rgba(200, 72, 72, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"/Mean|95th|99th/","thresholds":["100","300","99999999"],"type":"number","unit":"ms"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD","decimals":2,"pattern":"Time","thresholds":[],"type":"date","unit":"short"}],"targets":[{"alias":"$col","dsType":"influxdb","groupBy":[],"hide":false,"measurement":"transactions","orderByTime":"ASC","policy":"default","query":"SELECT \"action\", \"count\" as \"Amount\", \"duration_mean\" AS \"Mean\", \"duration_95th\" AS \"95th Percentile\", \"duration_99th\" AS \"99th Percentile\" FROM downsampled.\"[[process_type]]_git_timings_per_action_per_day\" WHERE $timeFilter AND action =~ /[[action]]/ ORDER BY time DESC","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["duration"],"type":"field"}],[{"params":["method"],"type":"field"}],[{"params":["path"],"type":"field"}]],"tags":[]}],"title":"Git Real Timings per Action","transform":"table","transparent":false,"type":"table"}],"repeat":null,"title":"Git Timings","type":"row"},{"collapsed":true,"gridPos":{"h":7,"w":24,"x":0,"y":24},"id":22,"panels":[{"columns":[],"datasource":"$database","editable":true,"error":false,"fontSize":"100%","gridPos":{"h":7,"w":24,"x":0,"y":25},"height":"","id":13,"links":[],"pageSize":50,"scroll":false,"showHeader":true,"sort":{"col":5,"desc":true},"styles":[{"colorMode":"cell","colors":["rgba(50, 189, 80, 0.9)","rgba(237, 129, 40, 0.89)","rgba(200, 72, 72, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"/Mean|95th|99th/","thresholds":["100","300","1000"],"type":"number","unit":"ms"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD","decimals":2,"pattern":"Time","thresholds":[],"type":"date","unit":"short"}],"targets":[{"alias":"$col","dsType":"influxdb","groupBy":[],"hide":false,"measurement":"transactions","orderByTime":"ASC","policy":"default","query":"SELECT \"action\", \"count\" as \"Amount\", \"cache_duration_mean\" AS \"Mean\", \"cache_duration_95th\" AS \"95th Percentile\", \"cache_duration_99th\" AS \"99th Percentile\" FROM downsampled.\"[[process_type]]_transaction_timings_per_action_per_day\" WHERE $timeFilter AND action =~ /[[action]]/ ORDER BY time DESC","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["duration"],"type":"field"}],[{"params":["method"],"type":"field"}],[{"params":["path"],"type":"field"}]],"tags":[]}],"title":"Cache Timings per Action","transform":"table","transparent":false,"type":"table"}],"repeat":null,"title":"Cache Timings","type":"row"},{"collapsed":true,"gridPos":{"h":7,"w":24,"x":0,"y":25},"id":23,"panels":[{"columns":[],"datasource":"$database","editable":true,"error":false,"fontSize":"100%","gridPos":{"h":7,"w":24,"x":0,"y":26},"height":"","id":16,"links":[],"pageSize":50,"scroll":false,"showHeader":true,"sort":{"col":1,"desc":true},"styles":[{"alias":"","colorMode":"cell","colors":["rgba(50, 189, 80, 0.9)","rgba(237, 129, 40, 0.89)","rgba(200, 72, 72, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"/Mean|95th Perc|99th Perc/","thresholds":["200","500"],"type":"number","unit":"ms"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD","decimals":2,"pattern":"Time","thresholds":[],"type":"date","unit":"short"},{"colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":0,"pattern":"Amount","thresholds":[],"type":"number","unit":"short"}],"targets":[{"alias":"$col","dsType":"influxdb","groupBy":[],"hide":false,"measurement":"transactions","orderByTime":"ASC","policy":"default","query":"SELECT \"action\" AS \"Action\", \"view\" as \"View\", \"duration_mean\" AS \"Mean\", \"duration_95th\" AS \"95th Percentile\", \"duration_99th\" AS \"99th Percentile\" FROM downsampled.\"[[process_type]]_view_timings_per_action_and_view_per_day\" WHERE $timeFilter AND action =~ /[[action]]/ ORDER BY time DESC","rawQuery":true,"refId":"A","resultFormat":"table","select":[[{"params":["duration"],"type":"field"}],[{"params":["method"],"type":"field"}],[{"params":["path"],"type":"field"}]],"tags":[]}],"title":"View Timings per Action","transform":"table","transparent":false,"type":"table"}],"repeat":null,"title":"View Timings","type":"row"}],"refresh":false,"schemaVersion":16,"style":"dark","tags":["controller"],"templating":{"list":[{"allValue":null,"current":{"tags":[],"text":"rails","value":"rails"},"datasource":null,"hide":0,"includeAll":false,"label":"Process Type","multi":false,"name":"process_type","options":[{"selected":true,"text":"rails","value":"rails"},{"selected":false,"text":"sidekiq","value":"sidekiq"},{"selected":false,"text":"grape","value":"grape"}],"query":"rails,sidekiq,grape","refresh":0,"type":"custom"},{"allValue":".+","current":{"text":"All","value":"$__all"},"datasource":"prometheus-01-inf-gprd","hide":0,"includeAll":true,"label":"Action","multi":false,"name":"action","options":[],"query":"SHOW TAG VALUES FROM gitlab.downsampled.[[process_type]]_transaction_counts_per_action WITH KEY = \"action\"","refresh":1,"regex":"/#/","sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"current":{"text":"Production","value":"Production"},"datasource":null,"hide":0,"includeAll":false,"label":"Database","multi":false,"name":"database","options":[],"query":"influxdb","refresh":1,"regex":"","type":"datasource"}]},"time":{"from":"now-24h","to":"now"},"timepicker":{"now":true,"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"utc","title":"Broken: Daily Overview","uid":"v0_18rIiz","version":3}}