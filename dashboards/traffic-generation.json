{"meta":{"type":"db","canSave":false,"canEdit":false,"canAdmin":false,"canStar":true,"slug":"traffic-generation","url":"/d/DK3VKVfiz/traffic-generation","expires":"0001-01-01T00:00:00Z","created":"2018-11-12T09:10:01Z","updated":"2018-12-27T19:05:25Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":54,"hasAcl":false,"isFolder":false,"folderId":0,"folderTitle":"General","folderUrl":"","provisioned":false,"provisionedExternalId":""},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"iteration":1545936754697,"links":[{"icon":"external link","tags":[],"targetBlank":true,"title":"What is this?","type":"link","url":"https://gitlab.com/gitlab-org/release/docs/blob/master/general/deploy/traffic-generation.md"},{"icon":"external link","tags":[],"targetBlank":true,"title":"500 errors in kibana","type":"link","url":"https://log.gitlab.net/goto/a85d98695d1b7b2f5223a9ff502df2d1"},{"icon":"external link","tags":[],"targetBlank":true,"title":"Sentry Errors","type":"link","url":"https://sentry.gitlab.net/gitlab/staginggitlabcom/?query=is%3Aunresolved+user%3Aip%3A35.243.145.236"},{"icon":"external link","tags":[],"targetBlank":true,"title":"Traffic Generation Repository","type":"link","url":"https://ops.gitlab.net/gitlab-com/gl-infra/traffic-generator"},{"icon":"external link","tags":[],"targetBlank":true,"title":"Pipelines","type":"link","url":"https://ops.gitlab.net/gitlab-com/gl-infra/traffic-generator/pipelines"},{"icon":"external link","tags":[],"targetBlank":true,"title":"Schedules","type":"link","url":"https://ops.gitlab.net/gitlab-com/gl-infra/traffic-generator/pipeline_schedules"},{"icon":"external link","tags":[],"targetBlank":true,"title":"gstg gitlab-qa logs","type":"link","url":"https://log.gitlab.net/goto/8baf1ed11173933fa06f48ad17c2644e"},{"icon":"external link","tags":[],"targetBlank":true,"title":"gprd gitlab-qa logs","type":"link","url":"https://log.gitlab.net/goto/55dd5138bf31d8771728975ff615eb75"},{"icon":"external link","tags":[],"targetBlank":true,"title":"gprd https logs","type":"link","url":"https://log.gitlab.net/goto/ac2d6ecc7912f37b492b4a0a9cd25178"},{"icon":"external link","tags":[],"targetBlank":true,"title":"gstg https logs","type":"link","url":"https://log.gitlab.net/goto/f294338e5e36228e4930de6b3a679eb8"}],"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":103,"panels":[],"title":"GitLab QA Overview","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"$prometheus","format":"dateTimeFromNow","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":6,"w":6,"x":0,"y":1},"id":127,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"100%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"#c15c17","show":true},"tableColumn":"","targets":[{"expr":"push_time_seconds{job=\"$environment:$stage:auto:gitlab-qa\"} * 1000","format":"time_series","instant":true,"intervalFactor":2,"legendFormat":"","refId":"A"}],"thresholds":"","timeFrom":null,"title":"GitLab QA Last Run","type":"singlestat","valueFontSize":"100%","valueMaps":[],"valueName":"current"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":6,"w":18,"x":6,"y":1},"id":123,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":0.5,"points":true,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"traffic_gen_gitlab_qa_results{job=\"$environment:$stage:auto:gitlab-qa\", status=\"passed\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{ description }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Successful Test Run Durations","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],"datasource":"$prometheus","format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":6,"w":6,"x":0,"y":7},"id":125,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":" Failures","postfixFontSize":"100%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"#c15c17","show":true},"tableColumn":"","targets":[{"expr":"sum(max_over_time(traffic_gen_gitlab_qa_failures{job=\"$environment:$stage:auto:gitlab-qa\"}[$__interval])) OR vector(0)","format":"time_series","intervalFactor":2,"legendFormat":"","refId":"A"}],"thresholds":"1,10","timeFrom":null,"title":"GitLab QA Status","type":"singlestat","valueFontSize":"100%","valueMaps":[],"valueName":"current"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":6,"w":18,"x":6,"y":7},"id":144,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":true,"show":false,"total":false,"values":false},"lines":true,"linewidth":0,"links":[],"nullPointMode":"null","percentage":false,"pointradius":0.5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*fail.*/","color":"#890f02"},{"alias":"/.*fail.*/","fill":7}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"count(traffic_gen_gitlab_qa_results{job=\"$environment:$stage:auto:gitlab-qa\", status=\"passed\"}) by (description)","format":"time_series","intervalFactor":1,"legendFormat":"pass {{ description }}","refId":"A"},{"expr":"count(traffic_gen_gitlab_qa_results{job=\"$environment:$stage:auto:gitlab-qa\", status=\"failed\"}) by (description)","format":"time_series","intervalFactor":1,"legendFormat":"fail {{ description }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Test Results","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"none","label":null,"logBase":1,"max":null,"min":null,"show":false},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":13},"id":44,"panels":[],"title":"HTTPS Overview","type":"row"},{"columns":[],"datasource":"$prometheus","fontSize":"100%","gridPos":{"h":8,"w":12,"x":0,"y":14},"id":62,"links":[],"pageSize":null,"scroll":true,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"__name__","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"fqdn","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"stage","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"environment","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"Time","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"MMMM D, YYYY LT","decimals":2,"mappingType":1,"pattern":"Value","thresholds":[],"type":"date","unit":"short"}],"targets":[{"dsType":"influxdb","expr":"push_time_seconds{job=~'$environment:$stage.*'} * 1000","format":"table","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"instant":true,"intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"Last Run Time","transform":"table","type":"table"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":8,"w":12,"x":12,"y":14},"id":64,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":1,"points":true,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"traffic_gen_result{result=\"errors_count\", job=~\"$environment:$stage:.*\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{ url }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Request Errors","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":22},"id":145,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":0.5,"points":true,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(traffic_gen_result{result=~\"num_status_[^2].*\", job=~\"$environment:$stage:.*\"}) by (result, url)","format":"time_series","intervalFactor":1,"legendFormat":"{{ result }} {{ url }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Status codes that are not 2xx","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":7,"w":24,"x":0,"y":30},"id":85,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":1,"points":true,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"traffic_gen_result{result=\"rps_mean\", job=~\"$environment:$stage:.*\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{ result }} {{ url }}","refId":"C"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Requests / Second","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"reqps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":12,"w":13,"x":0,"y":37},"id":66,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":0.5,"points":true,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"traffic_gen_result{result=\"latency_percentiles_50\", job=~\"$environment:$stage:.*\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{ url }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Request Latencies p50","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":12,"w":11,"x":13,"y":37},"id":67,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":0.5,"points":true,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"traffic_gen_result{result=\"latency_percentiles_95\", job=~\"$environment:$stage:.*\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{ url }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Request Latencies p95","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":false,"schemaVersion":16,"style":"dark","tags":[],"templating":{"list":[{"allValue":null,"current":{"selected":true,"tags":[],"text":"gprd","value":"gprd"},"hide":0,"includeAll":false,"label":null,"multi":false,"name":"environment","options":[{"selected":true,"text":"gstg","value":"gstg"},{"selected":false,"text":"gprd","value":"gprd"}],"query":"gstg,gprd","skipUrlSync":false,"type":"custom"},{"current":{"text":"prometheus-01-inf-gprd","value":"prometheus-01-inf-gprd"},"hide":2,"label":null,"name":"prometheus","options":[],"query":"prometheus","refresh":1,"regex":"/prometheus-01-inf-[[environment]]/","skipUrlSync":false,"type":"datasource"},{"allValue":null,"current":{"text":"main","value":"main"},"datasource":"$prometheus","hide":0,"includeAll":false,"label":null,"multi":false,"name":"stage","options":[{"selected":true,"text":"main","value":"main"},{"selected":false,"text":"cny","value":"cny"}],"query":"label_values(traffic_gen_gitlab_qa_results, stage)","refresh":0,"regex":"","skipUrlSync":false,"sort":2,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Traffic Generation","uid":"DK3VKVfiz","version":54}}