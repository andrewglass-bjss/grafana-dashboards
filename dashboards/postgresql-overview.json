{"meta":{"type":"db","canSave":false,"canEdit":false,"canAdmin":false,"canStar":true,"slug":"postgresql-overview","url":"/d/000000144/postgresql-overview","expires":"0001-01-01T00:00:00Z","created":"2018-11-27T12:15:53Z","updated":"2019-02-06T18:26:13Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":23,"hasAcl":false,"isFolder":false,"folderId":657,"folderTitle":"PostgreSQL","folderUrl":"/dashboards/f/RNfEDpLmz/postgresql","provisioned":false},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"},{"datasource":"influxdb-01-inf-gprd","enable":true,"hide":false,"iconColor":"#fce2de","limit":100,"name":"Deployments","query":"SELECT version FROM forever.deployments","showIn":0,"tags":[],"type":"tags"},{"datasource":"prometheus-01-inf-gprd","enable":true,"expr":"ALERTS{alertname=~\"PostgreSQL_[^E].*[^w]\",environment=\"$environment\",severity!~\"info\",alertstate=\"firing\"}","hide":false,"iconColor":"rgba(255, 96, 96, 1)","limit":100,"name":"Alerts","showIn":0,"step":"1h","tagKeys":"{{fqdn}}","tags":[],"textFormat":"{{fqdn}}","titleFormat":"{{alertname}}","type":"tags"}]},"editable":true,"gnetId":null,"graphTooltip":1,"id":null,"iteration":1549477474784,"links":[{"icon":"external link","includeVars":true,"keepTime":true,"tags":["postgresql"],"targetBlank":true,"type":"dashboards"}],"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":38,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Health \u0026 Alerts ($type)","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":0,"description":"The percentage of time no alerts were sent out.","format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":0,"y":1},"height":"100","id":27,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"count(up{environment=\"$environment\",tier=\"db\",type=\"$type\",job=\"node\"})","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":".5,.9","title":"Current","transparent":true,"type":"singlestat","valueFontSize":"100%","valueMaps":[{"op":"=","text":"ALERTING","value":"0"},{"op":"=","text":"HEALTHY","value":"1"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":1,"description":"The percentage of time no alerts were sent out.","format":"percent","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":8,"y":1},"height":"100","id":25,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"sum(avg_over_time(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}[1d])) / count(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}) * 100","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":"95,99","title":"Health Past 24h","transparent":true,"type":"singlestat","valueFontSize":"110%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":1,"description":"The percentage of time no alerts were sent out.","format":"percent","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":16,"y":1},"height":"100","id":24,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"sum(avg_over_time(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}[1w])) / count(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}) * 100","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":"95,99","title":"Health Past 7d","transparent":true,"type":"singlestat","valueFontSize":"110%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"columns":[],"datasource":"prometheus-01-inf-gprd","fontSize":"80%","gridPos":{"h":6,"w":24,"x":0,"y":4},"height":"225px","id":26,"links":[],"pageSize":4,"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"scroll":true,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"Time","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"__name__","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"environment","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"job","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"server","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"tier","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"type","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"instance","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"pager","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"Value","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"channel","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"alertstate","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"datid","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[""],"type":"number","unit":"short"}],"targets":[{"dsType":"influxdb","expr":"ALERTS{alertname=~\"PostgreSQL.*\",environment=\"$environment\",alertstate=\"firing\"}","format":"table","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"instant":false,"interval":"5m","intervalFactor":1,"orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"Alerts","transform":"table","transparent":true,"type":"table"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":10},"id":52,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":38,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Health \u0026 Alerts ($type)","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":0,"description":"The percentage of time no alerts were sent out.","format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":0,"y":11},"height":"100","id":53,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":27,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"count(up{environment=\"$environment\",tier=\"db\",type=\"$type\",job=\"node\"})","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":".5,.9","title":"Current","transparent":true,"type":"singlestat","valueFontSize":"100%","valueMaps":[{"op":"=","text":"ALERTING","value":"0"},{"op":"=","text":"HEALTHY","value":"1"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":1,"description":"The percentage of time no alerts were sent out.","format":"percent","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":8,"y":11},"height":"100","id":54,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":25,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"sum(avg_over_time(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}[1d])) / count(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}) * 100","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":"95,99","title":"Health Past 24h","transparent":true,"type":"singlestat","valueFontSize":"110%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":1,"description":"The percentage of time no alerts were sent out.","format":"percent","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":16,"y":11},"height":"100","id":55,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":24,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"sum(avg_over_time(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}[1w])) / count(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}) * 100","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":"95,99","title":"Health Past 7d","transparent":true,"type":"singlestat","valueFontSize":"110%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"columns":[],"datasource":"prometheus-01-inf-gprd","fontSize":"80%","gridPos":{"h":6,"w":24,"x":0,"y":14},"height":"225px","id":56,"links":[],"pageSize":4,"repeatIteration":1549477474784,"repeatPanelId":26,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"scroll":true,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"Time","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"__name__","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"environment","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"job","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"server","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"tier","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"type","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"instance","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"pager","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"Value","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"channel","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"alertstate","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"datid","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[""],"type":"number","unit":"short"}],"targets":[{"dsType":"influxdb","expr":"ALERTS{alertname=~\"PostgreSQL.*\",environment=\"$environment\",alertstate=\"firing\"}","format":"table","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"instant":false,"interval":"5m","intervalFactor":1,"orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"Alerts","transform":"table","transparent":true,"type":"table"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":20},"id":57,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":38,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Health \u0026 Alerts ($type)","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":0,"description":"The percentage of time no alerts were sent out.","format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":0,"y":21},"height":"100","id":58,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":27,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"count(up{environment=\"$environment\",tier=\"db\",type=\"$type\",job=\"node\"})","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":".5,.9","title":"Current","transparent":true,"type":"singlestat","valueFontSize":"100%","valueMaps":[{"op":"=","text":"ALERTING","value":"0"},{"op":"=","text":"HEALTHY","value":"1"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":1,"description":"The percentage of time no alerts were sent out.","format":"percent","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":8,"y":21},"height":"100","id":59,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":25,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"sum(avg_over_time(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}[1d])) / count(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}) * 100","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":"95,99","title":"Health Past 24h","transparent":true,"type":"singlestat","valueFontSize":"110%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["#d44a3a","rgba(237, 129, 40, 0.89)","#299c46"],"datasource":"$prometheus","decimals":1,"description":"The percentage of time no alerts were sent out.","format":"percent","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":8,"x":16,"y":21},"height":"100","id":60,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":24,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"environment","targets":[{"dsType":"influxdb","expr":"sum(avg_over_time(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}[1w])) / count(up{environment=\"$environment\", tier=\"db\", type=\"$type\", job=\"node\"}) * 100","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"instant":true,"interval":"","intervalFactor":2,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":"95,99","title":"Health Past 7d","transparent":true,"type":"singlestat","valueFontSize":"110%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"avg"},{"columns":[],"datasource":"prometheus-01-inf-gprd","fontSize":"80%","gridPos":{"h":6,"w":24,"x":0,"y":24},"height":"225px","id":61,"links":[],"pageSize":4,"repeatIteration":1549477474784,"repeatPanelId":26,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"scroll":true,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"Time","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"__name__","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"environment","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"job","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"server","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"tier","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"type","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"instance","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"pager","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"Value","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"channel","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"alertstate","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"pattern":"datid","thresholds":[],"type":"hidden","unit":"short"},{"alias":"","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[""],"type":"number","unit":"short"}],"targets":[{"dsType":"influxdb","expr":"ALERTS{alertname=~\"PostgreSQL.*\",environment=\"$environment\",alertstate=\"firing\"}","format":"table","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"instant":false,"interval":"5m","intervalFactor":1,"orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"title":"Alerts","transform":"table","transparent":true,"type":"table"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":30},"id":39,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Overview ($type)","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","format":"none","gauge":{"maxValue":300,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":6,"x":0,"y":31},"height":"","id":17,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"} and on(instance) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"255,275","title":"Primary Total Connections","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","format":"none","gauge":{"maxValue":200,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":6,"y":31},"height":"","id":18,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\", state=\"active\"} and pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"50,100,150","title":"Primary Active Connections","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"percentunit","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":10,"y":31},"height":"","id":19,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(sum(instance_cpu:node_cpu_not_idle:rate5m{environment=\"$environment\", tier=\"db\", type=\"$type\"} and  on (fqdn) pg_replication_is_replica==0) without (cpu) / instance:node_cpus:count)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"30,50,80","title":"Primary CPU Usage","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"none","gauge":{"maxValue":32,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":14,"y":31},"height":"","id":21,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(node_load1{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (fqdn) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"10,15","title":"Primary Load Average","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"decbytes","gauge":{"maxValue":1073741824,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":6,"x":18,"y":31},"height":"","id":20,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_replication_pg_xlog_location_diff{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (instance) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":120,"tags":[]}],"thresholds":"52428800,524288000,1073741824","title":"Replication Lag Size","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":35},"id":62,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":39,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Overview ($type)","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","format":"none","gauge":{"maxValue":300,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":6,"x":0,"y":36},"height":"","id":63,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":17,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"} and on(instance) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"255,275","title":"Primary Total Connections","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","format":"none","gauge":{"maxValue":200,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":6,"y":36},"height":"","id":64,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":18,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\", state=\"active\"} and pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"50,100,150","title":"Primary Active Connections","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"percentunit","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":10,"y":36},"height":"","id":65,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":19,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(sum(instance_cpu:node_cpu_not_idle:rate5m{environment=\"$environment\", tier=\"db\", type=\"$type\"} and  on (fqdn) pg_replication_is_replica==0) without (cpu) / instance:node_cpus:count)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"30,50,80","title":"Primary CPU Usage","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"none","gauge":{"maxValue":32,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":14,"y":36},"height":"","id":66,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":21,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(node_load1{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (fqdn) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"10,15","title":"Primary Load Average","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"decbytes","gauge":{"maxValue":1073741824,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":6,"x":18,"y":36},"height":"","id":67,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":20,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_replication_pg_xlog_location_diff{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (instance) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":120,"tags":[]}],"thresholds":"52428800,524288000,1073741824","title":"Replication Lag Size","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":40},"id":68,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":39,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Overview ($type)","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","format":"none","gauge":{"maxValue":300,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":6,"x":0,"y":41},"height":"","id":69,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":17,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"} and on(instance) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"255,275","title":"Primary Total Connections","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","format":"none","gauge":{"maxValue":200,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":6,"y":41},"height":"","id":70,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":18,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\", state=\"active\"} and pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"50,100,150","title":"Primary Active Connections","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"percentunit","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":10,"y":41},"height":"","id":71,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":19,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(sum(instance_cpu:node_cpu_not_idle:rate5m{environment=\"$environment\", tier=\"db\", type=\"$type\"} and  on (fqdn) pg_replication_is_replica==0) without (cpu) / instance:node_cpus:count)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"30,50,80","title":"Primary CPU Usage","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"none","gauge":{"maxValue":32,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":4,"x":14,"y":41},"height":"","id":72,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":21,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(node_load1{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (fqdn) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":240,"tags":[]}],"thresholds":"10,15","title":"Primary Load Average","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"$prometheus","decimals":null,"format":"decbytes","gauge":{"maxValue":1073741824,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":4,"w":6,"x":18,"y":41},"height":"","id":73,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeatIteration":1549477474784,"repeatPanelId":20,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"dsType":"influxdb","expr":"max(pg_stat_replication_pg_xlog_location_diff{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (instance) pg_replication_is_replica==0)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"","policy":"default","query":"SELECT mean(\"value\") FROM \"measurement\" WHERE $timeFilter GROUP BY time($__interval) fill(null)","rawQuery":true,"refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":120,"tags":[]}],"thresholds":"52428800,524288000,1073741824","title":"Replication Lag Size","type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":45},"id":40,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Processes \u0026 Transactions ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":46},"height":"","id":1,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} - {{state}}","metric":"pg_stat_activity_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Process Activity Count","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":"300","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":46},"height":"","id":29,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"pg_stat_activity_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":285}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Process Activity Total by Host","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"short","label":null,"logBase":1,"max":"300","min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":46},"id":5,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[{"alias":"/rolled/","dashLength":1,"dashes":true,"spaceLength":1,"yaxis":2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pg_stat_database_xact_commit{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[$__interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"30s","intervalFactor":1,"legendFormat":"{{fqdn}} committed","metric":"pg_stat_database_xact_","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"rate(pg_stat_database_xact_rollback{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[$__interval])","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{fqdn}} rolled back","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Transactions","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Committed","logBase":1,"max":null,"min":"0","show":true},{"decimals":null,"format":"ops","label":"Rolled Back","logBase":1,"max":null,"min":"0","show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":53},"id":74,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":40,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Processes \u0026 Transactions ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":54},"height":"","id":75,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":1,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} - {{state}}","metric":"pg_stat_activity_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Process Activity Count","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":"300","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":54},"height":"","id":76,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":29,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"pg_stat_activity_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":285}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Process Activity Total by Host","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"short","label":null,"logBase":1,"max":"300","min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":54},"id":77,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":5,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[{"alias":"/rolled/","dashLength":1,"dashes":true,"spaceLength":1,"yaxis":2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"irate(pg_stat_database_xact_commit{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} committed","metric":"pg_stat_database_xact_","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"irate(pg_stat_database_xact_rollback{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} rolled back","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Transactions","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Committed","logBase":1,"max":null,"min":"0","show":true},{"decimals":null,"format":"ops","label":"Rolled Back","logBase":1,"max":null,"min":"0","show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":61},"id":78,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":40,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Processes \u0026 Transactions ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":62},"height":"","id":79,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":1,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} - {{state}}","metric":"pg_stat_activity_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Process Activity Count","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":"300","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":62},"height":"","id":80,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":29,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(pg_stat_activity_count{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"pg_stat_activity_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":285}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Process Activity Total by Host","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"short","label":null,"logBase":1,"max":"300","min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":62},"id":81,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":5,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[{"alias":"/rolled/","dashLength":1,"dashes":true,"spaceLength":1,"yaxis":2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"irate(pg_stat_database_xact_commit{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} committed","metric":"pg_stat_database_xact_","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"irate(pg_stat_database_xact_rollback{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} rolled back","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Transactions","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Committed","logBase":1,"max":null,"min":"0","show":true},{"decimals":null,"format":"ops","label":"Rolled Back","logBase":1,"max":null,"min":"0","show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":69},"id":41,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Errors and Locks ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":70},"id":3,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(postgresql_errors_total{environment=\"$environment\", type=\"$type\"}[10m]) * 60) by (type)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{type}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Errors","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":70},"id":33,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pgbouncer_errors_count{environment=\"$environment\",type=\"$type\",errmsg!~\"invalid command.*\"}[10m]) * 60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}: {{errmsg}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PGBouncer Errors","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":77},"id":34,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(postgresql_lock_waits_total{environment=\"$environment\", type=\"$type\"}[1m]) * 60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"1m","intervalFactor":1,"legendFormat":"{{mode}} on {{locktype}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Slow Lock Acquires","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"opm","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":77},"id":35,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(pg_locks_count{environment=\"$environment\", type=\"$type\"}[1m]) * 60) by (mode)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"1m","intervalFactor":1,"legendFormat":"{{mode}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Locks across all hosts","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":84},"id":82,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":41,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Errors and Locks ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":85},"id":83,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":3,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(postgresql_errors_total{environment=\"$environment\", type=\"$type\"}[10m]) * 60) by (type)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{type}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Errors","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":85},"id":84,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":33,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pgbouncer_errors_count{environment=\"$environment\",type=\"$type\",errmsg!~\"invalid command.*\"}[10m]) * 60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}: {{errmsg}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PGBouncer Errors","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":92},"id":85,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":34,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(postgresql_lock_waits_total{environment=\"$environment\", type=\"$type\"}[1m]) * 60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"1m","intervalFactor":1,"legendFormat":"{{mode}} on {{locktype}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Slow Lock Acquires","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"opm","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":92},"id":86,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":35,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(pg_locks_count{environment=\"$environment\", type=\"$type\"}[1m]) * 60) by (mode)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"1m","intervalFactor":1,"legendFormat":"{{mode}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Locks across all hosts","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":99},"id":87,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":41,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Errors and Locks ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":100},"id":88,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":3,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(postgresql_errors_total{environment=\"$environment\", type=\"$type\"}[10m]) * 60) by (type)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{type}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Errors","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":100},"id":89,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":33,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pgbouncer_errors_count{environment=\"$environment\",type=\"$type\",errmsg!~\"invalid command.*\"}[10m]) * 60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}: {{errmsg}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PGBouncer Errors","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","editable":true,"error":false,"fill":2,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":107},"id":90,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":34,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(postgresql_lock_waits_total{environment=\"$environment\", type=\"$type\"}[1m]) * 60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"1m","intervalFactor":1,"legendFormat":"{{mode}} on {{locktype}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Slow Lock Acquires","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"opm","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":107},"id":91,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":35,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(pg_locks_count{environment=\"$environment\", type=\"$type\"}[1m]) * 60) by (mode)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"1m","intervalFactor":1,"legendFormat":"{{mode}}","metric":"pg_locks_count","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":5,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Locks across all hosts","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":114},"id":42,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Load ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":7,"w":12,"x":0,"y":115},"id":13,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(instance_cpu:node_cpu_not_idle:rate5m{ environment=\"$environment\", tier=\"db\", type=\"$type\"}) without (cpu) / instance:node_cpus:count","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"DB CPU Percent","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":115},"height":"","id":9,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"node_load1{ environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"node_load1","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Database Host Load","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":122},"id":92,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":42,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Load ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":7,"w":12,"x":0,"y":123},"id":93,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":13,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(instance_cpu:node_cpu_not_idle:rate5m{ environment=\"$environment\", tier=\"db\", type=\"$type\"}) without (cpu) / instance:node_cpus:count","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"DB CPU Percent","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":123},"height":"","id":94,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":9,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"node_load1{ environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"node_load1","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Database Host Load","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":130},"id":95,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":42,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Load ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":7,"w":12,"x":0,"y":131},"id":96,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":13,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(instance_cpu:node_cpu_not_idle:rate5m{ environment=\"$environment\", tier=\"db\", type=\"$type\"}) without (cpu) / instance:node_cpus:count","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"DB CPU Percent","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":131},"height":"","id":97,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":9,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"node_load1{ environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"node_load1","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Database Host Load","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":138},"id":43,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Storage \u0026 Memory ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","decimals":2,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":10,"w":8,"x":0,"y":139},"id":10,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"{__name__=~ \"node_filesystem_size.*\", environment=\"$environment\", tier=\"db\", type=\"$type\", mountpoint=\"/var/opt/gitlab\"} - {__name__=~\"node_filesystem_free.*\",environment=\"$environment\", tier=\"db\", type=\"$type\", mountpoint=\"/var/opt/gitlab\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Storage Used","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":10,"w":8,"x":8,"y":139},"id":12,"legend":{"alignAsTable":true,"avg":false,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"node_memory_MemTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_MemFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} total","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]},{"dsType":"influxdb","expr":"node_memory_SwapTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_SwapFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} swaped","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]},{"dsType":"influxdb","expr":"node_memory_MemTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_MemFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_Buffers_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_Cached_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} active","policy":"default","refId":"C","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory Overview","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","description":"Total storage used for tables with all associated indexes, space maps, toast storage","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":139},"id":23,"interval":"10s","legend":{"alignAsTable":true,"avg":false,"current":true,"max":true,"min":true,"show":true,"sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"topk(20, pg_total_relation_size_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (instance) pg_replication_is_replica==0 )\n","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["0"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{schemaname}}.{{relname}}","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["pg_total_relation_size_bytes"],"type":"field"},{"params":[],"type":"mean"}]],"step":20,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Table Size (Top 20 Tables)","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"Table Storage Size","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":149},"id":98,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":43,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Storage \u0026 Memory ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","decimals":2,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":10,"w":8,"x":0,"y":150},"id":99,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":10,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"{__name__=~ \"node_filesystem_size.*\", environment=\"$environment\", tier=\"db\", type=\"$type\", mountpoint=\"/var/opt/gitlab\"} - {__name__=~\"node_filesystem_free.*\",environment=\"$environment\", tier=\"db\", type=\"$type\", mountpoint=\"/var/opt/gitlab\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Storage Used","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":10,"w":8,"x":8,"y":150},"id":100,"legend":{"alignAsTable":true,"avg":false,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":12,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"node_memory_MemTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_MemFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} total","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]},{"dsType":"influxdb","expr":"node_memory_SwapTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_SwapFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} swaped","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]},{"dsType":"influxdb","expr":"node_memory_MemTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_MemFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_Buffers_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_Cached_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} active","policy":"default","refId":"C","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory Overview","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","description":"Total storage used for tables with all associated indexes, space maps, toast storage","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":150},"id":101,"interval":"10s","legend":{"alignAsTable":true,"avg":false,"current":true,"max":true,"min":true,"show":true,"sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":23,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"topk(20, pg_total_relation_size_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (instance) pg_replication_is_replica==0 )\n","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["0"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{schemaname}}.{{relname}}","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["pg_total_relation_size_bytes"],"type":"field"},{"params":[],"type":"mean"}]],"step":20,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Table Size (Top 20 Tables)","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"Table Storage Size","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":160},"id":102,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":43,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Storage \u0026 Memory ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","decimals":2,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":10,"w":8,"x":0,"y":161},"id":103,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":10,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"{__name__=~ \"node_filesystem_size.*\", environment=\"$environment\", tier=\"db\", type=\"$type\", mountpoint=\"/var/opt/gitlab\"} - {__name__=~\"node_filesystem_free.*\",environment=\"$environment\", tier=\"db\", type=\"$type\", mountpoint=\"/var/opt/gitlab\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Storage Used","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":10,"w":8,"x":8,"y":161},"id":104,"legend":{"alignAsTable":true,"avg":false,"current":true,"hideEmpty":true,"hideZero":true,"max":false,"min":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":12,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"node_memory_MemTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_MemFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} total","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]},{"dsType":"influxdb","expr":"node_memory_SwapTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_SwapFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} swaped","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]},{"dsType":"influxdb","expr":"node_memory_MemTotal_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_MemFree_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_Buffers_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} - node_memory_Cached_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"}","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} active","policy":"default","refId":"C","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory Overview","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","description":"Total storage used for tables with all associated indexes, space maps, toast storage","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":161},"id":105,"interval":"10s","legend":{"alignAsTable":true,"avg":false,"current":true,"max":true,"min":true,"show":true,"sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":23,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"topk(20, pg_total_relation_size_bytes{environment=\"$environment\", tier=\"db\", type=\"$type\"} and on (instance) pg_replication_is_replica==0 )\n","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["0"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{schemaname}}.{{relname}}","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["pg_total_relation_size_bytes"],"type":"field"},{"params":[],"type":"mean"}]],"step":20,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Table Size (Top 20 Tables)","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"Table Storage Size","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":171},"id":44,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Disk Access ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":172},"id":6,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sda","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":172},"id":48,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sdb","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":172},"id":49,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sdc","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":0,"y":179},"id":14,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sda","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":8,"y":179},"id":50,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sdb","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":16,"y":179},"id":51,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sdc","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":185},"id":4,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"irate(pg_stat_database_blks_hit{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} hits","metric":"pg_stat_database_blks_hit","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Block Hits","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":192},"id":106,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":44,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Disk Access ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":193},"id":107,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":6,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sda","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":193},"id":108,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":48,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sdb","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":193},"id":109,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":49,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sdc","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":0,"y":200},"id":110,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":14,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sda","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":8,"y":200},"id":111,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":50,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sdb","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":16,"y":200},"id":112,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":51,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sdc","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":206},"id":113,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":4,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"irate(pg_stat_database_blks_hit{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} hits","metric":"pg_stat_database_blks_hit","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Block Hits","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":213},"id":114,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":44,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Disk Access ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":214},"id":115,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":6,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sda","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":214},"id":116,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":48,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sdb","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":214},"id":117,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":49,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(node_disk_read_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} reads","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"dsType":"influxdb","expr":"sum(rate(node_disk_write_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[5m])) by (fqdn)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} writes","metric":"","policy":"default","refId":"B","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"disk IO wait sdc","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":0,"y":221},"id":118,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":14,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sda\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sda","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":8,"y":221},"id":119,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":50,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdb\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sdb","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":0,"gridPos":{"h":6,"w":8,"x":16,"y":221},"id":120,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":51,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(node_disk_io_time_seconds_total{environment=\"$environment\", tier=\"db\", type=\"$type\", device=~\"sdc\"}[2m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":30,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk IO Utilization sdc","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":"1","min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":227},"id":121,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":4,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"irate(pg_stat_database_blks_hit{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} hits","metric":"pg_stat_database_blks_hit","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk Block Hits","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":234},"id":45,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Checkpoints ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":235},"id":7,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pg_stat_bgwriter_checkpoint_write_time{environment=\"$environment\", tier=\"db\", type=\"$type\"}[$__interval])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"5m","intervalFactor":1,"legendFormat":"{{fqdn}} write","metric":"pg_stat_bgwriter_checkpoint","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"rate(pg_stat_bgwriter_checkpoint_sync_time{environment=\"$environment\", tier=\"db\", type=\"$type\"}[$__interval])","format":"time_series","interval":"5m","intervalFactor":1,"legendFormat":"{{fqdn}} sync","metric":"pg_stat_bgwriter_checkpoint_sync_time","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Checkpoint Times","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":235},"id":8,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pg_stat_bgwriter_checkpoints_req{environment=\"$environment\", tier=\"db\", type=\"postgres\"}[60m])*60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} requested","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"rate(pg_stat_bgwriter_checkpoints_timed{environment=\"$environment\", tier=\"db\", type=\"postgres\"}[60m])*60","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} scheduled","metric":"pg_stat_bgwriter_checkpoints_timed","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Performed Checkpoints","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":242},"id":122,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":45,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Checkpoints ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":243},"id":123,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":7,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pg_stat_bgwriter_checkpoint_write_time{environment=\"$environment\", tier=\"db\", type=\"$type\"}[60m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} write","metric":"pg_stat_bgwriter_checkpoint","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"rate(pg_stat_bgwriter_checkpoint_sync_time{environment=\"$environment\", tier=\"db\", type=\"$type\"}[60m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} sync","metric":"pg_stat_bgwriter_checkpoint_sync_time","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Checkpoint Times","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":243},"id":124,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":8,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pg_stat_bgwriter_checkpoints_req{environment=\"$environment\", tier=\"db\", type=\"postgres\"}[60m])*60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} requested","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"rate(pg_stat_bgwriter_checkpoints_timed{environment=\"$environment\", tier=\"db\", type=\"postgres\"}[60m])*60","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} scheduled","metric":"pg_stat_bgwriter_checkpoints_timed","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Performed Checkpoints","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":250},"id":125,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":45,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Checkpoints ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":0,"y":251},"id":126,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":7,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pg_stat_bgwriter_checkpoint_write_time{environment=\"$environment\", tier=\"db\", type=\"$type\"}[60m])","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} write","metric":"pg_stat_bgwriter_checkpoint","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"rate(pg_stat_bgwriter_checkpoint_sync_time{environment=\"$environment\", tier=\"db\", type=\"$type\"}[60m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} sync","metric":"pg_stat_bgwriter_checkpoint_sync_time","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Checkpoint Times","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus-01-inf-gprd","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":12,"x":12,"y":251},"id":127,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":8,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pg_stat_bgwriter_checkpoints_req{environment=\"$environment\", tier=\"db\", type=\"postgres\"}[60m])*60","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} requested","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]},{"expr":"rate(pg_stat_bgwriter_checkpoints_timed{environment=\"$environment\", tier=\"db\", type=\"postgres\"}[60m])*60","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{fqdn}} scheduled","metric":"pg_stat_bgwriter_checkpoints_timed","refId":"B","step":15}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Performed Checkpoints","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":258},"id":46,"panels":[],"repeat":"type","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"title":"Replication Lag Time ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":259},"id":11,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(pg_stat_replication_pg_xlog_location_diff{environment=\"$environment\", tier=\"db\", type=\"$type\"}) by (client_addr)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{slot_name}} - {{client_addr}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Replication Lag Size","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":259},"id":16,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"pg_replication_lag{environment=\"$environment\", tier=\"db\", type=\"$type\"} and pg_replication_is_replica==1","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[{"colorMode":"warning","fill":true,"line":true,"op":"gt","value":60},{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":120}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Replication Lag Time","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"none","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","description":"The number of query conflicts occurring on secondaries","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":259},"id":15,"legend":{"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","scopedVars":{"type":{"selected":false,"text":"patroni","value":"patroni"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(pg_stat_database_conflicts{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m]) * 60","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{fqdn}}","refId":"D","step":60}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Query Conflicts","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":266},"id":128,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":46,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"title":"Replication Lag Time ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":267},"id":129,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":11,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(pg_stat_replication_pg_xlog_location_diff{environment=\"$environment\", tier=\"db\", type=\"$type\"}) by (client_addr)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{slot_name}} - {{client_addr}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Replication Lag Size","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":267},"id":130,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":16,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"pg_replication_lag{environment=\"$environment\", tier=\"db\", type=\"$type\"} and pg_replication_is_replica==1","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[{"colorMode":"warning","fill":true,"line":true,"op":"gt","value":60},{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":120}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Replication Lag Time","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"none","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","description":"The number of query conflicts occurring on secondaries","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":267},"id":131,"legend":{"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":15,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-archive","value":"postgres-archive"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(pg_stat_database_conflicts{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m]) * 60","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{fqdn}}","refId":"D","step":60}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Query Conflicts","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":274},"id":132,"panels":[],"repeat":null,"repeatIteration":1549477474784,"repeatPanelId":46,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"title":"Replication Lag Time ($type)","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":0,"y":275},"id":133,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":11,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(pg_stat_replication_pg_xlog_location_diff{environment=\"$environment\", tier=\"db\", type=\"$type\"}) by (client_addr)","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{slot_name}} - {{client_addr}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Replication Lag Size","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":8,"y":275},"id":134,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":16,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"pg_replication_lag{environment=\"$environment\", tier=\"db\", type=\"$type\"} and pg_replication_is_replica==1","format":"time_series","groupBy":[{"params":["$interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":1,"legendFormat":"{{fqdn}}","metric":"","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"step":15,"tags":[]}],"thresholds":[{"colorMode":"warning","fill":true,"line":true,"op":"gt","value":60},{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":120}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Replication Lag Time","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"none","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","description":"The number of query conflicts occurring on secondaries","editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":8,"x":16,"y":275},"id":135,"legend":{"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":12,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeatIteration":1549477474784,"repeatPanelId":15,"repeatedByRow":true,"scopedVars":{"type":{"selected":false,"text":"postgres-delayed","value":"postgres-delayed"}},"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(pg_stat_database_conflicts{datname=\"gitlabhq_production\", environment=\"$environment\", tier=\"db\", type=\"$type\"}[1m]) * 60","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{fqdn}}","refId":"D","step":60}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Query Conflicts","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"opm","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":282},"id":47,"panels":[],"repeat":null,"title":"PGBouncer","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":7,"w":12,"x":0,"y":283},"id":30,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pgbouncer_query_wait_timeout_total{environment=\"$environment\"}[1m])","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Query Wait Timeouts","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$prometheus","fill":1,"gridPos":{"h":7,"w":12,"x":12,"y":283},"id":32,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"rate(pgbouncer_cant_connect_to_server_total{environment=\"$environment\"}[1m])","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"interval":"","intervalFactor":2,"legendFormat":"{{fqdn}}","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Server Connection Errors","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":false,"schemaVersion":16,"style":"dark","tags":["postgresql","patroni","triage"],"templating":{"list":[{"allValue":null,"current":{"tags":[],"text":"gprd","value":"gprd"},"hide":0,"includeAll":false,"label":"Environment","multi":false,"name":"environment","options":[{"selected":false,"text":"gprd","value":"gprd"},{"selected":true,"text":"gstg","value":"gstg"}],"query":"gprd,gstg","skipUrlSync":false,"type":"custom"},{"current":{"text":"prometheus-01-inf-gprd","value":"prometheus-01-inf-gprd"},"hide":2,"label":null,"name":"prometheus","options":[],"query":"prometheus","refresh":1,"regex":"/prometheus-01-inf-[[environment]]/","skipUrlSync":false,"type":"datasource"},{"allValue":null,"current":{"text":"postgres","value":["postgres"]},"datasource":"$prometheus","definition":"","hide":0,"includeAll":true,"label":null,"multi":true,"name":"type","options":[],"query":"label_values(up{tier=\"db\", type!=\"redis\"}, type)","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-3h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"utc","title":"PostgreSQL Overview","uid":"000000144","version":23}}