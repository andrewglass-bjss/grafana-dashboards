{"meta":{"type":"db","canSave":false,"canEdit":true,"canAdmin":false,"canStar":true,"slug":"monitoring-overview","url":"/d/monitoring-main/monitoring-overview","expires":"0001-01-01T00:00:00Z","created":"2019-11-21T19:49:34Z","updated":"2021-09-22T13:08:03Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":2010,"hasAcl":false,"isFolder":false,"folderId":1185,"folderTitle":"monitoring","folderUrl":"/dashboards/f/monitoring/monitoring","provisioned":false,"provisionedExternalId":""},"dashboard":{"__inputs":[],"__requires":[],"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":false,"hide":false,"iconColor":"#96D98D","name":"deploy","showIn":0,"tags":["deploy","$environment"],"type":"tags"},{"builtIn":1,"datasource":"-- Grafana --","enable":false,"hide":false,"iconColor":"#FFEE52","name":"canary-deploy","showIn":0,"tags":["deploy","${environment}-cny"],"type":"tags"},{"builtIn":1,"datasource":"-- Grafana --","enable":false,"hide":false,"iconColor":"#CA95E5","name":"feature-flags","showIn":0,"tags":["feature-flag","${environment}"],"type":"tags"}]},"description":"Uploaded by https://gitlab.com/gitlab-com/runbooks/-/jobs/1612789018 at Wed Sep 22 13:08:02 UTC 2021","editable":false,"gnetId":null,"graphTooltip":1,"hideControls":false,"id":null,"links":[{"asDropdown":true,"icon":"external link","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"Platform Triage","type":"link","url":"https://dashboards.gitlab.net/d/general-triage/platform-triage?orgId=1"},{"asDropdown":true,"icon":"external link","includeVars":true,"keepTime":true,"tags":["managed","service overview"],"targetBlank":false,"title":"Service Overview Dashboards","type":"dashboards","url":""},{"asDropdown":true,"icon":"dashboard","includeVars":true,"keepTime":true,"tags":"type:monitoring","targetBlank":false,"title":"monitoring Detail","type":"dashboards","url":""},{"asDropdown":true,"icon":"external link","includeVars":true,"keepTime":true,"tags":["managed","type:monitoring","kube detail"],"targetBlank":false,"title":"‚ò∏Ô∏è monitoring Kubernetes Detail","type":"dashboards","url":""}],"panels":[{"collapse":false,"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":2,"panels":[],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üå°Ô∏è Aggregated Service Level Indicators (ùôéùôáùôÑùô®)","titleSize":"h6","type":"row"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":1},"id":712482646,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"monitoring Service Apdex SLO Analysis","url":"/d/alerts-service_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"monitoring apdex","color":"#E7D551","zindex":3},{"alias":"monitoring apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"monitoring apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"service-monitoring-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_service_apdex:ratio_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"monitoring apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_service_apdex:ratio_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"monitoring apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_service_apdex:ratio_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"monitoring Service Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":8},"id":4,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_service_apdex:ratio_1h{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_service_apdex:ratio_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_service_apdex:ratio_1h{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_service_apdex:ratio_30m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_service_apdex:ratio_6h{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"monitoring Service | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":1},"id":4204928574,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"monitoring Service Error-Rate SLO Analysis","url":"/d/alerts-service_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"monitoring error ratio","color":"#E7D551","fillBelowTo":"monitoring error ratio avg","zindex":3},{"alias":"monitoring error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"service-monitoring-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_service_errors:ratio_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"monitoring error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_service_errors:ratio_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"monitoring error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_service_errors:ratio_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"monitoring Service Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":8},"id":6,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_service_errors:ratio_1h{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_service_errors:ratio_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_service_errors:ratio_1h{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_service_errors:ratio_30m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_service_errors:ratio_6h{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"monitoring Service | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":1},"id":4135574000,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"monitoring RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3},{"alias":"upper normal","color":"#73BF69","dashLength":8,"dashes":true,"fillBelowTo":"lower normal","legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3},{"alias":"lower normal","color":"#73BF69","dashLength":8,"dashes":true,"legend":false,"lines":false,"linewidth":1,"nullPointMode":"connected","spaceLength":8,"zindex":-3}],"spaceLength":10,"stableId":"service-monitoring-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_service_ops:rate_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"monitoring RPS","refId":"A"},{"expr":"gitlab_service_ops:rate_5m{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"},{"expr":"clamp_min(\n  avg by (type) (\n    gitlab_service_ops:rate:prediction{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}\n    + (1) *\n    gitlab_service_ops:rate:stddev_over_time_1w{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}\n  ),\n  0\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"upper normal","refId":"C"},{"expr":"clamp_min(\n  avg by (type) (\n    gitlab_service_ops:rate:prediction{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}\n    + (-1) *\n    gitlab_service_ops:rate:stddev_over_time_1w{env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}\n  ),\n  0\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"lower normal","refId":"D"}],"title":"monitoring Service RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":8,"w":6,"x":18,"y":1},"id":1217942947,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stableId":"service-utilization","stack":false,"steppedLine":false,"targets":[{"expr":"max(\n  max_over_time(\n    gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval]\n  )\n) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ component }} component","refId":"A"}],"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"collapse":false,"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":20},"id":9,"panels":[],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ Service Level Indicators","titleSize":"h6","type":"row"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":8,"x":0,"y":21},"id":3079737102,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"grafana SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=grafana\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"grafana error ratio","color":"#E7D551","fillBelowTo":"grafana error ratio avg","zindex":3},{"alias":"grafana error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-grafana-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"grafana error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"grafana error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"grafana SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":8,"x":0,"y":28},"id":11,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"grafana SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":21},"id":2138342068,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"grafana RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-grafana-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"grafana RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"grafana\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"grafana SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThis SLI monitors the internal Grafana instance, via the HTTP interface.\n5xx responses are considered errors.\n\n\n\n### Observability Tools\n\n* [Google Load Balancer](https://console.cloud.google.com/net-services/loadbalancing/details/http/ops-dashboards?project=gitlab-ops)\n* [Stackdriver Logs: Loadbalancer Access Logs](https://console.cloud.google.com/logs/query;query=resource%2Elabels%2Etarget%5Fproxy%5Fname%3D%22ops%2Ddashboards%22%0Aresource%2Etype%3D%22http%5Fload%5Fbalancer%22;timeRange=PT30M?project=gitlab-ops)\n* [Stackdriver Logs: Loadbalancer Access 5xx Logs](https://console.cloud.google.com/logs/query;query=httpRequest%2Estatus%3E%3D500%0Aresource%2Elabels%2Etarget%5Fproxy%5Fname%3D%22ops%2Ddashboards%22%0Aresource%2Etype%3D%22http%5Fload%5Fbalancer%22;timeRange=PT30M?project=gitlab-ops)\n\n","gridPos":{"h":8,"w":8,"x":16,"y":21},"id":13,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":31},"id":3835305006,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"memcached_thanos_qfe_labels SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=memcached_thanos_qfe_labels\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"memcached_thanos_qfe_labels apdex","color":"#E7D551","zindex":3},{"alias":"memcached_thanos_qfe_labels apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"memcached_thanos_qfe_labels apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_qfe_labels-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_labels apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_labels apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"memcached_thanos_qfe_labels SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":38},"id":15,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_labels SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":31},"id":1168951987,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"memcached_thanos_qfe_labels SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=memcached_thanos_qfe_labels\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"memcached_thanos_qfe_labels error ratio","color":"#E7D551","fillBelowTo":"memcached_thanos_qfe_labels error ratio avg","zindex":3},{"alias":"memcached_thanos_qfe_labels error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_qfe_labels-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_labels error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_labels error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"memcached_thanos_qfe_labels SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":38},"id":17,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_labels SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":31},"id":1486321894,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"memcached_thanos_qfe_labels RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_qfe_labels-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_labels RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"memcached_thanos_qfe_labels\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"memcached_thanos_qfe_labels SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nVarious memcached instances support our thanos infrastructure, for the\nstore and query-frontend components.\n\n","gridPos":{"h":8,"w":6,"x":18,"y":31},"id":19,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":41},"id":2315412172,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"memcached_thanos_qfe_query_range SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=memcached_thanos_qfe_query_range\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"memcached_thanos_qfe_query_range apdex","color":"#E7D551","zindex":3},{"alias":"memcached_thanos_qfe_query_range apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"memcached_thanos_qfe_query_range apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_qfe_query_range-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_query_range apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_query_range apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"memcached_thanos_qfe_query_range SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":48},"id":21,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_query_range SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":41},"id":2342545966,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"memcached_thanos_qfe_query_range SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=memcached_thanos_qfe_query_range\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"memcached_thanos_qfe_query_range error ratio","color":"#E7D551","fillBelowTo":"memcached_thanos_qfe_query_range error ratio avg","zindex":3},{"alias":"memcached_thanos_qfe_query_range error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_qfe_query_range-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_query_range error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_query_range error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"memcached_thanos_qfe_query_range SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":48},"id":23,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_query_range SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":41},"id":1826217972,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"memcached_thanos_qfe_query_range RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_qfe_query_range-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_qfe_query_range RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"memcached_thanos_qfe_query_range\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"memcached_thanos_qfe_query_range SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nVarious memcached instances support our thanos infrastructure, for the\nstore and query-frontend components.\n\n","gridPos":{"h":8,"w":6,"x":18,"y":41},"id":25,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":51},"id":2079888397,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"memcached_thanos_store_bucket SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=memcached_thanos_store_bucket\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"memcached_thanos_store_bucket apdex","color":"#E7D551","zindex":3},{"alias":"memcached_thanos_store_bucket apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"memcached_thanos_store_bucket apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_store_bucket-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_bucket apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_bucket apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"memcached_thanos_store_bucket SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":58},"id":27,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_bucket SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":51},"id":3450526005,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"memcached_thanos_store_bucket SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=memcached_thanos_store_bucket\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"memcached_thanos_store_bucket error ratio","color":"#E7D551","fillBelowTo":"memcached_thanos_store_bucket error ratio avg","zindex":3},{"alias":"memcached_thanos_store_bucket error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_store_bucket-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_bucket error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_bucket error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"memcached_thanos_store_bucket SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":58},"id":29,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üîïÔøΩ","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_bucket SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":51},"id":608305349,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"memcached_thanos_store_bucket RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_store_bucket-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_bucket RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"memcached_thanos_store_bucket\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"memcached_thanos_store_bucket SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nVarious memcached instances support our thanos infrastructure, for the\nstore and query-frontend components.\n\n","gridPos":{"h":8,"w":6,"x":18,"y":51},"id":31,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":61},"id":383276883,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"memcached_thanos_store_index SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=memcached_thanos_store_index\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"memcached_thanos_store_index apdex","color":"#E7D551","zindex":3},{"alias":"memcached_thanos_store_index apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"memcached_thanos_store_index apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_store_index-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_index apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_index apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"memcached_thanos_store_index SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":68},"id":33,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_index SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":61},"id":4083956997,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"memcached_thanos_store_index SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=memcached_thanos_store_index\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"memcached_thanos_store_index error ratio","color":"#E7D551","fillBelowTo":"memcached_thanos_store_index error ratio avg","zindex":3},{"alias":"memcached_thanos_store_index error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_store_index-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_index error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_index error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"memcached_thanos_store_index SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":68},"id":35,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_index SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":61},"id":928382755,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"memcached_thanos_store_index RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-memcached_thanos_store_index-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"memcached_thanos_store_index RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"memcached_thanos_store_index\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"memcached_thanos_store_index SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nVarious memcached instances support our thanos infrastructure, for the\nstore and query-frontend components.\n\n","gridPos":{"h":8,"w":6,"x":18,"y":61},"id":37,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":71},"id":4146537329,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"prometheus SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=prometheus\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"prometheus apdex","color":"#E7D551","zindex":3},{"alias":"prometheus apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"prometheus apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-prometheus-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"prometheus apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"prometheus apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"prometheus SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":78},"id":39,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"prometheus SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":71},"id":190969910,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"prometheus SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=prometheus\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"prometheus error ratio","color":"#E7D551","fillBelowTo":"prometheus error ratio avg","zindex":3},{"alias":"prometheus error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-prometheus-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"prometheus error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"prometheus error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"prometheus SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":78},"id":41,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"prometheus SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":71},"id":443859513,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"prometheus RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-prometheus-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"prometheus RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"prometheus\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"prometheus SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThis SLI monitors Prometheus instances via the HTTP interface.\n5xx responses are considered errors.\n\n\n\n### Observability Tools\n\n* [üìñ Kibana: Prometheus (gprd) logs](https://log.gprd.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:monitoring.prometheus,type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'AW5ZoH2ddtvLTaJbch2P')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Prometheus (gprd) failed request logs](https://log.gprd.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:monitoring.prometheus,type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'AW5ZoH2ddtvLTaJbch2P')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Prometheus (gprd) requests](https://log.gprd.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=AW5ZoH2ddtvLTaJbch2P\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:monitoring.prometheus,type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Prometheus (gprd) failed requests](https://log.gprd.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=AW5ZoH2ddtvLTaJbch2P\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:monitoring.prometheus,type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Prometheus (ops) logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:monitoring.prometheus,type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Prometheus (ops) failed request logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:monitoring.prometheus,type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Prometheus (ops) requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:monitoring.prometheus,type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Prometheus (ops) failed requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:monitoring.prometheus,type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n\n","gridPos":{"h":8,"w":6,"x":18,"y":71},"id":43,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":8,"x":0,"y":81},"id":3098809023,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"prometheus_alert_sender SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=prometheus_alert_sender\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"prometheus_alert_sender error ratio","color":"#E7D551","fillBelowTo":"prometheus_alert_sender error ratio avg","zindex":3},{"alias":"prometheus_alert_sender error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-prometheus_alert_sender-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"prometheus_alert_sender error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"prometheus_alert_sender error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"prometheus_alert_sender SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":8,"x":0,"y":88},"id":45,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"prometheus_alert_sender SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":81},"id":2970883772,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"prometheus_alert_sender RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-prometheus_alert_sender-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"prometheus_alert_sender RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"prometheus_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"prometheus_alert_sender SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThis SLI monitors all prometheus alert notifications that are generated by AlertManager.\nAlert delivery failure is considered a service-level failure.\n\n","gridPos":{"h":8,"w":8,"x":16,"y":81},"id":47,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":91},"id":1482786452,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"public_dashboards_thanos_query SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=public_dashboards_thanos_query\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"public_dashboards_thanos_query apdex","color":"#E7D551","zindex":3},{"alias":"public_dashboards_thanos_query apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"public_dashboards_thanos_query apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-public_dashboards_thanos_query-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"public_dashboards_thanos_query apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"public_dashboards_thanos_query apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"public_dashboards_thanos_query SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":98},"id":49,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"public_dashboards_thanos_query SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":91},"id":2417201990,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"public_dashboards_thanos_query SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=public_dashboards_thanos_query\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"public_dashboards_thanos_query error ratio","color":"#E7D551","fillBelowTo":"public_dashboards_thanos_query error ratio avg","zindex":3},{"alias":"public_dashboards_thanos_query error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-public_dashboards_thanos_query-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"public_dashboards_thanos_query error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"public_dashboards_thanos_query error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"public_dashboards_thanos_query SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":98},"id":51,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"public_dashboards_thanos_query SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":91},"id":2907510908,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"public_dashboards_thanos_query RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-public_dashboards_thanos_query-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"public_dashboards_thanos_query RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"public_dashboards_thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"public_dashboards_thanos_query SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThanos query gathers the data needed to evaluate Prometheus queries from multiple underlying prometheus and thanos instances.\nThis SLI monitors the Thanos query HTTP interface for GitLab's public Thanos instance, which is used by the public Grafana\ninstance. 5xx responses are considered failures.\n\n\n\n### Observability Tools\n\n* [Elastic APM: thanos](https://log.gprd.gitlab.net/app/apm#/services/thanos/transactions)\n* [üìñ Kibana: Thanos Query logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-query',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Query failed request logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-query',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Query requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-query',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Query failed requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-query',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n\n","gridPos":{"h":8,"w":6,"x":18,"y":91},"id":53,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":8,"x":0,"y":101},"id":477814813,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"public_grafana_googlelb SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=public_grafana_googlelb\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"public_grafana_googlelb error ratio","color":"#E7D551","fillBelowTo":"public_grafana_googlelb error ratio avg","zindex":3},{"alias":"public_grafana_googlelb error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-public_grafana_googlelb-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"public_grafana_googlelb error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"public_grafana_googlelb error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"public_grafana_googlelb SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":8,"x":0,"y":108},"id":55,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"public_grafana_googlelb SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":101},"id":125921089,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"public_grafana_googlelb RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-public_grafana_googlelb-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"public_grafana_googlelb RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"public_grafana_googlelb\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"public_grafana_googlelb SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Observability Tools\n\n* [Google Load Balancer](https://console.cloud.google.com/net-services/loadbalancing/details/http/ops-dashboards-com?project=gitlab-ops)\n* [Stackdriver Logs: Loadbalancer Access Logs](https://console.cloud.google.com/logs/query;query=resource%2Elabels%2Etarget%5Fproxy%5Fname%3D%22ops%2Ddashboards%2Dcom%22%0Aresource%2Etype%3D%22http%5Fload%5Fbalancer%22;timeRange=PT30M?project=gitlab-ops)\n* [Stackdriver Logs: Loadbalancer Access 5xx Logs](https://console.cloud.google.com/logs/query;query=httpRequest%2Estatus%3E%3D500%0Aresource%2Elabels%2Etarget%5Fproxy%5Fname%3D%22ops%2Ddashboards%2Dcom%22%0Aresource%2Etype%3D%22http%5Fload%5Fbalancer%22;timeRange=PT30M?project=gitlab-ops)\n\n","gridPos":{"h":8,"w":8,"x":16,"y":101},"id":57,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":8,"x":0,"y":111},"id":3727131931,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"rule_evaluation SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=rule_evaluation\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"rule_evaluation error ratio","color":"#E7D551","fillBelowTo":"rule_evaluation error ratio avg","zindex":3},{"alias":"rule_evaluation error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-rule_evaluation-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"rule_evaluation error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"rule_evaluation error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"rule_evaluation SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":8,"x":0,"y":118},"id":59,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"rule_evaluation SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":111},"id":2621394178,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"rule_evaluation RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-rule_evaluation-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"rule_evaluation RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"rule_evaluation\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"rule_evaluation SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThis SLI monitors Prometheus recording rule evaluations. Recording rule evalution failures are considered to be\nservice failures.\n\n","gridPos":{"h":8,"w":8,"x":16,"y":111},"id":61,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":8,"x":0,"y":121},"id":3147757590,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"thanos_compactor SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=thanos_compactor\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"thanos_compactor error ratio","color":"#E7D551","fillBelowTo":"thanos_compactor error ratio avg","zindex":3},{"alias":"thanos_compactor error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_compactor-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_compactor error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_compactor error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"thanos_compactor SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":8,"x":0,"y":128},"id":63,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"thanos_compactor SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":121},"id":1032683714,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"thanos_compactor RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_compactor-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_compactor RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"thanos_compactor\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"thanos_compactor SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThanos compactor is responsible for compaction of Prometheus series data into blocks, which are stored in GCS buckets.\nIt also handles downsampling. This SLI monitors compaction operations and compaction failures.\n\n\n\n### Observability Tools\n\n* [Elastic APM: thanos](https://log.gprd.gitlab.net/app/apm#/services/thanos/transactions)\n* [üìñ Kibana: Thanos Compact (gprd) logs](https://log.gprd.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-compact',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'AW5ZoH2ddtvLTaJbch2P')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Compact (gprd) failed request logs](https://log.gprd.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-compact',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'AW5ZoH2ddtvLTaJbch2P')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Compact (gprd) requests](https://log.gprd.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=AW5ZoH2ddtvLTaJbch2P\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-compact',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Compact (gprd) failed requests](https://log.gprd.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=AW5ZoH2ddtvLTaJbch2P\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-compact',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Compact (ops) logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-compact',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Compact (ops) failed request logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-compact',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Compact (ops) requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-compact',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Compact (ops) failed requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-compact',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n\n","gridPos":{"h":8,"w":8,"x":16,"y":121},"id":65,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":131},"id":1281064991,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"thanos_query SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=thanos_query\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"thanos_query apdex","color":"#E7D551","zindex":3},{"alias":"thanos_query apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"thanos_query apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_query-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"thanos_query SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":138},"id":67,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"thanos_query SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":131},"id":4004985658,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"thanos_query SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=thanos_query\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"thanos_query error ratio","color":"#E7D551","fillBelowTo":"thanos_query error ratio avg","zindex":3},{"alias":"thanos_query error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_query-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"thanos_query SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":138},"id":69,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"thanos_query SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":131},"id":431223751,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"thanos_query RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_query-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"thanos_query\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"thanos_query SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThanos query gathers the data needed to evaluate Prometheus queries from multiple underlying prometheus and thanos instances.\nThis SLI monitors the Thanos query HTTP interface. 5xx responses are considered failures.\n\n\n\n### Observability Tools\n\n* [Elastic APM: thanos](https://log.gprd.gitlab.net/app/apm#/services/thanos/transactions)\n\n","gridPos":{"h":8,"w":6,"x":18,"y":131},"id":71,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":141},"id":3015468996,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"thanos_query_frontend SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=thanos_query_frontend\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"thanos_query_frontend apdex","color":"#E7D551","zindex":3},{"alias":"thanos_query_frontend apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"thanos_query_frontend apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_query_frontend-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query_frontend apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query_frontend apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"thanos_query_frontend SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":148},"id":73,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"thanos_query_frontend SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":141},"id":1994646344,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"thanos_query_frontend SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=thanos_query_frontend\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"thanos_query_frontend error ratio","color":"#E7D551","fillBelowTo":"thanos_query_frontend error ratio avg","zindex":3},{"alias":"thanos_query_frontend error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_query_frontend-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query_frontend error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query_frontend error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"thanos_query_frontend SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":148},"id":75,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"thanos_query_frontend SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":141},"id":1877464727,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"thanos_query_frontend RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_query_frontend-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_query_frontend RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"thanos_query_frontend\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"thanos_query_frontend SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThanos query gathers the data needed to evaluate Prometheus queries from multiple underlying prometheus and thanos instances.\nThis SLI monitors the Thanos query HTTP interface. 5xx responses are considered failures.\n\n\n\n### Observability Tools\n\n* [Elastic APM: thanos](https://log.gprd.gitlab.net/app/apm#/services/thanos/transactions)\n* [üìñ Kibana: Thanos Query logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-query',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Query failed request logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-query',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Query requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-query',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Query failed requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-query',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n\n","gridPos":{"h":8,"w":6,"x":18,"y":141},"id":77,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":8,"x":0,"y":151},"id":3718148749,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"thanos_rule_alert_sender SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=thanos_rule_alert_sender\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"thanos_rule_alert_sender error ratio","color":"#E7D551","fillBelowTo":"thanos_rule_alert_sender error ratio avg","zindex":3},{"alias":"thanos_rule_alert_sender error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_rule_alert_sender-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_rule_alert_sender error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_rule_alert_sender error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"thanos_rule_alert_sender SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":8,"x":0,"y":158},"id":79,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"thanos_rule_alert_sender SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":151},"id":2608229891,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"thanos_rule_alert_sender RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_rule_alert_sender-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_rule_alert_sender RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"thanos_rule_alert_sender\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"thanos_rule_alert_sender SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThis SLI monitors alerts generated by Thanos Ruler.\nAlert delivery failure is considered a service-level failure.\n\n\n\n### Observability Tools\n\n* [Elastic APM: thanos](https://log.gprd.gitlab.net/app/apm#/services/thanos/transactions)\n* [üìñ Kibana: Thanos Rule logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-rule',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Rule failed request logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-rule',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Rule requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-rule',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Rule failed requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-rule',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n\n","gridPos":{"h":8,"w":8,"x":16,"y":151},"id":81,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":161},"id":3649067073,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"thanos_store SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=thanos_store\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"thanos_store apdex","color":"#E7D551","zindex":3},{"alias":"thanos_store apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"thanos_store apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_store-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_store apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_store apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"thanos_store SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":168},"id":83,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"thanos_store SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":161},"id":279093558,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"thanos_store SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=thanos_store\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"thanos_store error ratio","color":"#E7D551","fillBelowTo":"thanos_store error ratio avg","zindex":3},{"alias":"thanos_store error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_store-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_store error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_store error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"thanos_store SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":168},"id":85,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"thanos_store SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":161},"id":1091689110,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"thanos_store RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-thanos_store-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"thanos_store RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"thanos_store\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"thanos_store SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThanos store will respond to Thanos Query (and other) requests for historical data. This historical data is kept in\nGCS buckets. This SLI monitors the Thanos StoreAPI GRPC endpoint. GRPC error responses are considered to be service-level failures.\n\n\n\n### Observability Tools\n\n* [Elastic APM: thanos](https://log.gprd.gitlab.net/app/apm#/services/thanos/transactions)\n* [üìñ Kibana: Thanos Store (gprd) logs](https://log.gprd.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-store',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'AW5ZoH2ddtvLTaJbch2P')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Store (gprd) failed request logs](https://log.gprd.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-store',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'AW5ZoH2ddtvLTaJbch2P')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Store (gprd) requests](https://log.gprd.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=AW5ZoH2ddtvLTaJbch2P\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-store',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Store (gprd) failed requests](https://log.gprd.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=AW5ZoH2ddtvLTaJbch2P\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-store',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Store (ops) logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-store',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìñ Kibana: Thanos Store (ops) failed request logs](https://nonprod-log.gitlab.net/app/kibana#/discover?_a=(columns:!(json.hostname,json.msg,json.level),filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-store',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),index:'pubsub-monitoring-inf-ops')\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Store (ops) requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-store',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n* [üìà Kibana: Thanos Store (ops) failed requests](https://nonprod-log.gitlab.net/app/kibana#/visualize/create?type=line\u0026indexPattern=pubsub-monitoring-inf-ops\u0026_a=(filters:!((query:(match:(json.tag.keyword:(query:'monitoring.systemd.thanos-store',type:phrase)))),(query:(match:(json.stage:(query:'$stage',type:phrase)))),(query:(match:(json.type:(query:monitoring,type:phrase)))),(query:(match:(json.level:(query:error,type:phrase))))),query:(language:kuery,query:''),vis:(aggs:!((enabled:!t,id:'1',params:(),schema:metric,type:count),(enabled:!t,id:'2',params:(drop_partials:!t,extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1,scaleMetricValues:!f,timeRange:(from:'${__from:date:iso}',to:'${__to:date:iso}'),useNormalizedEsInterval:!t),schema:segment,type:date_histogram))))\u0026_g=(time:(from:'${__from:date:iso}',to:'${__to:date:iso}')))\n\n","gridPos":{"h":8,"w":6,"x":18,"y":161},"id":87,"mode":"markdown","title":"Details","type":"text"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Apdex is a measure of requests that complete within a tolerable period of time for the service. Higher is better.","fill":0,"gridPos":{"h":7,"w":6,"x":0,"y":171},"id":135884220,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"trickster SLI Apdex SLO Analysis","url":"/d/alerts-component_slo_apdex?${__url_time_range}\u0026${__all_variables}\u0026var-component=trickster\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"trickster apdex","color":"#E7D551","zindex":3},{"alias":"trickster apdex avg","color":"#5794F2","dashLength":1,"fillBelowTo":"trickster apdex","linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-trickster-apdex","stack":false,"steppedLine":false,"targets":[{"expr":"min_over_time(gitlab_component_apdex:ratio_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"trickster apdex","refId":"A"},{"expr":"(1 - 6 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"avg_over_time(gitlab_component_apdex:ratio_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"trickster apdex avg","refId":"D"},{"expr":"clamp_min(\n  gitlab_component_apdex:ratio_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(min((1 - 14.4 * (1 - avg(slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"trickster SLI Apdex","tooltip":{"shared":true,"sort":1,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Apdex %","logBase":1,"max":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":0,"y":178},"id":89,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üî•ü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum(\n  label_replace(\n    vector(0) and on() (gitlab_component_apdex:ratio_1h{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on () (gitlab_component_apdex:ratio_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on () (gitlab_component_apdex:ratio_1h{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (14.4 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on () (gitlab_component_apdex:ratio_30m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on () (gitlab_component_apdex:ratio_6h{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003c on(tier, type) group_left() (1 - (6 * (1 - slo:min:events:gitlab_service_apdex:ratio{monitor=\"global\",type=\"monitoring\"})))),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"trickster SLI | Latency/Apdex"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Error rates are a measure of unhandled service exceptions per second. Client errors are excluded when possible. Lower is better","fill":0,"gridPos":{"h":7,"w":6,"x":6,"y":171},"id":3348294780,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","options":{"dataLinks":[{"targetBlank":true,"title":"trickster SLI Error-Rate SLO Analysis","url":"/d/alerts-component_slo_error?${__url_time_range}\u0026${__all_variables}\u0026var-component=trickster\u0026var-type=monitoring\u0026var-stage=$stage"}]},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"6h Degradation SLO (5% of monthly error budget)","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"1h Outage SLO (2% of monthly error budget)","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"trickster error ratio","color":"#E7D551","fillBelowTo":"trickster error ratio avg","zindex":3},{"alias":"trickster error ratio avg","color":"#5794F2","dashLength":1,"fillGradient":10,"linewidth":1,"spaceLength":1,"zindex":-3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-trickster-error-rate","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_component_errors:ratio_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"trickster error ratio","refId":"A"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"6h Degradation SLO (5% of monthly error budget)","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"1h Outage SLO (2% of monthly error budget)","refId":"C"},{"expr":"clamp_max(\n  avg_over_time(gitlab_component_errors:ratio_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n,\n  1\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"trickster error ratio avg","refId":"D"},{"expr":"clamp_max(\n  gitlab_component_errors:ratio_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n,\n  scalar(max((14.4 * avg(slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"}))\n))\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"E"}],"title":"trickster SLI Error Ratio","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Error %","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"gridPos":{"h":1,"w":6,"x":6,"y":178},"id":91,"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning üî•","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning üî•","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded üî•","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning ü•µ","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning üî•ü•µ","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning üî•ü•µ","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded üî•ü•µ","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning ü•µ","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning üî•ü•µ","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning üîïÔøΩü•µ","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded üî•ü•µ","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded ü•µ","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded üî•ü•µ","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded üî•ü•µ","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded üî•ü•µ","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_errors:ratio_1h{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_errors:ratio_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_errors:ratio_1h{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_errors:ratio_30m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_errors:ratio_6h{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"monitoring\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"trickster SLI | Errors"}],"title":"","type":"stat"},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The operation rate is the sum total of all requests being handle for all components within this service. Note that a single user request can lead to requests to multiple components. Higher is busier.","fill":0,"gridPos":{"h":8,"w":6,"x":12,"y":171},"id":190727195,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"trickster RPS","color":"#E7D551","zindex":3},{"alias":"last week","color":"#dddddd80","dashLength":4,"dashes":true,"fill":0,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":2,"zindex":-3}],"spaceLength":10,"stableId":"sli-trickster-ops-rate","stack":false,"steppedLine":false,"targets":[{"expr":"avg_over_time(gitlab_component_ops:rate_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"trickster RPS","refId":"A"},{"expr":"gitlab_component_ops:rate_5m{component=\"trickster\",env=\"$environment\",environment=\"$environment\",monitor=\"global\",stage=\"$stage\",type=\"monitoring\"} offset 1w\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"last week","refId":"B"}],"title":"trickster SLI RPS - Requests per Second","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Operations per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"content":"### Description\n\nThis SLI monitors the Trickster HTTP interface.\n\n","gridPos":{"h":8,"w":6,"x":18,"y":171},"id":93,"mode":"markdown","title":"Details","type":"text"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":100},"id":94,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":95,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(http_request_total{env=\"$environment\",environment=\"$environment\",job=\"grafana\",stage=\"$stage\",statuscode=~\"^5.*\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"grafana Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":96,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(http_request_total{env=\"$environment\",environment=\"$environment\",job=\"grafana\",stage=\"$stage\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"grafana RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":97,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(http_request_total{env=\"$environment\",environment=\"$environment\",job=\"grafana\",stage=\"$stage\",statuscode=~\"^5.*\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"grafana Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":98,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(http_request_total{env=\"$environment\",environment=\"$environment\",job=\"grafana\",stage=\"$stage\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"grafana RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ grafana Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":110},"id":99,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":100,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 memcached_thanos_qfe_labels Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":101,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(thanos_memcached_operation_failures_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"memcached_thanos_qfe_labels Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":102,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(memcached_commands_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"memcached_thanos_qfe_labels RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":103,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 memcached_thanos_qfe_labels Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":104,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    sum by (fqdn) (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",le=~\"1|1\\\\.0\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for memcached_thanos_qfe_labels Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":105,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(thanos_memcached_operation_failures_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"memcached_thanos_qfe_labels Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":106,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(memcached_commands_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-labels-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"memcached_thanos_qfe_labels RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ memcached_thanos_qfe_labels Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":120},"id":107,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":108,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 memcached_thanos_qfe_query_range Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":109,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(thanos_memcached_operation_failures_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"memcached_thanos_qfe_query_range Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":110,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(memcached_commands_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"memcached_thanos_qfe_query_range RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":111,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 memcached_thanos_qfe_query_range Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":112,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    sum by (fqdn) (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",le=~\"1|1\\\\.0\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for memcached_thanos_qfe_query_range Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":113,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(thanos_memcached_operation_failures_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"memcached_thanos_qfe_query_range Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":114,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(memcached_commands_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-qfe-query-range-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"memcached_thanos_qfe_query_range RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ memcached_thanos_qfe_query_range Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":130},"id":115,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":116,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 memcached_thanos_store_bucket Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":117,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(thanos_memcached_operation_failures_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"memcached_thanos_store_bucket Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":118,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(memcached_commands_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"memcached_thanos_store_bucket RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":119,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 memcached_thanos_store_bucket Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":120,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    sum by (fqdn) (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",le=~\"1|1\\\\.0\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for memcached_thanos_store_bucket Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":121,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(thanos_memcached_operation_failures_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"memcached_thanos_store_bucket Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":122,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(memcached_commands_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-bucket-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"memcached_thanos_store_bucket RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ memcached_thanos_store_bucket Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":140},"id":123,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":124,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 memcached_thanos_store_index Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":125,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(thanos_memcached_operation_failures_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"memcached_thanos_store_index Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":126,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(memcached_commands_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"memcached_thanos_store_index RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":127,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 memcached_thanos_store_index Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":128,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    sum by (fqdn) (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",le=~\"1|1\\\\.0\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(thanos_memcached_operation_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for memcached_thanos_store_index Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":129,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(thanos_memcached_operation_failures_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"memcached_thanos_store_index Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":130,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(memcached_commands_total{env=\"$environment\",environment=\"$environment\",job=\"memcached-thanos-index-cache-metrics\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"memcached_thanos_store_index RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ memcached_thanos_store_index Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":150},"id":131,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":132,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":3,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 prometheus Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":133,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(prometheus_http_requests_total{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"prometheus Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":134,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(prometheus_http_requests_total{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"prometheus RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":135,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":3,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 prometheus Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":136,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    (\n  sum by (fqdn) (\n    rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",le=\"1\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n  +\n  sum by (fqdn) (\n    rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",le=\"3\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n/\n2\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for prometheus Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":137,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(prometheus_http_requests_total{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"prometheus Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":138,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(prometheus_http_requests_total{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"prometheus RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":20},"id":139,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (handler,le) (\n    rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{handler}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":3,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 prometheus Latency - per handler","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":20},"id":140,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (handler) (\n  rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    (\n  sum by (handler) (\n    rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",le=\"1\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n  +\n  sum by (handler) (\n    rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",le=\"3\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n/\n2\n\n  )\n)\n/ ignoring(handler) group_left()\n(\n  sum by () (\n  rate(prometheus_http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{handler}}","refId":"A"}],"title":"Apdex attribution for prometheus Latency - per handler","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":20},"id":141,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (handler) (\n  rate(prometheus_http_requests_total{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{handler}}","refId":"A"}],"title":"prometheus Errors - per handler","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":20},"id":142,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (handler) (\n  rate(prometheus_http_requests_total{env=\"$environment\",environment=\"$environment\",job=~\"prometheus.*\",job!=\"prometheus-metamon\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{handler}}","refId":"A"}],"title":"prometheus RPS - per handler","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ prometheus Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":160},"id":143,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":144,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(prometheus_notifications_errors_total{env=\"$environment\",environment=\"$environment\",job=\"prometheus\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"prometheus_alert_sender Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":145,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(prometheus_notifications_sent_total{env=\"$environment\",environment=\"$environment\",job=\"prometheus\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"prometheus_alert_sender RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":146,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(prometheus_notifications_errors_total{env=\"$environment\",environment=\"$environment\",job=\"prometheus\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"prometheus_alert_sender Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":147,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(prometheus_notifications_sent_total{env=\"$environment\",environment=\"$environment\",job=\"prometheus\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"prometheus_alert_sender RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":20},"id":148,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (alertmanager) (\n  rate(prometheus_notifications_errors_total{env=\"$environment\",environment=\"$environment\",job=\"prometheus\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{alertmanager}}","refId":"A"}],"title":"prometheus_alert_sender Errors - per alertmanager","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":20},"id":149,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (alertmanager) (\n  rate(prometheus_notifications_sent_total{env=\"$environment\",environment=\"$environment\",job=\"prometheus\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{alertmanager}}","refId":"A"}],"title":"prometheus_alert_sender RPS - per alertmanager","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ prometheus_alert_sender Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":170},"id":150,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":151,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":30,"yaxis":"left"}],"title":"Estimated p95 public_dashboards_thanos_query Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":152,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  sli_aggregations:http_requests_total_rate5m{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=\"thanos\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"public_dashboards_thanos_query Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":153,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  sli_aggregations:http_requests_total_rate5m{env=\"$environment\",environment=\"$environment\",job=\"thanos\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"public_dashboards_thanos_query RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":154,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":30,"yaxis":"left"}],"title":"Estimated p95 public_dashboards_thanos_query Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":155,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos\",le=\"+Inf\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    sum by (fqdn) (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos\",le=\"30\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos\",le=\"+Inf\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for public_dashboards_thanos_query Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":156,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  sli_aggregations:http_requests_total_rate5m{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=\"thanos\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"public_dashboards_thanos_query Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":157,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  sli_aggregations:http_requests_total_rate5m{env=\"$environment\",environment=\"$environment\",job=\"thanos\",shard=\"public-dashboards\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"public_dashboards_thanos_query RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ public_dashboards_thanos_query Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":180},"id":158,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":159,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(stackdriver_https_lb_rule_loadbalancing_googleapis_com_https_request_count{env=\"$environment\",environment=\"$environment\",project_id=\"gitlab-ops\",response_code_class=\"500\",target_proxy_name=\"ops-dashboards-com\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"public_grafana_googlelb Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":160,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(stackdriver_https_lb_rule_loadbalancing_googleapis_com_https_request_count{env=\"$environment\",environment=\"$environment\",project_id=\"gitlab-ops\",target_proxy_name=\"ops-dashboards-com\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"public_grafana_googlelb RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":161,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (proxy_continent) (\n  rate(stackdriver_https_lb_rule_loadbalancing_googleapis_com_https_request_count{env=\"$environment\",environment=\"$environment\",project_id=\"gitlab-ops\",response_code_class=\"500\",target_proxy_name=\"ops-dashboards-com\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{proxy_continent}}","refId":"A"}],"title":"public_grafana_googlelb Errors - per proxy_continent","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":162,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (proxy_continent) (\n  rate(stackdriver_https_lb_rule_loadbalancing_googleapis_com_https_request_count{env=\"$environment\",environment=\"$environment\",project_id=\"gitlab-ops\",target_proxy_name=\"ops-dashboards-com\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{proxy_continent}}","refId":"A"}],"title":"public_grafana_googlelb RPS - per proxy_continent","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":20},"id":163,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (response_code) (\n  rate(stackdriver_https_lb_rule_loadbalancing_googleapis_com_https_request_count{env=\"$environment\",environment=\"$environment\",project_id=\"gitlab-ops\",response_code_class=\"500\",target_proxy_name=\"ops-dashboards-com\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{response_code}}","refId":"A"}],"title":"public_grafana_googlelb Errors - per response_code","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":20},"id":164,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (response_code) (\n  rate(stackdriver_https_lb_rule_loadbalancing_googleapis_com_https_request_count{env=\"$environment\",environment=\"$environment\",project_id=\"gitlab-ops\",target_proxy_name=\"ops-dashboards-com\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{response_code}}","refId":"A"}],"title":"public_grafana_googlelb RPS - per response_code","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ public_grafana_googlelb Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":190},"id":165,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":166,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(prometheus_rule_evaluation_failures_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"rule_evaluation Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":167,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(prometheus_rule_evaluations_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"rule_evaluation RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":168,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(prometheus_rule_evaluation_failures_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"rule_evaluation Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":169,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(prometheus_rule_evaluations_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"rule_evaluation RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ rule_evaluation Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":200},"id":170,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":171,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(thanos_compact_group_compactions_failures_total{env=\"$environment\",environment=\"$environment\",job=\"thanos\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_compactor Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":172,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(thanos_compact_group_compactions_total{env=\"$environment\",environment=\"$environment\",job=\"thanos\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_compactor RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":173,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(thanos_compact_group_compactions_failures_total{env=\"$environment\",environment=\"$environment\",job=\"thanos\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_compactor Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":174,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(thanos_compact_group_compactions_total{env=\"$environment\",environment=\"$environment\",job=\"thanos\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_compactor RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ thanos_compactor Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":210},"id":175,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":176,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":30,"yaxis":"left"}],"title":"Estimated p95 thanos_query Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":177,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  sli_aggregations:http_requests_total_rate5m{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_query Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":178,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  sli_aggregations:http_requests_total_rate5m{env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_query RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":179,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":30,"yaxis":"left"}],"title":"Estimated p95 thanos_query Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":180,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",le=\"+Inf\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    sum by (fqdn) (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",le=~\"30|30\\\\.0\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",le=\"+Inf\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for thanos_query Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":181,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  sli_aggregations:http_requests_total_rate5m{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_query Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":182,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  sli_aggregations:http_requests_total_rate5m{env=\"$environment\",environment=\"$environment\",job=\"thanos-query\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_query RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ thanos_query Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":220},"id":183,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":184,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":30,"yaxis":"left"}],"title":"Estimated p95 thanos_query_frontend Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":185,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  sli_aggregations:http_requests_total_rate5m{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_query_frontend Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":186,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  sli_aggregations:http_requests_total_rate5m{env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_query_frontend RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":187,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":30,"yaxis":"left"}],"title":"Estimated p95 thanos_query_frontend Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":188,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",le=\"+Inf\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    sum by (fqdn) (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",le=\"30\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(http_request_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",le=\"+Inf\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for thanos_query_frontend Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":189,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  sli_aggregations:http_requests_total_rate5m{code=~\"^5.*\",env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_query_frontend Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":190,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  sli_aggregations:http_requests_total_rate5m{env=\"$environment\",environment=\"$environment\",job=~\"thanos|thanos-query-frontend\",shard=\"default\",stage=\"$stage\",type=\"monitoring\"}\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_query_frontend RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ thanos_query_frontend Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":230},"id":191,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":192,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(thanos_alert_sender_errors_total{env=\"$environment\",environment=\"$environment\",job=\"thanos\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_rule_alert_sender Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":193,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(thanos_alert_sender_alerts_sent_total{env=\"$environment\",environment=\"$environment\",job=\"thanos\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_rule_alert_sender RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":194,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(thanos_alert_sender_errors_total{env=\"$environment\",environment=\"$environment\",job=\"thanos\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_rule_alert_sender Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":195,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(thanos_alert_sender_alerts_sent_total{env=\"$environment\",environment=\"$environment\",job=\"thanos\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_rule_alert_sender RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ thanos_rule_alert_sender Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":240},"id":196,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":197,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(grpc_server_handling_seconds_bucket{env=\"$environment\",environment=\"$environment\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":3,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 thanos_store Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":198,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(grpc_server_handled_total{env=\"$environment\",environment=\"$environment\",grpc_code!=\"OK\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_store Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":199,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(grpc_server_handled_total{env=\"$environment\",environment=\"$environment\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"thanos_store RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":200,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(grpc_server_handling_seconds_bucket{env=\"$environment\",environment=\"$environment\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":3,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":1,"yaxis":"left"}],"title":"Estimated p95 thanos_store Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":201,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(grpc_server_handling_seconds_bucket{env=\"$environment\",environment=\"$environment\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n  -\n  (\n    (\n  sum by (fqdn) (\n    rate(grpc_server_handling_seconds_bucket{env=\"$environment\",environment=\"$environment\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",le=~\"1|1\\\\.0\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n  +\n  sum by (fqdn) (\n    rate(grpc_server_handling_seconds_bucket{env=\"$environment\",environment=\"$environment\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",le=~\"3|3\\\\.0\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n  )\n)\n/\n2\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(grpc_server_handling_seconds_bucket{env=\"$environment\",environment=\"$environment\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",le=\"+Inf\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for thanos_store Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":202,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(grpc_server_handled_total{env=\"$environment\",environment=\"$environment\",grpc_code!=\"OK\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_store Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":203,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(grpc_server_handled_total{env=\"$environment\",environment=\"$environment\",grpc_service=\"thanos.Store\",grpc_type=\"unary\",job=~\"thanos|thanos-store(-[0-9]+)?\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"thanos_store RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ thanos_store Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":10,"w":24,"x":0,"y":250},"id":204,"panels":[{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":0,"y":0},"id":205,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (le) (\n    rate(trickster_frontend_requests_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",stage=\"$stage\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 overall","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":20,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":5,"yaxis":"left"}],"title":"Estimated p95 trickster Latency - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":8,"y":0},"id":206,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(trickster_frontend_requests_total{env=\"$environment\",environment=\"$environment\",http_status=~\"5.*\",stage=\"$stage\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"trickster Errors - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":8,"x":16,"y":0},"id":207,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by () (\n  rate(trickster_frontend_requests_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"overall","refId":"A"}],"title":"trickster RPS - Overall","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":0,"y":10},"id":208,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(\n  0.950000,\n  sum by (fqdn,le) (\n    rate(trickster_frontend_requests_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",stage=\"$stage\"}[$__interval])\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p95 {{fqdn}}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":20,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":5,"yaxis":"left"}],"title":"Estimated p95 trickster Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"s","label":"Duration","logBase":10,"min":0.01,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Attributes apdex downscoring","fill":4,"gridPos":{"h":10,"w":6,"x":6,"y":10},"id":209,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/.*/","transform":"negative-Y"}],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max((\n  sum by (fqdn) (\n  rate(trickster_frontend_requests_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",stage=\"$stage\", le=\"+Inf\"}[$__interval])\n)\n\n  -\n  (\n    (\n  sum by (fqdn) (\n    rate(trickster_frontend_requests_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",stage=\"$stage\", le=\"5\"}[$__interval])\n  )\n  +\n  sum by (fqdn) (\n    rate(trickster_frontend_requests_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",stage=\"$stage\", le=\"20\"}[$__interval])\n  )\n)\n/\n2\n\n  )\n)\n/ ignoring(fqdn) group_left()\n(\n  sum by () (\n  rate(trickster_frontend_requests_duration_seconds_bucket{env=\"$environment\",environment=\"$environment\",stage=\"$stage\", le=\"+Inf\"}[$__interval])\n)\n\n)\n\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"Apdex attribution for trickster Latency - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":12,"y":10},"id":210,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(trickster_frontend_requests_total{env=\"$environment\",environment=\"$environment\",http_status=~\"5.*\",stage=\"$stage\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"trickster Errors - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Errors","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]},{"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":10,"w":6,"x":18,"y":10},"id":211,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":2,"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (fqdn) (\n  rate(trickster_frontend_requests_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\"}[$__interval])\n)\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"{{fqdn}}","refId":"A"}],"title":"trickster RPS - per fqdn","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true},"yaxes":[{"format":"short","label":"Requests per Second","logBase":1,"min":0,"show":true},{"format":"short","logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üî¨ trickster Service Level Indicator Detail","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":300},"id":212,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The amount of non-idle time consumed by nodes for this service","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":213,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg(instance:node_cpu_utilization:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}) by (fqdn)\n","format":"time_series","interval":"1m","intervalFactor":5,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Node CPU","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Average CPU Utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"The maximum utilization of a single core on each node. Lower is better","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":214,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(max(1 - rate(node_cpu_seconds_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", mode=\"idle\"}[$__interval])) by (fqdn)\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":null,"timeFrom":null,"timeShift":null,"title":"Node Maximum Single Core Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation","logBase":1,"max":1,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Network utilization for nodes for this service","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":215,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/receive .*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(node_network_transmit_bytes_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])) by (fqdn)\n","format":"time_series","interval":"1m","intervalFactor":5,"legendFormat":"send {{ fqdn }}","refId":"A"},{"expr":"sum(rate(node_network_receive_bytes_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])) by (fqdn)\n","format":"time_series","interval":"1m","intervalFactor":5,"legendFormat":"receive {{ fqdn }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Node Network Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Network utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Memory utilization. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":216,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(instance:node_memory_utilization:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":null,"timeFrom":null,"timeShift":null,"title":"Memory Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation","logBase":1,"max":1,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Disk Read IO operations per second. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":20},"id":217,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"max(\n  rate(node_disk_reads_completed_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n) by (fqdn)\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Read IOPs","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Operations/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Disk Write IO operations per second. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":20},"id":218,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"max(\n  rate(node_disk_writes_completed_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n) by (fqdn)\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Write IOPs","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"Operations/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Disk Read throughput datarate. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":30},"id":219,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"max(\n  rate(node_disk_read_bytes_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n) by (fqdn)\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Read Throughput","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Bytes/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Disk Write throughput datarate. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":30},"id":220,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"max(\n  rate(node_disk_written_bytes_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n) by (fqdn)\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Write Throughput","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Bytes/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Total time spent in read operations across all disks on the node. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":40},"id":221,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(\n  rate(node_disk_read_time_seconds_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n) by (fqdn)\n","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Read Total Time","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Total Time/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Total time spent in write operations across all disks on the node. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":40},"id":222,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(\n  rate(node_disk_write_time_seconds_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[$__interval])\n) by (fqdn)\n","format":"time_series","interval":"30s","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Disk Write Total Time","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":"Total Time/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"CPU scheduling waiting on the run queue, as a percentage of time. Aggregated to worst CPU per node. Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":50},"id":223,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"max by (fqdn) (\n  rate(node_schedstat_waiting_seconds_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[5m])\n)\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":1,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":0.75,"yaxis":"left"}],"timeFrom":null,"timeShift":null,"title":"CPU Scheduling Waiting","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Total Time/s","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Loadavg (1 minute) per core, below 1 is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":50},"id":224,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg by (environment, type, stage, fqdn) (node_load1{{\"env\": \"$environment\", \"environment\": \"$environment\", \"stage\": \"$stage\", \"type\": \"monitoring\"}})\n/\ncount by (environment, type, stage, fqdn) (node_cpu_seconds_total{mode=\"idle\", {\"env\": \"$environment\", \"environment\": \"$environment\", \"stage\": \"$stage\", \"type\": \"monitoring\"}})\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":1,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":0.8,"yaxis":"left"}],"timeFrom":null,"timeShift":null,"title":"loadavg1 per core","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"loadavg1","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Loadavg (5 minute) per core, below 1 is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":60},"id":225,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg by (environment, type, stage, fqdn) (node_load5{{\"env\": \"$environment\", \"environment\": \"$environment\", \"stage\": \"$stage\", \"type\": \"monitoring\"}})\n/\ncount by (environment, type, stage, fqdn) (node_cpu_seconds_total{mode=\"idle\", {\"env\": \"$environment\", \"environment\": \"$environment\", \"stage\": \"$stage\", \"type\": \"monitoring\"}})\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":1,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":0.8,"yaxis":"left"}],"timeFrom":null,"timeShift":null,"title":"loadavg5 per core","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"loadavg5","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Loadavg (15 minute) per core, below 1 is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":60},"id":226,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"avg by (environment, type, stage, fqdn) (node_load15{{\"env\": \"$environment\", \"environment\": \"$environment\", \"stage\": \"$stage\", \"type\": \"monitoring\"}})\n/\ncount by (environment, type, stage, fqdn) (node_cpu_seconds_total{mode=\"idle\", {\"env\": \"$environment\", \"environment\": \"$environment\", \"stage\": \"$stage\", \"type\": \"monitoring\"}})\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ fqdn }}","refId":"A"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":1,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":0.8,"yaxis":"left"}],"timeFrom":null,"timeShift":null,"title":"loadavg15 per core","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"loadavg15","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üñ•Ô∏è Node Metrics","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":400},"id":227,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":0,"y":1},"id":228,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_cpu_usage_seconds_total:labeled{\n      deployment=\"memcached-thanos-bucket-cache\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-bucket-cache Deployment: CPU","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":1},"id":229,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  container_memory_working_set_bytes:labeled{\n    deployment=\"memcached-thanos-bucket-cache\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n  }\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-bucket-cache Deployment: Memory","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Network utilization","fill":0,"gridPos":{"h":8,"w":8,"x":16,"y":1},"id":230,"legend":{"alignAsTable":false,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/receive .*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_network_transmit_bytes_total:labeled{\n      deployment=\"memcached-thanos-bucket-cache\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"send {{ cluster }}","refId":"A"},{"expr":"sum by(cluster) (\n  rate(\n    container_network_receive_bytes_total:labeled{\n      deployment=\"memcached-thanos-bucket-cache\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"receive {{ cluster }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-bucket-cache Deployment: Network IO","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Network utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":0,"y":9},"id":231,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_cpu_usage_seconds_total:labeled{\n      deployment=\"memcached-thanos-index-cache\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-index-cache Deployment: CPU","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":9},"id":232,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  container_memory_working_set_bytes:labeled{\n    deployment=\"memcached-thanos-index-cache\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n  }\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-index-cache Deployment: Memory","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Network utilization","fill":0,"gridPos":{"h":8,"w":8,"x":16,"y":9},"id":233,"legend":{"alignAsTable":false,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/receive .*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_network_transmit_bytes_total:labeled{\n      deployment=\"memcached-thanos-index-cache\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"send {{ cluster }}","refId":"A"},{"expr":"sum by(cluster) (\n  rate(\n    container_network_receive_bytes_total:labeled{\n      deployment=\"memcached-thanos-index-cache\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"receive {{ cluster }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-index-cache Deployment: Network IO","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Network utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":0,"y":17},"id":234,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_cpu_usage_seconds_total:labeled{\n      deployment=\"memcached-thanos-qfe-labels\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-qfe-labels Deployment: CPU","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":17},"id":235,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  container_memory_working_set_bytes:labeled{\n    deployment=\"memcached-thanos-qfe-labels\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n  }\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-qfe-labels Deployment: Memory","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Network utilization","fill":0,"gridPos":{"h":8,"w":8,"x":16,"y":17},"id":236,"legend":{"alignAsTable":false,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/receive .*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_network_transmit_bytes_total:labeled{\n      deployment=\"memcached-thanos-qfe-labels\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"send {{ cluster }}","refId":"A"},{"expr":"sum by(cluster) (\n  rate(\n    container_network_receive_bytes_total:labeled{\n      deployment=\"memcached-thanos-qfe-labels\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"receive {{ cluster }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-qfe-labels Deployment: Network IO","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Network utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":0,"y":25},"id":237,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_cpu_usage_seconds_total:labeled{\n      deployment=\"memcached-thanos-qfe-query-range\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-qfe-query-range Deployment: CPU","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":25},"id":238,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  container_memory_working_set_bytes:labeled{\n    deployment=\"memcached-thanos-qfe-query-range\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n  }\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-qfe-query-range Deployment: Memory","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Network utilization","fill":0,"gridPos":{"h":8,"w":8,"x":16,"y":25},"id":239,"legend":{"alignAsTable":false,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/receive .*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_network_transmit_bytes_total:labeled{\n      deployment=\"memcached-thanos-qfe-query-range\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"send {{ cluster }}","refId":"A"},{"expr":"sum by(cluster) (\n  rate(\n    container_network_receive_bytes_total:labeled{\n      deployment=\"memcached-thanos-qfe-query-range\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"receive {{ cluster }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memcached-thanos-qfe-query-range Deployment: Network IO","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Network utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":0,"y":33},"id":240,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_cpu_usage_seconds_total:labeled{\n      deployment=\"thanos-query-frontend\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"thanos-query-frontend Deployment: CPU","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":33},"id":241,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  container_memory_working_set_bytes:labeled{\n    deployment=\"thanos-query-frontend\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n  }\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"thanos-query-frontend Deployment: Memory","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Network utilization","fill":0,"gridPos":{"h":8,"w":8,"x":16,"y":33},"id":242,"legend":{"alignAsTable":false,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/receive .*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_network_transmit_bytes_total:labeled{\n      deployment=\"thanos-query-frontend\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"send {{ cluster }}","refId":"A"},{"expr":"sum by(cluster) (\n  rate(\n    container_network_receive_bytes_total:labeled{\n      deployment=\"thanos-query-frontend\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"receive {{ cluster }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"thanos-query-frontend Deployment: Network IO","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Network utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":0,"y":41},"id":243,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_cpu_usage_seconds_total:labeled{\n      deployment=\"thanos-store\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"thanos-store Deployment: CPU","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"","fill":0,"gridPos":{"h":8,"w":8,"x":8,"y":41},"id":244,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  container_memory_working_set_bytes:labeled{\n    deployment=\"thanos-store\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n  }\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"thanos-store Deployment: Memory","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Network utilization","fill":0,"gridPos":{"h":8,"w":8,"x":16,"y":41},"id":245,"legend":{"alignAsTable":false,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":false},"lines":true,"linewidth":1,"links":[{"title":"‚ò∏Ô∏è monitoring Kubernetes Deployment Detail","url":"/d/monitoring-kube-deployments?${__url_time_range}\u0026${__all_variables}"},{"title":"‚ò∏Ô∏è monitoring Kubernetes Container Detail","url":"/d/monitoring-kube-containers?${__url_time_range}\u0026${__all_variables}"}],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/receive .*/","transform":"negative-Y"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by(cluster) (\n  rate(\n    container_network_transmit_bytes_total:labeled{\n      deployment=\"thanos-store\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"send {{ cluster }}","refId":"A"},{"expr":"sum by(cluster) (\n  rate(\n    container_network_receive_bytes_total:labeled{\n      deployment=\"thanos-store\",env=\"$environment\",environment=\"$environment\",type=\"monitoring\"\n    }[$__rate_interval]\n  )\n)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"receive {{ cluster }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"thanos-store Deployment: Network IO","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":"Network utilization","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Ratio of requested CPU resources from allocatable resources.\nIdeally we have requests utilization close to 100%. Values are\nbelow 100% typically because pods do not fit well on nodes or\nbecause we might be bound by memory requests already.\n","fill":0,"gridPos":{"h":8,"w":12,"x":0,"y":49},"id":246,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (node) (\n  kube_pod_container_resource_requests_cpu_cores\n)\n/ on (node) group_left()\nkube_node_status_allocatable:labeled{env=\"$environment\",environment=\"$environment\",type=\"monitoring\",resource=\"cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ node }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Node CPU Requests Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":0,"description":"Ratio of requested Memory resources from allocatable resources.\nIdeally we have requests utilization close to 100%. Values are\nbelow 100% typically because pods do not fit well on nodes or\nbecause we might be bound by CPU requests already.\n","fill":0,"gridPos":{"h":8,"w":12,"x":12,"y":49},"id":247,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum by (node) (\n  kube_pod_container_resource_requests_memory_bytes\n)\n/ on (node) group_left()\nkube_node_status_allocatable:labeled{env=\"$environment\",environment=\"$environment\",type=\"monitoring\",resource=\"memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ node }}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Node Memory Requests Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"","logBase":1,"max":null,"min":0,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"‚ò∏Ô∏è Kubernetes Overview","titleSize":"h6","type":"row"},{"collapse":true,"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":500},"id":248,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"This resource measures average CPU utilization across an all cores in a service fleet.\nIf it is becoming saturated, it may indicate that the fleet needs\nhorizontal or vertical scaling.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":0},"id":1465724101,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-cpu","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage) (\n  clamp_min(\n    clamp_max(\n      1 - avg by (environment, tier, type, stage) (\n        rate(node_cpu_seconds_total{mode=\"idle\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[5m])\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ type }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"cpu\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"cpu component saturation: Average Service CPU Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Disk inode utilization per device per node.\n\nIf this is too high, its possible that a directory is filling up with\nfiles. Consider logging in an checking temp directories for large numbers\nof files\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":0},"id":39965907,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-disk_inodes","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, fqdn, device) (\n  clamp_min(\n    clamp_max(\n      1 - (\n        node_filesystem_files_free{fstype=~\"(ext.|xfs)\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n        /\n        node_filesystem_files{fstype=~\"(ext.|xfs)\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }} {{ device }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"disk_inodes\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"disk_inodes\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"disk_inodes\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"disk_inodes\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"disk_inodes\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"disk_inodes component saturation: Disk inode Utilization per Device per Node","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Disk space utilization per device per node.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":10},"id":2661375984,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-disk_space","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, fqdn, device) (\n  clamp_min(\n    clamp_max(\n      (\n        1 - instance:node_filesystem_avail:ratio{fstype=~\"ext.|xfs\", fqdn!=\"\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }} {{ device }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"disk_space\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"disk_space\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"disk_space\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"disk_space\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"disk_space\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"disk_space component saturation: Disk Space Utilization per Device per Node","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"GCP Quota utilization / limit ratio\n\nSaturation on a quota may cause problems with creating infrastructure resources on GCP.\n\nTo fix, we can request a quota increase for the specific resource to the GCP support team.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":10},"id":2585628061,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-gcp_quota_limit","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, metric, region) (\n  clamp_min(\n    clamp_max(\n      (\n        gcp_quota_usage{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      /\n        gcp_quota_limit{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ metric }} {{ region }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"gcp_quota_limit\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"gcp_quota_limit\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"gcp_quota_limit\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"gcp_quota_limit\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"gcp_quota_limit\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"gcp_quota_limit component saturation: GCP Quota utilization per environment","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Go's memory allocation strategy can make it look like a Go process is saturating memory when measured using RSS, when in fact\nthe process is not at risk of memory saturation. For this reason, we measure Go processes using the `go_memstat_alloc_bytes`\nmetric instead of RSS.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":20},"id":3631721613,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-go_memory","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, fqdn) (\n  clamp_min(\n    clamp_max(\n      sum by (environment, tier, type, stage, fqdn) (\n        go_memstats_alloc_bytes{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      /\n      sum by (environment, tier, type, stage, fqdn) (\n        node_memory_MemTotal_bytes{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"go_memory\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"go_memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"go_memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"go_memory\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"go_memory\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"go_memory component saturation: Go Memory Utilization per Node","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Kubernetes containers are allocated a share of CPU. When this is exhausted, the container may be thottled.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":20},"id":2713861591,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-kube_container_cpu","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, pod, container) (\n  clamp_min(\n    clamp_max(\n      sum by (environment, tier, type, stage, pod, container) (\n        rate(container_cpu_usage_seconds_total:labeled{container!=\"\", container!=\"POD\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[5m])\n      )\n      /\n      sum by(environment, tier, type, stage, pod, container) (\n        container_spec_cpu_quota:labeled{container!=\"\", container!=\"POD\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n        /\n        container_spec_cpu_period:labeled{container!=\"\", container!=\"POD\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ pod }} {{ container }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_container_cpu\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_container_cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_container_cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"kube_container_cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"kube_container_cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"kube_container_cpu component saturation: Kube Container CPU Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Records the total memory utilization for containers for this service, as a percentage of\nthe memory limit as configured through Kubernetes.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":30},"id":172578411,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-kube_container_memory","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, pod, container) (\n  clamp_min(\n    clamp_max(\n      container_memory_working_set_bytes:labeled{container!=\"\", container!=\"POD\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      /\n      (container_spec_memory_limit_bytes:labeled{container!=\"\", container!=\"POD\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"} \u003e 0)\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ pod }} {{ container }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_container_memory\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_container_memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_container_memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"kube_container_memory\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"kube_container_memory\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"kube_container_memory component saturation: Kube Container Memory Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Measures Go memory usage as a percentage of container memory limit\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":30},"id":4163523952,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-kube_go_memory","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, cluster, pod) (\n  clamp_min(\n    clamp_max(\n      (\n        go_memstats_alloc_bytes{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n        / on(environment, tier, type, stage, cluster, pod) group_left()\n        topk by(environment, tier, type, stage, cluster, pod) (1,\n          container_spec_memory_limit_bytes:labeled{container=~\"gitlab-workhorse|kas|registry|thanos-store\",env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n        )\n      )\n      or\n      (\n        go_memstats_alloc_bytes{type=\"monitoring\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n        / on(environment, tier, type, cluster, pod) group_left()\n        topk by (environment, tier, type, cluster, pod) (1,\n          container_spec_memory_limit_bytes:labeled{type=\"monitoring\", container=~\"gitlab-workhorse|kas|registry|thanos-store\"}\n        )\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }} {{ pod }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_go_memory\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_go_memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_go_memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"kube_go_memory\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"kube_go_memory\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"kube_go_memory component saturation: Go Memory Utilization per Node","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"The HPA is the [Horizontal Pod Autoscaler](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/).\nIt automatically scales the number of Pods in a deployment based on metrics.\n\nThe HPA has a configured upper maximum. When this limit is reached, the HPA will not increase the number of pods and\nother resource saturation (eg, CPU, memory) may occur.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":40},"id":3178132663,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-kube_hpa_desired_replicas","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, hpa, shard) (\n  clamp_min(\n    clamp_max(\n      kube_hpa_status_desired_replicas:labeled{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", shard!~\"database-throttled|elasticsearch|gitaly-throttled|imports|memory-bound|urgent-other\"}\n      /\n      kube_hpa_spec_max_replicas:labeled{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", shard!~\"database-throttled|elasticsearch|gitaly-throttled|imports|memory-bound|urgent-other\"}\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ hpa }} {{ shard }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_hpa_desired_replicas\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_hpa_desired_replicas\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_hpa_desired_replicas\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"kube_hpa_desired_replicas\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"kube_hpa_desired_replicas\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"kube_hpa_desired_replicas component saturation: HPA Desired Replicas","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"A GKE kubernetes node pool is close to it's maximum number of nodes.\n\nThe maximum is defined in terraform, via the `max_node_count` field of a node pool. The limit is per-zone, so for\nsingle zone clusters the number of nodes will match the limit, for regional clusters, the limit is multiplied by\nthe number of zones the cluster is deployed over.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":40},"id":1686893332,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-kube_pool_max_nodes","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(env, environment, tier, type, stage, cluster, label_pool, shard) (\n  clamp_min(\n    clamp_max(\n      count by (cluster, env, environment, label_pool, tier, type, stage, shard) (\n        kube_node_labels:labeled{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      / on(cluster, env, environment, label_pool) group_left() (\n        label_replace(\n          terraform_report_google_cluster_node_pool_max_node_count,\n          \"label_pool\", \"$0\", \"pool_name\", \".*\"\n        )\n        * on(cluster, env, environment) group_left()\n        count by (cluster, env, environment) (\n          group by (cluster, env, environment, label_topology_kubernetes_io_zone) (\n            kube_node_labels:labeled{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n          )\n        )\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ cluster }} {{ label_pool }} {{ shard }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_pool_max_nodes\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_pool_max_nodes\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"kube_pool_max_nodes\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"kube_pool_max_nodes\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"kube_pool_max_nodes\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"kube_pool_max_nodes component saturation: Kube Pool Max Node Limit","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Memory utilization per device per node.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":50},"id":1955556769,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-memory","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, fqdn) (\n  clamp_min(\n    clamp_max(\n      instance:node_memory_utilization:ratio{fqdn!=\"\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"memory\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"memory\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"memory\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"memory\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"memory component saturation: Memory Utilization per Node","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Netfilter connection tracking table utilization per node.\n\nWhen saturated, new connection attempts (incoming SYN packets) are dropped with no reply, leaving clients to slowly retry (and typically fail again) over the next several seconds.  When packets are being dropped due to this condition, kernel will log the event as: \"nf_conntrack: table full, dropping packet\".\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":50},"id":503581002,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-nf_conntrack_entries","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, fqdn, instance) (\n  clamp_min(\n    clamp_max(\n      max_over_time(node_nf_conntrack_entries{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[1m])\n      /\n      node_nf_conntrack_entries_limit{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }} {{ instance }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"nf_conntrack_entries\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"nf_conntrack_entries\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"nf_conntrack_entries\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"nf_conntrack_entries\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"nf_conntrack_entries\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"nf_conntrack_entries component saturation: conntrack Entries per Node","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Measures the amount of scheduler waiting time that processes are waiting\nto be scheduled, according to [`CPU Scheduling Metrics`](https://www.robustperception.io/cpu-scheduling-metrics-from-the-node-exporter).\n\nA high value indicates that a node has more processes to be run than CPU time available\nto handle them, and may lead to degraded responsiveness and performance from the application.\n\nAdditionally, it may indicate that the fleet is under-provisioned.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":60},"id":1415313189,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-node_schedstat_waiting","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, fqdn, shard) (\n  clamp_min(\n    clamp_max(\n      avg without (cpu) (rate(node_schedstat_waiting_seconds_total{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[1h]))\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }} {{ shard }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"node_schedstat_waiting\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"node_schedstat_waiting\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"node_schedstat_waiting\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"node_schedstat_waiting\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"node_schedstat_waiting\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"node_schedstat_waiting component saturation: Node Scheduler Waiting Time","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Open file descriptor utilization per instance.\n\nSaturation on file descriptor limits may indicate a resource-descriptor leak in the application.\n\nAs a temporary fix, you may want to consider restarting the affected process.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":60},"id":1001792825,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-open_fds","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, job, instance) (\n  clamp_min(\n    clamp_max(\n      (\n        process_open_fds{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n        /\n        process_max_fds{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      or\n      (\n        ruby_file_descriptors{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n        /\n        ruby_process_max_fds{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ job }} {{ instance }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"open_fds\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"open_fds\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"open_fds\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"open_fds\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"open_fds\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"open_fds component saturation: Open file descriptor utilization per instance","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Average CPU utilization.\n\nSee https://cloud.google.com/monitoring/api/metrics_gcp#gcp-cloudsql for\nmore details\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":70},"id":3679713436,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-praefect_cloudsql_cpu","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, database_id) (\n  clamp_min(\n    clamp_max(\n      avg_over_time(stackdriver_cloudsql_database_cloudsql_googleapis_com_database_cpu_utilization{database_id=~\".+:praefect-db.+\", env=\"$environment\",environment=\"$environment\"}[5m])\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ database_id }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"praefect_cloudsql_cpu\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"praefect_cloudsql_cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"praefect_cloudsql_cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"praefect_cloudsql_cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"praefect_cloudsql_cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"praefect_cloudsql_cpu component saturation: Average CPU Utilization","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"This resource measures average CPU utilization across an all cores in a shard of a\nservice fleet. If it is becoming saturated, it may indicate that the\nshard needs horizontal or vertical scaling.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":12,"y":70},"id":1472933476,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-shard_cpu","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, shard) (\n  clamp_min(\n    clamp_max(\n      1 - avg by (environment, tier, type, stage, shard) (\n        rate(node_cpu_seconds_total{mode=\"idle\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[5m])\n      )\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ shard }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"shard_cpu\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"shard_cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"shard_cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"shard_cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"shard_cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"shard_cpu component saturation: Average CPU Utilization per Shard","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"Average CPU utilization per Node.\n\nIf average CPU is satured, it may indicate that a fleet is in need to horizontal or vertical scaling. It may also indicate\nimbalances in load in a fleet.\n Lower is better.","fill":0,"gridPos":{"h":10,"w":12,"x":0,"y":80},"id":3372411356,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/^Soft SLO/","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^Hard SLO/","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{"alias":"/aggregated /","color":"#E7D551","linewidth":2,"zindex":3},{"alias":"/^95th quantile for week/","color":"#37872D","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":1,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"/^99th quantile for week/","color":"#56A64B","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":4,"zindex":-2}],"spaceLength":10,"stableId":"saturation-single_node_cpu","stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(\n  clamp_max(\n    max by(environment, tier, type, stage, fqdn) (\n  clamp_min(\n    clamp_max(\n      avg without(cpu, mode) (1 - rate(node_cpu_seconds_total{fqdn!=\"\", mode=\"idle\", env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\"}[5m]))\n      ,\n      1)\n  ,\n  0)\n)\n\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"{{ fqdn }}","refId":"A"},{"expr":"clamp_min(\n  clamp_max(\n    max(\n      max_over_time(gitlab_component_saturation:ratio{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"single_node_cpu\"}[$__interval])\n    ) by (component)\n  ,1)\n,0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"aggregated {{ component }}","refId":"B"},{"expr":"gitlab_component_saturation:ratio_quantile95_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"single_node_cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"95th quantile for week {{ component }}","refId":"C"},{"expr":"gitlab_component_saturation:ratio_quantile99_1w{env=\"$environment\",environment=\"$environment\",stage=\"$stage\",type=\"monitoring\", component=\"single_node_cpu\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"99th quantile for week {{ component }}","refId":"D"},{"expr":"avg(slo:max:soft:gitlab_component_saturation:ratio{component=\"single_node_cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Soft SLO: {{ component }}","refId":"E"},{"expr":"avg(slo:max:hard:gitlab_component_saturation:ratio{component=\"single_node_cpu\"}) by (component)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Hard SLO: {{ component }}","refId":"F"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"single_node_cpu component saturation: Average CPU Utilization per Node","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üå° Saturation Details","titleSize":"h6","type":"row"},{"collapse":false,"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":1000},"id":266,"panels":[],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"Grafana Latencies","titleSize":"h6","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":2,"description":"","fill":0,"gridPos":{"h":10,"w":24,"x":0,"y":1001},"id":267,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":false,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"grafana_api_dataproxy_request_all_milliseconds{environment=\"ops\", quantile=\"0.5\"}\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p50 {{ fqdn }}","refId":"A"},{"expr":"grafana_api_dataproxy_request_all_milliseconds{environment=\"ops\", quantile=\"0.9\"}\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p90 {{ fqdn }}","refId":"B"},{"expr":"grafana_api_dataproxy_request_all_milliseconds{environment=\"ops\", quantile=\"0.99\"}\n","format":"time_series","interval":"1m","intervalFactor":2,"legendFormat":"p99 {{ fqdn }}","refId":"C"}],"thresholds":[{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.25)","line":false,"op":"gt","value":10000,"yaxis":"left"},{"colorMode":"custom","fill":true,"fillColor":"rgba(242, 73, 92, 0.5)","line":false,"op":"gt","value":30000,"yaxis":"left"}],"timeFrom":null,"timeShift":null,"title":"Grafana API Dataproxy (logn scale)","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":"Duration","logBase":10,"max":null,"min":10,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"collapse":true,"collapsed":true,"gridPos":{"x":0,"y":100010},"id":268,"panels":[{"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"composites":[],"content":"graph TD\n  subgraph inf\n  monitoring\nend\n\n\n  \n","datasource":"$PROMETHEUS_DS","decimals":3,"format":"percentunit","graphId":"diagram_errors","gridPos":{"h":10,"w":24,"x":0,"y":0},"id":269,"init":{"arrowMarkerAbsolute":true,"cloneCssStyles":true,"flowchart":{"htmlLabels":true,"useMaxWidth":true},"gantt":{"barGap":4,"barHeight":20,"fontFamily":"\"Open-Sans\", \"sans-serif\"","fontSize":11,"gridLineStartPadding":35,"leftPadding":75,"numberSectionStyles":3,"titleTopMargin":25,"topPadding":50},"logLevel":3,"sequenceDiagram":{"actorMargin":50,"bottomMarginAdj":1,"boxMargin":10,"boxTextMargin":5,"diagramMarginX":50,"diagramMarginY":10,"height":65,"messageMargin":35,"mirrorActors":true,"noteMargin":10,"useMaxWidth":true,"width":150},"startOnLoad":false},"interval":"","legend":{"avg":true,"current":true,"gradient":{"enabled":true,"show":true},"max":true,"min":true,"show":false,"total":true},"mappingType":1,"mappingTypes":[],"maxDataPoints":100,"maxWidth":false,"mermaidServiceUrl":"","metricCharacterReplacements":[],"moddedSeriesVal":0,"mode":"content","nullPointMode":"connected","options":{},"seriesOverrides":[],"style":"","targets":[{"expr":"clamp_max(\n  max_over_time(gitlab_service_errors:ratio_5m{environment=\"$environment\",monitor=\"global\",stage=\"$stage\"}[$__range])\n,\n  1\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"{{ type }}"}],"thresholds":"0,0.001","title":"System Diagram (Keyed by Error Rates)","type":"jdbranham-diagram-panel","valueMaps":[],"valueName":"current","valueOptions":["avg","min","max","total","current"]},{"colors":["rgba(245, 54, 54, 0.9)","#FF9830","#73BF69"],"composites":[],"content":"graph TD\n  subgraph inf\n  monitoring\nend\n\n\n  \n","datasource":"$PROMETHEUS_DS","decimals":3,"format":"percentunit","graphId":"diagram_apdex","gridPos":{"h":10,"w":24,"x":0,"y":10},"id":270,"init":{"arrowMarkerAbsolute":true,"cloneCssStyles":true,"flowchart":{"htmlLabels":true,"useMaxWidth":true},"gantt":{"barGap":4,"barHeight":20,"fontFamily":"\"Open-Sans\", \"sans-serif\"","fontSize":11,"gridLineStartPadding":35,"leftPadding":75,"numberSectionStyles":3,"titleTopMargin":25,"topPadding":50},"logLevel":3,"sequenceDiagram":{"actorMargin":50,"bottomMarginAdj":1,"boxMargin":10,"boxTextMargin":5,"diagramMarginX":50,"diagramMarginY":10,"height":65,"messageMargin":35,"mirrorActors":true,"noteMargin":10,"useMaxWidth":true,"width":150},"startOnLoad":false},"interval":"","legend":{"avg":true,"current":true,"gradient":{"enabled":true,"show":true},"max":true,"min":true,"show":false,"total":true},"mappingType":1,"mappingTypes":[],"maxDataPoints":100,"maxWidth":false,"mermaidServiceUrl":"","metricCharacterReplacements":[],"moddedSeriesVal":0,"mode":"content","nullPointMode":"connected","options":{},"seriesOverrides":[],"style":"","targets":[{"expr":"min_over_time(gitlab_service_apdex:ratio_5m{environment=\"$environment\",monitor=\"global\",stage=\"$stage\"}[$__range])\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"{{ type }}"}],"thresholds":"0.99,0.995,0.999","title":"System Diagram (Keyed by Apdex/Latency Scores)","type":"jdbranham-diagram-panel","valueMaps":[],"valueName":"current","valueOptions":["avg","min","max","total","current"]},{"colors":[],"composites":[],"content":"graph TD\n  subgraph inf\n  monitoring[\"monitoring (Level 3)\"]\nend\n\n\n  \n","datasource":"$PROMETHEUS_DS","decimals":3,"format":"percentunit","graphId":"diagram_maturity","gridPos":{"h":10,"w":24,"x":0,"y":20},"id":271,"init":{"arrowMarkerAbsolute":true,"cloneCssStyles":true,"flowchart":{"htmlLabels":true,"useMaxWidth":true},"gantt":{"barGap":4,"barHeight":20,"fontFamily":"\"Open-Sans\", \"sans-serif\"","fontSize":11,"gridLineStartPadding":35,"leftPadding":75,"numberSectionStyles":3,"titleTopMargin":25,"topPadding":50},"logLevel":3,"sequenceDiagram":{"actorMargin":50,"bottomMarginAdj":1,"boxMargin":10,"boxTextMargin":5,"diagramMarginX":50,"diagramMarginY":10,"height":65,"messageMargin":35,"mirrorActors":true,"noteMargin":10,"useMaxWidth":true,"width":150},"startOnLoad":false},"interval":"","legend":{"avg":true,"current":true,"gradient":{"enabled":true,"show":true},"max":true,"min":true,"show":false,"total":true},"mappingType":1,"mappingTypes":[],"maxDataPoints":100,"maxWidth":false,"mermaidServiceUrl":"","metricCharacterReplacements":[],"moddedSeriesVal":0,"mode":"content","nullPointMode":"connected","options":{},"seriesOverrides":[],"style":"","targets":[],"thresholds":"","title":"System Diagram (Keyed by Maturity Model)","type":"jdbranham-diagram-panel","valueMaps":[],"valueName":"current","valueOptions":["avg","min","max","total","current"]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":true,"title":"üó∫Ô∏è System Diagrams","titleSize":"h6","type":"row"},{"content":"Made with ‚ù§Ô∏è and [Grafonnet](https://github.com/grafana/grafonnet-lib). [Contribute to this dashboard on GitLab.com](https://gitlab.com/gitlab-com/runbooks/blob/master/dashboards)\n","datasource":null,"gridPos":{"h":2,"w":24,"x":0,"y":110000},"id":272,"mode":"markdown","title":"Source","type":"text"}],"refresh":"","rows":[],"schemaVersion":16,"style":"light","tags":["managed","monitoring","type:monitoring","monitoring","service overview"],"templating":{"list":[{"current":{"text":"Global","value":"Global"},"hide":0,"label":null,"name":"PROMETHEUS_DS","options":[],"query":"prometheus","refresh":1,"regex":"","type":"datasource"},{"allValue":null,"current":{"text":"gprd","value":"gprd"},"datasource":"$PROMETHEUS_DS","hide":0,"includeAll":false,"label":null,"multi":false,"name":"environment","options":[],"query":"label_values(gitlab_service_ops:rate, environment)","refresh":1,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"main","value":"main"},"hide":0,"includeAll":false,"label":"","multi":false,"name":"stage","options":[{"text":"main","value":"main"},{"text":"cny","value":"cny"},{"text":"","value":""}],"query":"main,cny,","refresh":0,"type":"custom"}]},"time":{"from":"now-6h/m","to":"now/m"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"utc","title":"monitoring: Overview","uid":"monitoring-main","version":2010}}