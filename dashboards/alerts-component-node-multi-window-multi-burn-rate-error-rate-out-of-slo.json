{"meta":{"type":"db","canSave":false,"canEdit":true,"canAdmin":false,"canStar":true,"slug":"alerts-component-node-multi-window-multi-burn-rate-error-rate-out-of-slo","url":"/d/alerts-component_node_multiburn_error/alerts-component-node-multi-window-multi-burn-rate-error-rate-out-of-slo","expires":"0001-01-01T00:00:00Z","created":"2020-07-27T12:28:20Z","updated":"2020-11-24T14:48:01Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":345,"hasAcl":false,"isFolder":false,"folderId":1107,"folderTitle":"Alerts","folderUrl":"/dashboards/f/alerts/alerts","provisioned":false,"provisionedExternalId":""},"dashboard":{"__inputs":[],"__requires":[],"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":false,"iconColor":"#96D98D","name":"deploy","showIn":0,"tags":["deploy","$environment"],"type":"tags"},{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":false,"iconColor":"#FFEE52","name":"canary-deploy","showIn":0,"tags":["deploy","${environment}-cny"],"type":"tags"},{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":false,"iconColor":"#CA95E5","name":"feature-flags","showIn":0,"tags":["feature-flag","${environment}"],"type":"tags"}]},"description":"Uploaded by https://gitlab.com/gitlab-com/runbooks/-/jobs/869636737 at Tue Nov 24 14:47:59 UTC 2020","editable":false,"gnetId":null,"graphTooltip":1,"hideControls":false,"id":null,"links":[{"asDropdown":true,"icon":"external link","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"Platform Triage","type":"link","url":"https://dashboards.gitlab.net/d/general-triage/platform-triage?orgId=1"},{"asDropdown":true,"icon":"external link","includeVars":false,"keepTime":true,"tags":"","targetBlank":false,"title":"Capacity Planning","type":"link","url":"https://dashboards.gitlab.net/d/general-capacity-planning/general-capacity-planning?orgId=1"}],"panels":[{"gridPos":{"h":6,"w":6,"x":0,"y":0},"id":2,"links":[],"options":{"colorMode":"background","fieldOptions":{"calcs":["lastNotNull"],"defaults":{"links":[],"mappings":[{"from":"0","id":0,"op":"=","text":"Healthy","to":"0","type":2,"value":"0"},{"from":"1","id":1,"op":"=","text":"Warning 🔥","to":"1","type":2,"value":"1"},{"from":"2","id":2,"op":"=","text":"Warning 🔥","to":"2","type":2,"value":"2"},{"from":"3","id":3,"op":"=","text":"Degraded 🔥","to":"3","type":2,"value":"3"},{"from":"4","id":4,"op":"=","text":"Warning 🥵","to":"4","type":2,"value":"4"},{"from":"5","id":5,"op":"=","text":"Warning 🔥🥵","to":"5","type":2,"value":"5"},{"from":"6","id":6,"op":"=","text":"Warning 🔥🥵","to":"6","type":2,"value":"6"},{"from":"7","id":7,"op":"=","text":"Degraded 🔥🥵","to":"7","type":2,"value":"7"},{"from":"8","id":8,"op":"=","text":"Warning 🥵","to":"8","type":2,"value":"8"},{"from":"9","id":9,"op":"=","text":"Warning 🔥🥵","to":"9","type":2,"value":"9"},{"from":"10","id":10,"op":"=","text":"Warning 🔥🥵","to":"10","type":2,"value":"10"},{"from":"11","id":11,"op":"=","text":"Degraded 🔥🥵","to":"11","type":2,"value":"11"},{"from":"12","id":12,"op":"=","text":"Degraded 🥵","to":"12","type":2,"value":"12"},{"from":"13","id":13,"op":"=","text":"Degraded 🔥🥵","to":"13","type":2,"value":"13"},{"from":"14","id":14,"op":"=","text":"Degraded 🔥🥵","to":"14","type":2,"value":"14"},{"from":"15","id":15,"op":"=","text":"Degraded 🔥🥵","to":"15","type":2,"value":"15"}],"nullValueMode":"connected","thresholds":{"mode":"absolute","steps":[{"color":"black","value":0},{"color":"orange","value":1},{"color":"orange","value":2},{"color":"red","value":3},{"color":"orange","value":4},{"color":"orange","value":5},{"color":"orange","value":6},{"color":"red","value":7},{"color":"orange","value":8},{"color":"orange","value":9},{"color":"orange","value":10},{"color":"red","value":11},{"color":"red","value":12},{"color":"red","value":13},{"color":"red","value":14},{"color":"red","value":15}]},"title":"Status","unit":"none"},"overrides":[],"values":false},"graphMode":"none","justifyMode":"auto","orientation":"vertical"},"pluginVersion":"6.6.1","targets":[{"expr":"sum (\n  label_replace(\n    vector(0) and on() (gitlab_component_node_errors:ratio_1h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor=\"global\",stage=\"$stage\",type=\"$type\"}),\n    \"period\", \"na\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(1) and on() (gitlab_component_node_errors:ratio_5m{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor=\"global\",stage=\"$stage\",type=\"$type\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"$type\"})),\n    \"period\", \"5m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(2) and on() (gitlab_component_node_errors:ratio_1h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor=\"global\",stage=\"$stage\",type=\"$type\"} \u003e on(tier, type) group_left() (14.4 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"$type\"})),\n    \"period\", \"1h\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(4) and on() (gitlab_component_node_errors:ratio_30m{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor=\"global\",stage=\"$stage\",type=\"$type\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"$type\"})),\n    \"period\", \"30m\", \"\", \"\"\n  )\n  or\n  label_replace(\n    vector(8) and on() (gitlab_component_node_errors:ratio_6h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor=\"global\",stage=\"$stage\",type=\"$type\"} \u003e on(tier, type) group_left() (6 * slo:max:events:gitlab_service_errors:ratio{monitor=\"global\",type=\"$type\"})),\n    \"period\", \"6h\", \"\", \"\"\n  )\n)\n","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"$component/$fqdn | Errors"}],"title":"","type":"stat"},{"datasource":"$PROMETHEUS_DS","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{},"decimals":2,"displayName":null,"links":[],"mappings":[],"max":1,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"red","value":0},{"color":"light-red","value":0.95},{"color":"orange","value":0.99},{"color":"light-orange","value":0.995},{"color":"yellow","value":0.9994},{"color":"light-yellow","value":0.9995},{"color":"green","value":0.9998}]},"unit":"percentunit"},"overrides":[]},"gridPos":{"h":6,"w":6,"x":6,"y":0},"id":3,"options":{"colorMode":"background","graphMode":"none","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["last"],"fields":"","values":true}},"pluginVersion":"7.0.3","targets":[{"expr":"1 - avg(slo:max:events:gitlab_service_errors:ratio{type=\"$type\"}) by (type)","format":"time_series","instant":true,"interval":"1m","intervalFactor":3,"legendFormat":"{{ type }} service monitoring SLO"}],"title":"","type":"stat"},{"content":"The SLO for this service will determine the thresholds (indicated by the dotted lines)\nin the following graphs. Over time, we expect these SLOs to become stricter (more nines) by\nimproving the reliability of our service.\n\n**For more details of this technique, be sure to the Alerting on SLOs chapter of the\n[Google SRE Workbook](https://landing.google.com/sre/workbook/chapters/alerting-on-slos/)**\n","datasource":null,"gridPos":{"h":6,"w":12,"x":12,"y":0},"id":4,"mode":"markdown","title":"Help","type":"text"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":4,"description":"apdex burn rates: higher is better","fill":0,"gridPos":{"h":10,"w":18,"x":0,"y":100},"id":64104,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"6h apdex burn rate","color":"#5794F2","fillBelowTo":"30m apdex burn rate","linewidth":4,"zindex":0},{"alias":"1h apdex burn rate","color":"#73BF69","fillBelowTo":"5m apdex burn rate","linewidth":4,"zindex":1},{"alias":"30m apdex burn rate","color":"#5794F2","linewidth":2,"zindex":2},{"alias":"5m apdex burn rate","color":"#73BF69","linewidth":2,"zindex":3},{"alias":"6h apdex burn threshold","color":"#5794F2","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-1},{"alias":"1h apdex burn threshold","color":"#73BF69","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(gitlab_component_node_errors:ratio_1h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"1h apdex burn rate","refId":"A"},{"expr":"gitlab_component_node_errors:ratio_5m{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"5m apdex burn rate","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{type=\"$type\"})) unless (vector($proposed_slo) \u003e 0)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"1h apdex burn threshold","refId":"C"},{"expr":"14.4 * (1 - $proposed_slo)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Proposed SLO @ 1h burn","refId":"D"},{"expr":"gitlab_component_node_errors:ratio_6h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"6h apdex burn rate","refId":"E"},{"expr":"gitlab_component_node_errors:ratio_30m{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"30m apdex burn rate","refId":"F"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{type=\"$type\"})) unless (vector($proposed_slo) \u003e 0)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"6h apdex burn threshold","refId":"G"},{"expr":"6 * (1 - $proposed_slo)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Proposed SLO @ 6h burn","refId":"H"}],"thresholds":null,"timeFrom":null,"timeShift":null,"title":"Multi-window, multi-burn-rates","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"content":"# Multi-window, multi-burn-rates\n\nThe alert will fire when both of the green solid series cross the green dotted threshold, or\nboth of the blue solid series cross the blue dotted threshold.\n","datasource":null,"gridPos":{"h":10,"w":6,"x":18,"y":100},"id":6,"mode":"markdown","title":"Help","type":"text"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":4,"description":"apdex burn rates: higher is better","fill":0,"gridPos":{"h":10,"w":18,"x":0,"y":110},"id":7,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"6h apdex burn rate","color":"#5794F2","fillBelowTo":"30m apdex burn rate","linewidth":4,"zindex":0},{"alias":"1h apdex burn rate","color":"#73BF69","fillBelowTo":"5m apdex burn rate","linewidth":4,"zindex":1},{"alias":"30m apdex burn rate","color":"#5794F2","linewidth":2,"zindex":2},{"alias":"5m apdex burn rate","color":"#73BF69","linewidth":2,"zindex":3},{"alias":"6h apdex burn threshold","color":"#5794F2","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-1},{"alias":"1h apdex burn threshold","color":"#73BF69","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(gitlab_component_node_errors:ratio_1h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"1h apdex burn rate","refId":"A"},{"expr":"gitlab_component_node_errors:ratio_5m{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"5m apdex burn rate","refId":"B"},{"expr":"(14.4 * avg(slo:max:events:gitlab_service_errors:ratio{type=\"$type\"})) unless (vector($proposed_slo) \u003e 0)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"1h apdex burn threshold","refId":"C"},{"expr":"14.4 * (1 - $proposed_slo)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Proposed SLO @ 1h burn","refId":"D"}],"thresholds":null,"timeFrom":null,"timeShift":null,"title":"Single window, 1h/5m burn-rates","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"content":"# Single window, 1h/5m burn-rates\n\nRemoving the 6h/30m burn-rates, this shows the same data over the 1h/5m burn-rates.\n\nThe alert will fire when the solid lines cross the dotted threshold.\n","datasource":null,"gridPos":{"h":10,"w":6,"x":18,"y":110},"id":8,"mode":"markdown","title":"Help","type":"text"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":4,"description":"apdex burn rates: higher is better","fill":0,"gridPos":{"h":10,"w":18,"x":0,"y":120},"id":9,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"6h apdex burn rate","color":"#5794F2","fillBelowTo":"30m apdex burn rate","linewidth":4,"zindex":0},{"alias":"1h apdex burn rate","color":"#73BF69","fillBelowTo":"5m apdex burn rate","linewidth":4,"zindex":1},{"alias":"30m apdex burn rate","color":"#5794F2","linewidth":2,"zindex":2},{"alias":"5m apdex burn rate","color":"#73BF69","linewidth":2,"zindex":3},{"alias":"6h apdex burn threshold","color":"#5794F2","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-1},{"alias":"1h apdex burn threshold","color":"#73BF69","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(gitlab_component_node_errors:ratio_6h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"6h apdex burn rate","refId":"A"},{"expr":"gitlab_component_node_errors:ratio_30m{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"30m apdex burn rate","refId":"B"},{"expr":"(6 * avg(slo:max:events:gitlab_service_errors:ratio{type=\"$type\"})) unless (vector($proposed_slo) \u003e 0)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"6h apdex burn threshold","refId":"C"},{"expr":"6 * (1 - $proposed_slo)","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"Proposed SLO @ 6h burn","refId":"D"}],"thresholds":null,"timeFrom":null,"timeShift":null,"title":"Single window, 6h/30m burn-rates","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"content":"# Single window, 6h/30m burn-rates\n\nRemoving the 1h/5m burn-rates, this shows the same data over the 6h/30m burn-rates.\n\nThe alert will fire when the solid lines cross the dotted threshold.\n","datasource":null,"gridPos":{"h":10,"w":6,"x":18,"y":120},"id":10,"mode":"markdown","title":"Help","type":"text"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":4,"description":"apdex burn rates: higher is better","fill":0,"gridPos":{"h":10,"w":18,"x":0,"y":130},"id":11,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"6h apdex burn rate","color":"#5794F2","fillBelowTo":"30m apdex burn rate","linewidth":4,"zindex":0},{"alias":"1h apdex burn rate","color":"#73BF69","fillBelowTo":"5m apdex burn rate","linewidth":4,"zindex":1},{"alias":"30m apdex burn rate","color":"#5794F2","linewidth":2,"zindex":2},{"alias":"5m apdex burn rate","color":"#73BF69","linewidth":2,"zindex":3},{"alias":"6h apdex burn threshold","color":"#5794F2","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-1},{"alias":"1h apdex burn threshold","color":"#73BF69","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(gitlab_component_node_errors:ratio_1h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"1h apdex burn rate","refId":"A"},{"expr":"gitlab_component_node_errors:ratio_5m{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"5m apdex burn rate","refId":"B"}],"thresholds":null,"timeFrom":null,"timeShift":null,"title":"Single window, 1h/5m burn-rates, no thresholds","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"content":"# Single window, 1h/5m burn-rates, no thresholds\n\nSince the threshold can be relatively high, removing it can help visualise the current values better.\n","datasource":null,"gridPos":{"h":10,"w":6,"x":18,"y":130},"id":12,"mode":"markdown","title":"Help","type":"text"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"$PROMETHEUS_DS","decimals":4,"description":"apdex burn rates: higher is better","fill":0,"gridPos":{"h":10,"w":18,"x":0,"y":140},"id":13,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"sideWidth":null,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"6h apdex burn rate","color":"#5794F2","fillBelowTo":"30m apdex burn rate","linewidth":4,"zindex":0},{"alias":"1h apdex burn rate","color":"#73BF69","fillBelowTo":"5m apdex burn rate","linewidth":4,"zindex":1},{"alias":"30m apdex burn rate","color":"#5794F2","linewidth":2,"zindex":2},{"alias":"5m apdex burn rate","color":"#73BF69","linewidth":2,"zindex":3},{"alias":"6h apdex burn threshold","color":"#5794F2","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-1},{"alias":"1h apdex burn threshold","color":"#73BF69","dashLength":2,"dashes":true,"lines":true,"linewidth":2,"spaceLength":4,"zindex":-2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"clamp_min(clamp_max(gitlab_component_node_errors:ratio_6h{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n,1),0)\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"6h apdex burn rate","refId":"A"},{"expr":"gitlab_component_node_errors:ratio_30m{component=\"$component\",environment=\"$environment\",fqdn=\"$fqdn\",monitor!=\"global\",stage=\"$stage\",type=\"$type\"}\n","format":"time_series","interval":"1m","intervalFactor":3,"legendFormat":"30m apdex burn rate","refId":"B"}],"thresholds":null,"timeFrom":null,"timeShift":null,"title":"Single window, 6h/30m burn-rates, no thresholds","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percentunit","label":"Percent","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}]},{"content":"# Single window, 6h/30m burn-rates, no thresholds\n\nSince the threshold can be relatively high, removing it can help visualise the current values better.\n","datasource":null,"gridPos":{"h":10,"w":6,"x":18,"y":140},"id":14,"mode":"markdown","title":"Help","type":"text"},{"content":"Made with ❤️ and [Grafonnet](https://github.com/grafana/grafonnet-lib). [Contribute to this dashboard on GitLab.com](https://gitlab.com/gitlab-com/runbooks/blob/master/dashboards/./alerts/burn_rate_alerts.shared.jsonnet)\n","datasource":null,"gridPos":{"h":2,"w":24,"x":0,"y":110000},"id":15,"mode":"markdown","title":"Source","type":"text"}],"refresh":"","rows":[],"schemaVersion":16,"style":"light","tags":["managed","alerts","alert-target","general"],"templating":{"list":[{"current":{"text":"Prometheus","value":"Prometheus"},"hide":0,"label":null,"name":"PROMETHEUS_DS","options":[],"query":"prometheus","refresh":1,"regex":"/(.*-gprd|Global|gprd-.*)/","type":"datasource"},{"allValue":null,"current":{"text":"gprd","value":"gprd"},"datasource":"$PROMETHEUS_DS","hide":0,"includeAll":false,"label":null,"multi":false,"name":"environment","options":[],"query":"label_values(gitlab_service_ops:rate, environment)","refresh":1,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"web","value":"web"},"datasource":"$PROMETHEUS_DS","hide":0,"includeAll":false,"label":null,"multi":false,"name":"type","options":[],"query":"label_values(gitlab_service_ops:rate{environment=\"$environment\"}, type)","refresh":1,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"main","value":"main"},"hide":0,"includeAll":false,"label":"","multi":false,"name":"stage","options":[{"text":"main","value":"main"},{"text":"cny","value":"cny"},{"text":"","value":""}],"query":"main,cny,","refresh":0,"type":"custom"},{"allValue":null,"current":{"text":"NaN","value":"NaN"},"hide":0,"includeAll":false,"label":"","multi":false,"name":"proposed_slo","options":[{"text":"NaN","value":"NaN"},{"text":"0.9","value":"0.9"},{"text":"0.95","value":"0.95"},{"text":"0.99","value":"0.99"},{"text":"0.995","value":"0.995"},{"text":"0.999","value":"0.999"},{"text":"0.9995","value":"0.9995"},{"text":"0.9999","value":"0.9999"}],"query":"NaN,0.9,0.95,0.99,0.995,0.999,0.9995,0.9999","refresh":0,"type":"custom"},{"allValue":null,"current":{"text":"","value":""},"datasource":"$PROMETHEUS_DS","hide":0,"includeAll":false,"label":null,"multi":false,"name":"component","options":[],"query":"label_values(gitlab_component_ops:rate{environment=\"$environment\", type=\"$type\", stage=\"$stage\"}, component)","refresh":1,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"","value":""},"datasource":"$PROMETHEUS_DS","hide":0,"includeAll":false,"label":null,"multi":false,"name":"fqdn","options":[],"query":"label_values(gitlab_component_node_ops:rate_5m{component=\"$component\",environment=\"$environment\",stage=\"$stage\",type=\"$type\"}, fqdn)","refresh":1,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-6h/m","to":"now/m"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"utc","title":"alerts: Component/Node Multi-window Multi-burn-rate Error Rate Out of SLO","uid":"alerts-component_node_multiburn_error","version":345}}