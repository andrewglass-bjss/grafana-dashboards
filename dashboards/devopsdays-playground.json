{"meta":{"type":"db","canSave":false,"canEdit":false,"canAdmin":false,"canStar":true,"slug":"devopsdays-playground","url":"/d/xS5JPrKZz/devopsdays-playground","expires":"0001-01-01T00:00:00Z","created":"2019-09-02T21:32:17Z","updated":"2019-09-03T19:25:35Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":3,"hasAcl":false,"isFolder":false,"folderId":184,"folderTitle":".ONCE OFF","folderUrl":"/dashboards/f/kGgx9rIiz/once-off","provisioned":false,"provisionedExternalId":""},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"links":[],"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":20,"w":24,"x":0,"y":0},"id":2,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[{"alias":"/ component/","color":"#E7D551"},{"alias":"Soft SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":2,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Hard SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":true,"lines":true,"linewidth":4,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{},{"alias":"Out of SLO","color":"rgba(193, 23, 23, 0.53)","fill":10,"hideTooltip":true,"legend":false,"lines":true,"linewidth":0,"zindex":-3}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n      max(\n        max_over_time(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}[$__interval]\n        )\n      ) by (component)\n      ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ component }} component","refId":"A"},{"expr":"0.9 ","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"Soft SLO","refId":"B"},{"expr":"0.95","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"Hard SLO","refId":"C"},{"expr":"\n      max(\n        max_over_time(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}[$__interval]\n        )\n      ) by (component)\n       \u003e 0.9","format":"time_series","interval":"5m","intervalFactor":3,"legendFormat":"Out of SLO","refId":"D"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":20,"w":24,"x":0,"y":20},"id":3,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/ component/","color":"#E7D551"},{"alias":"Soft SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":false,"lines":true,"linewidth":6,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Hard SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":false,"lines":true,"linewidth":6,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{},{"alias":"Out of SLO","color":"rgba(193, 23, 23, 0.53)","fill":10,"hideTooltip":true,"legend":false,"lines":true,"linewidth":0,"zindex":-3},{"alias":"1w rolling average","color":"#FADE2A","dashes":true,"hideTooltip":true,"legend":false,"linewidth":3,"spaceLength":6}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\n      max(\n        max_over_time(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}[$__interval]\n        )\n      ) by (component)\n      ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"{{ component }} component","refId":"A"},{"expr":"0.9 ","format":"time_series","hide":false,"interval":"","intervalFactor":1,"legendFormat":"Soft SLO","refId":"B"},{"expr":"0.95","format":"time_series","hide":false,"interval":"","intervalFactor":1,"legendFormat":"Hard SLO","refId":"C"},{"expr":"\n      max(\n        max_over_time(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}[$__interval]\n        )\n      ) by (component)\n       \u003e 0.9","format":"time_series","hide":true,"interval":"5m","intervalFactor":3,"legendFormat":"Out of SLO","refId":"D"},{"expr":"gitlab_component_saturation:ratio:avg_over_time_1w{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}","format":"time_series","hide":false,"interval":"","intervalFactor":1,"legendFormat":"1w rolling average","refId":"E"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":20,"w":24,"x":0,"y":40},"id":4,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/ component/","color":"#E7D551"},{"alias":"Soft SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":false,"lines":true,"linewidth":6,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Hard SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":false,"lines":true,"linewidth":6,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{},{"alias":"Out of SLO","color":"rgba(193, 23, 23, 0.53)","fill":10,"hideTooltip":true,"legend":false,"lines":true,"linewidth":0,"zindex":-3},{"alias":"1w rolling average","color":"#FADE2A","dashes":true,"hideTooltip":true,"legend":false,"linewidth":3,"spaceLength":6}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":" max by (type, tier, stage, environment) (\n      (rate(redis_used_cpu_user{env=\"gprd\", type=\"redis\"}[1m]) + rate(redis_used_cpu_sys{env=\"gprd\", type=\"redis\"}[1m]))\n\n     )","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"","refId":"A"},{"expr":"0.9 ","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"Soft SLO","refId":"B"},{"expr":"0.95","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"Hard SLO","refId":"C"},{"expr":"\n      max(\n        max_over_time(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}[$__interval]\n        )\n      ) by (component)\n       \u003e 0.9","format":"time_series","hide":true,"interval":"5m","intervalFactor":3,"legendFormat":"Out of SLO","refId":"D"},{"expr":"gitlab_component_saturation:ratio:avg_over_time_1w{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"1w rolling average","refId":"E"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":20,"w":24,"x":0,"y":60},"id":7,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"max(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"gitaly\", stage=\"main\", component=\"single_node_cpu\"} \u003c 0.75\n          or \n          clamp_min(gitlab_component_saturation:ratio{environment=\"gprd\", type=\"gitaly\", stage=\"main\", component=\"single_node_cpu\"} \u003e= 0.75, 1)\n) by (component)          \n        ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":20,"w":24,"x":0,"y":80},"id":8,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"connected","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"max(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"redis-cache\", stage=\"main\", component=\"single_threaded_cpu\"} + 0.3 \u003c 0.75\n          or \n          clamp_min(gitlab_component_saturation:ratio{environment=\"gprd\", type=\"redis-cache\", stage=\"main\", component=\"single_threaded_cpu\"} + 0.3 \u003e= 0.75, 1)\n) by (component)          \n        ","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"","refId":"A"},{"expr":"avg_over_time((max(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"redis-cache\", stage=\"main\", component=\"single_threaded_cpu\"} + 0.3 \u003c 0.75\n          or \n          clamp_min(gitlab_component_saturation:ratio{environment=\"gprd\", type=\"redis-cache\", stage=\"main\", component=\"single_threaded_cpu\"} + 0.3 \u003e= 0.75, 1)\n) by (component))[1w:])\n        ","format":"time_series","intervalFactor":1,"legendFormat":"","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Redis CPU Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":20,"w":24,"x":0,"y":100},"id":5,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/ component/","color":"#E7D551"},{"alias":"Soft SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":false,"lines":true,"linewidth":6,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Hard SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":false,"lines":true,"linewidth":6,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{},{"alias":"Out of SLO","color":"rgba(193, 23, 23, 0.53)","fill":10,"hideTooltip":true,"legend":false,"lines":true,"linewidth":0,"zindex":-3},{"alias":"1w rolling average","color":"#FADE2A","dashes":true,"hideTooltip":true,"legend":false,"linewidth":3,"spaceLength":6}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"\nmax(rate(redis_used_cpu_user{env=\"gprd\", type=\"redis\"}[1m]) + rate(redis_used_cpu_sys{env=\"gprd\", type=\"redis\"}[1m])) \u003c 0.8 \nor \nclamp_min(max(rate(redis_used_cpu_user{env=\"gprd\", type=\"redis\"}[1m]) + rate(redis_used_cpu_sys{env=\"gprd\", type=\"redis\"}[1m])) \u003e= 0.8, 1)\n","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"","refId":"A"},{"expr":"0.9 ","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"Soft SLO","refId":"B"},{"expr":"0.95","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"Hard SLO","refId":"C"},{"expr":"\n      max(\n        max_over_time(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}[$__interval]\n        )\n      ) by (component)\n       \u003e 0.9","format":"time_series","hide":true,"interval":"5m","intervalFactor":3,"legendFormat":"Out of SLO","refId":"D"},{"expr":"gitlab_component_saturation:ratio:avg_over_time_1w{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"1w rolling average","refId":"E"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Global","decimals":2,"description":"Saturation is a measure of what ratio of a finite resource is currently being utilized. Lower is better.","fill":0,"gridPos":{"h":20,"w":24,"x":0,"y":120},"id":6,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{},"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/ component/","color":"#E7D551"},{"alias":"Soft SLO","color":"#FF4500","dashLength":4,"dashes":true,"legend":false,"lines":true,"linewidth":6,"nullPointMode":"connected","spaceLength":10,"zindex":-2},{"alias":"Hard SLO","color":"#F2495C","dashLength":4,"dashes":true,"legend":false,"lines":true,"linewidth":6,"nullPointMode":"connected","spaceLength":4,"zindex":-2},{},{"alias":"Out of SLO","color":"rgba(193, 23, 23, 0.53)","fill":10,"hideTooltip":true,"legend":false,"lines":true,"linewidth":0,"zindex":-3},{"alias":"1w rolling average","color":"#FADE2A","dashes":true,"hideTooltip":true,"legend":false,"linewidth":3,"spaceLength":6}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"predict_linear(avg_over_time((\nmax(rate(redis_used_cpu_user{env=\"gprd\", type=\"redis\"}[1m]) + rate(redis_used_cpu_sys{env=\"gprd\", type=\"redis\"}[1m])) \u003c 0.80 \nor \nclamp_min(max(rate(redis_used_cpu_user{env=\"gprd\", type=\"redis\"}[1m]) + rate(redis_used_cpu_sys{env=\"gprd\", type=\"redis\"}[1m])) \u003e= 0.80, 1)\n)[1w:5m])[1w:1m], 86400*30)","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"","refId":"A"},{"expr":"0.9 ","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"Soft SLO","refId":"B"},{"expr":"0.95","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"Hard SLO","refId":"C"},{"expr":"\n      max(\n        max_over_time(\n          gitlab_component_saturation:ratio{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}[$__interval]\n        )\n      ) by (component)\n       \u003e 0.9","format":"time_series","hide":true,"interval":"5m","intervalFactor":3,"legendFormat":"Out of SLO","refId":"D"},{"expr":"gitlab_component_saturation:ratio:avg_over_time_1w{environment=\"gprd\", type=\"web\", stage=\"main\", component=\"single_node_cpu\"}","format":"time_series","hide":true,"interval":"","intervalFactor":1,"legendFormat":"1w rolling average","refId":"E"},{"expr":"predict_linear(avg_over_time((\nmax(rate(redis_cpu_user_seconds_total{env=\"gprd\", type=\"redis\"}[1m]) + rate(redis_cpu_sys_seconds_total{env=\"gprd\", type=\"redis\"}[1m])) \u003c 0.80 \nor \nclamp_min(max(rate(redis_cpu_user_seconds_total{env=\"gprd\", type=\"redis\"}[1m]) + rate(redis_cpu_sys_seconds_total{env=\"gprd\", type=\"redis\"}[1m])) \u003e= 0.80, 1)\n)[1w:5m])[1w:1m], 86400*30)","format":"time_series","interval":"1m","intervalFactor":1,"legendFormat":"","refId":"F"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Saturation","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"percentunit","label":"Saturation %","logBase":1,"max":1,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":1,"min":0,"show":false}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":false,"schemaVersion":18,"style":"dark","tags":[],"templating":{"list":[]},"time":{"from":"2019-05-01T00:00:00.000Z","to":"2019-06-01T00:00:00.000Z"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Devopsdays Playground","uid":"xS5JPrKZz","version":3}}