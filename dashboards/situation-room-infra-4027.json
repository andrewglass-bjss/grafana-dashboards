{"meta":{"type":"db","canSave":true,"canEdit":true,"canAdmin":true,"canStar":true,"slug":"situation-room-infra-4027","url":"/d/000000264/situation-room-infra-4027","expires":"0001-01-01T00:00:00Z","created":"2018-04-14T07:49:48Z","updated":"2018-04-16T12:44:54Z","updatedBy":"ops-contact@gitlab.com","createdBy":"ops-contact@gitlab.com","version":8,"hasAcl":false,"isFolder":false,"folderId":0,"folderTitle":"General","folderUrl":"","provisioned":false},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":2,"hideControls":false,"id":null,"links":[],"refresh":false,"rows":[{"collapse":false,"height":250,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus in Azure","fill":1,"id":113,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"span":12,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"node_load15{fqdn=\"$fqdn\"}","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":2,"legendFormat":"load15","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]},{"expr":"node_load1{fqdn=\"$fqdn\"}","format":"time_series","hide":true,"intervalFactor":2,"legendFormat":"load1","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Load","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":false,"title":"Dashboard Row","titleSize":"h6"},{"collapse":false,"height":250,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus in Azure","fill":1,"id":114,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/All.*/","yaxis":1},{"alias":"/Method.*/","yaxis":2}],"spaceLength":10,"span":12,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(grpc_server_handled_total{fqdn=\"$fqdn\"}[$__interval]))","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":4,"legendFormat":"All GRPC invocations on $fqdn","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]},{"expr":"sum(rate(grpc_server_handled_total{grpc_method=\"$method\", fqdn=\"$fqdn\"}[$__interval])) by (grpc_method)","format":"time_series","interval":"","intervalFactor":4,"legendFormat":"Method {{ grpc_method }} invocations on $fqdn","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Gitaly Method Invocation Rate","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":"1","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":false,"title":"Dashboard Row","titleSize":"h6"},{"collapse":false,"height":250,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus in Azure","fill":1,"id":115,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"span":12,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"histogram_quantile(0.99, \n  sum(rate(grpc_server_handling_seconds_bucket{fqdn=\"$fqdn\", grpc_method=\"$method\"}[$__interval])) by (grpc_method,le)\n)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"hide":false,"intervalFactor":4,"legendFormat":"","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"p99 times","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":10,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":false,"title":"Dashboard Row","titleSize":"h6"},{"collapse":false,"height":250,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus in Azure","fill":1,"id":116,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"span":12,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(grpc_server_handled_total{fqdn=\"$fqdn\", grpc_method=\"FindCommit\"}[$__interval])) by (grpc_method)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":3,"legendFormat":"{{ grpc_method }}","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]},{"expr":"sum(rate(grpc_server_handled_total{fqdn=\"$fqdn\", grpc_method=\"HasLocalBranches\"}[$__interval])) by (grpc_method)","format":"time_series","intervalFactor":2,"legendFormat":"{{ grpc_method }}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Selected Method Invocation Rates on $fqdn","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":false,"title":"Dashboard Row","titleSize":"h6"},{"collapse":false,"height":250,"panels":[{"aliasColors":{"Projects::MergeRequestsController#show":"#70dbed"},"bars":false,"dashLength":10,"dashes":false,"datasource":"Prometheus on prometheus-app-01","fill":5,"id":117,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":true,"hideZero":true,"max":true,"min":true,"show":true,"sort":"avg","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":0,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"span":12,"stack":false,"steppedLine":false,"targets":[{"dsType":"influxdb","expr":"sum(rate(gitlab_find_commit_gitaly_real_duration_seconds_sum{}[$__interval])) by (controller, action)","format":"time_series","groupBy":[{"params":["$__interval"],"type":"time"},{"params":["null"],"type":"fill"}],"intervalFactor":5,"legendFormat":"{{ controller }}#{{ action }}","orderByTime":"ASC","policy":"default","refId":"A","resultFormat":"time_series","select":[[{"params":["value"],"type":"field"},{"params":[],"type":"mean"}]],"tags":[]}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"FindCommit invocations per controller#action","tooltip":{"shared":true,"sort":2,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":false,"title":"Dashboard Row","titleSize":"h6"}],"schemaVersion":14,"style":"dark","tags":[],"templating":{"list":[{"allValue":null,"current":{"selected":true,"text":"FindCommit","value":"FindCommit"},"datasource":"Prometheus in Azure","hide":0,"includeAll":true,"label":null,"multi":false,"name":"method","options":[{"selected":false,"text":"All","value":"$__all"},{"selected":false,"text":"AddNamespace","value":"AddNamespace"},{"selected":false,"text":"AddRemote","value":"AddRemote"},{"selected":false,"text":"ApplyGitattributes","value":"ApplyGitattributes"},{"selected":false,"text":"CalculateChecksum","value":"CalculateChecksum"},{"selected":false,"text":"Check","value":"Check"},{"selected":false,"text":"Cleanup","value":"Cleanup"},{"selected":false,"text":"CommitDelta","value":"CommitDelta"},{"selected":false,"text":"CommitDiff","value":"CommitDiff"},{"selected":false,"text":"CommitIsAncestor","value":"CommitIsAncestor"},{"selected":false,"text":"CommitLanguages","value":"CommitLanguages"},{"selected":false,"text":"CommitPatch","value":"CommitPatch"},{"selected":false,"text":"CommitStats","value":"CommitStats"},{"selected":false,"text":"CommitsBetween","value":"CommitsBetween"},{"selected":false,"text":"CommitsByMessage","value":"CommitsByMessage"},{"selected":false,"text":"CountCommits","value":"CountCommits"},{"selected":false,"text":"CreateBranch","value":"CreateBranch"},{"selected":false,"text":"CreateBundle","value":"CreateBundle"},{"selected":false,"text":"CreateFork","value":"CreateFork"},{"selected":false,"text":"CreateRepository","value":"CreateRepository"},{"selected":false,"text":"CreateRepositoryFromBundle","value":"CreateRepositoryFromBundle"},{"selected":false,"text":"CreateRepositoryFromSnapshot","value":"CreateRepositoryFromSnapshot"},{"selected":false,"text":"CreateRepositoryFromURL","value":"CreateRepositoryFromURL"},{"selected":false,"text":"DeleteBranch","value":"DeleteBranch"},{"selected":false,"text":"DeleteRefs","value":"DeleteRefs"},{"selected":false,"text":"ExtractCommitSignature","value":"ExtractCommitSignature"},{"selected":false,"text":"FetchInternalRemote","value":"FetchInternalRemote"},{"selected":false,"text":"FetchRemote","value":"FetchRemote"},{"selected":false,"text":"FetchSourceBranch","value":"FetchSourceBranch"},{"selected":false,"text":"FilterShasWithSignatures","value":"FilterShasWithSignatures"},{"selected":false,"text":"FindAllBranchNames","value":"FindAllBranchNames"},{"selected":false,"text":"FindAllBranches","value":"FindAllBranches"},{"selected":false,"text":"FindAllCommits","value":"FindAllCommits"},{"selected":false,"text":"FindAllTagNames","value":"FindAllTagNames"},{"selected":false,"text":"FindAllTags","value":"FindAllTags"},{"selected":false,"text":"FindBranch","value":"FindBranch"},{"selected":true,"text":"FindCommit","value":"FindCommit"},{"selected":false,"text":"FindCommits","value":"FindCommits"},{"selected":false,"text":"FindDefaultBranchName","value":"FindDefaultBranchName"},{"selected":false,"text":"FindLicense","value":"FindLicense"},{"selected":false,"text":"FindLocalBranches","value":"FindLocalBranches"},{"selected":false,"text":"FindMergeBase","value":"FindMergeBase"},{"selected":false,"text":"FindRefName","value":"FindRefName"},{"selected":false,"text":"FindRemoteRepository","value":"FindRemoteRepository"},{"selected":false,"text":"Fsck","value":"Fsck"},{"selected":false,"text":"GarbageCollect","value":"GarbageCollect"},{"selected":false,"text":"GetAllLFSPointers","value":"GetAllLFSPointers"},{"selected":false,"text":"GetArchive","value":"GetArchive"},{"selected":false,"text":"GetBlob","value":"GetBlob"},{"selected":false,"text":"GetBlobs","value":"GetBlobs"},{"selected":false,"text":"GetCommitMessages","value":"GetCommitMessages"},{"selected":false,"text":"GetCommitSignatures","value":"GetCommitSignatures"},{"selected":false,"text":"GetInfoAttributes","value":"GetInfoAttributes"},{"selected":false,"text":"GetLFSPointers","value":"GetLFSPointers"},{"selected":false,"text":"GetNewLFSPointers","value":"GetNewLFSPointers"},{"selected":false,"text":"GetSnapshot","value":"GetSnapshot"},{"selected":false,"text":"GetTagMessages","value":"GetTagMessages"},{"selected":false,"text":"GetTreeEntries","value":"GetTreeEntries"},{"selected":false,"text":"HasLocalBranches","value":"HasLocalBranches"},{"selected":false,"text":"InfoRefsReceivePack","value":"InfoRefsReceivePack"},{"selected":false,"text":"InfoRefsUploadPack","value":"InfoRefsUploadPack"},{"selected":false,"text":"IsRebaseInProgress","value":"IsRebaseInProgress"},{"selected":false,"text":"IsSquashInProgress","value":"IsSquashInProgress"},{"selected":false,"text":"LastCommitForPath","value":"LastCommitForPath"},{"selected":false,"text":"ListBranchNamesContainingCommit","value":"ListBranchNamesContainingCommit"},{"selected":false,"text":"ListCommitsByOid","value":"ListCommitsByOid"},{"selected":false,"text":"ListConflictFiles","value":"ListConflictFiles"},{"selected":false,"text":"ListFiles","value":"ListFiles"},{"selected":false,"text":"ListTagNamesContainingCommit","value":"ListTagNamesContainingCommit"},{"selected":false,"text":"NamespaceExists","value":"NamespaceExists"},{"selected":false,"text":"PostReceive","value":"PostReceive"},{"selected":false,"text":"PostReceivePack","value":"PostReceivePack"},{"selected":false,"text":"PostUploadPack","value":"PostUploadPack"},{"selected":false,"text":"RawBlame","value":"RawBlame"},{"selected":false,"text":"RawDiff","value":"RawDiff"},{"selected":false,"text":"RawPatch","value":"RawPatch"},{"selected":false,"text":"RefExists","value":"RefExists"},{"selected":false,"text":"RemoveNamespace","value":"RemoveNamespace"},{"selected":false,"text":"RemoveRemote","value":"RemoveRemote"},{"selected":false,"text":"RenameNamespace","value":"RenameNamespace"},{"selected":false,"text":"RepackFull","value":"RepackFull"},{"selected":false,"text":"RepackIncremental","value":"RepackIncremental"},{"selected":false,"text":"RepositoryExists","value":"RepositoryExists"},{"selected":false,"text":"RepositorySize","value":"RepositorySize"},{"selected":false,"text":"ResolveConflicts","value":"ResolveConflicts"},{"selected":false,"text":"SSHReceivePack","value":"SSHReceivePack"},{"selected":false,"text":"SSHUploadArchive","value":"SSHUploadArchive"},{"selected":false,"text":"SSHUploadPack","value":"SSHUploadPack"},{"selected":false,"text":"ServerInfo","value":"ServerInfo"},{"selected":false,"text":"ServerReflectionInfo","value":"ServerReflectionInfo"},{"selected":false,"text":"TreeEntry","value":"TreeEntry"},{"selected":false,"text":"UpdateRemoteMirror","value":"UpdateRemoteMirror"},{"selected":false,"text":"UserCherryPick","value":"UserCherryPick"},{"selected":false,"text":"UserCommitFiles","value":"UserCommitFiles"},{"selected":false,"text":"UserCreateBranch","value":"UserCreateBranch"},{"selected":false,"text":"UserCreateTag","value":"UserCreateTag"},{"selected":false,"text":"UserDeleteBranch","value":"UserDeleteBranch"},{"selected":false,"text":"UserDeleteTag","value":"UserDeleteTag"},{"selected":false,"text":"UserFFBranch","value":"UserFFBranch"},{"selected":false,"text":"UserMergeBranch","value":"UserMergeBranch"},{"selected":false,"text":"UserRebase","value":"UserRebase"},{"selected":false,"text":"UserRevert","value":"UserRevert"},{"selected":false,"text":"UserSquash","value":"UserSquash"},{"selected":false,"text":"WikiDeletePage","value":"WikiDeletePage"},{"selected":false,"text":"WikiFindFile","value":"WikiFindFile"},{"selected":false,"text":"WikiFindPage","value":"WikiFindPage"},{"selected":false,"text":"WikiGetAllPages","value":"WikiGetAllPages"},{"selected":false,"text":"WikiGetFormattedData","value":"WikiGetFormattedData"},{"selected":false,"text":"WikiGetPageVersions","value":"WikiGetPageVersions"},{"selected":false,"text":"WikiUpdatePage","value":"WikiUpdatePage"},{"selected":false,"text":"WikiWritePage","value":"WikiWritePage"},{"selected":false,"text":"WriteConfig","value":"WriteConfig"},{"selected":false,"text":"WriteRef","value":"WriteRef"}],"query":"label_values(grpc_server_started_total{job=\"gitaly\"}, grpc_method)","refresh":0,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":true,"text":"nfs-file-08.stor.gitlab.com","value":"nfs-file-08.stor.gitlab.com"},"datasource":"Prometheus in Azure","hide":0,"includeAll":false,"label":null,"multi":false,"name":"fqdn","options":[{"selected":false,"text":"dev.gitlab.org","value":"dev.gitlab.org"},{"selected":false,"text":"nfs-file-01.stor.gitlab.com","value":"nfs-file-01.stor.gitlab.com"},{"selected":false,"text":"nfs-file-02.stor.gitlab.com","value":"nfs-file-02.stor.gitlab.com"},{"selected":false,"text":"nfs-file-03.stor.gitlab.com","value":"nfs-file-03.stor.gitlab.com"},{"selected":false,"text":"nfs-file-04.stor.gitlab.com","value":"nfs-file-04.stor.gitlab.com"},{"selected":false,"text":"nfs-file-05.stor.gitlab.com","value":"nfs-file-05.stor.gitlab.com"},{"selected":false,"text":"nfs-file-06.stor.gitlab.com","value":"nfs-file-06.stor.gitlab.com"},{"selected":false,"text":"nfs-file-07.stor.gitlab.com","value":"nfs-file-07.stor.gitlab.com"},{"selected":true,"text":"nfs-file-08.stor.gitlab.com","value":"nfs-file-08.stor.gitlab.com"},{"selected":false,"text":"nfs-file-09.stor.gitlab.com","value":"nfs-file-09.stor.gitlab.com"},{"selected":false,"text":"nfs-file-10.stor.gitlab.com","value":"nfs-file-10.stor.gitlab.com"},{"selected":false,"text":"nfs-file-11.stor.gitlab.com","value":"nfs-file-11.stor.gitlab.com"},{"selected":false,"text":"nfs-file-12.stor.gitlab.com","value":"nfs-file-12.stor.gitlab.com"},{"selected":false,"text":"nfs-file-13.stor.gitlab.com","value":"nfs-file-13.stor.gitlab.com"},{"selected":false,"text":"nfs-file-14.stor.gitlab.com","value":"nfs-file-14.stor.gitlab.com"},{"selected":false,"text":"nfs-file-15.stor.gitlab.com","value":"nfs-file-15.stor.gitlab.com"},{"selected":false,"text":"nfs-file-16.stor.gitlab.com","value":"nfs-file-16.stor.gitlab.com"},{"selected":false,"text":"nfs5.staging.gitlab.com","value":"nfs5.staging.gitlab.com"}],"query":"label_values(up{job=~\"gitaly.*\"}, fqdn)","refresh":0,"regex":"","sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-7d","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Situation Room: Infra#4027","uid":"000000264","version":8}}